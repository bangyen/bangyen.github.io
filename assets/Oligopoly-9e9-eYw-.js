import{r as e,j as a}from"./vendor_react-Dmhynvug.js";import{p as o}from"./pako.esm-hE_UBizs.js";import{a as t,R as r}from"./ResearchDemo-DtlRFNKp.js";import{d as i,a as l,U as s}from"./index-js-jkzfV.js";import{u as n,T as c,v as u}from"./vendor_mui_icons-D-xc5S0s.js";import"./GlassCard-BLkybKoH.js";import"./vendor_mui_core-xr9lkZHO.js";import"./GlobalHeader-CIIrsMr1.js";import"./vendor_recharts-BGXE3Yy8.js";const d=(e,a,o,r,i,l)=>{if(0===e.length)return m();const s=e.filter(e=>e.num_firms===a&&e.model_type===o&&e.demand_elasticity===r&&e.base_price===i&&e.collusion_enabled===l);if(0===s.length){return e.filter(e=>e.num_firms===a&&e.model_type===o).sort((e,a)=>e.round-a.round).slice(0,t.oligopoly.maxRounds)}return s.sort((e,a)=>e.round-a.round).slice(0,15)},m=()=>{const e=[];for(let a=1;a<=t.oligopoly.maxRounds;a++){const o=t.oligopoly.simulation;e.push({round:a,price:o.fallbackPrice+Math.sin(a*o.priceFrequency)*o.priceAmplitude,hhi:o.fallbackHHI+Math.sin(a*o.hhiFrequency)*o.hhiAmplitude,collusion:a>o.collusionStart&&a<o.collusionEnd})}return e},p=()=>{const[p,y]=e.useState(t.oligopoly.defaultFirms),[f,g]=e.useState(t.oligopoly.defaultElasticity),[h,b]=e.useState(t.oligopoly.defaultBasePrice),[x,v]=e.useState([]),[A,F]=e.useState([]),[_,j]=e.useState(!0),S=t.modelTypes.cournot,M=!1;e.useEffect(()=>{document.title=i.oligopoly;(async()=>{j(!0);try{const e=await(async()=>{try{const e=await fetch("/oligopoly_data.json.gz");if(!e.ok)throw new Error(`HTTP error! status: ${e.status.toString()} - Failed to load Oligopoly data`);const a=await e.arrayBuffer(),t=new Uint8Array(a);let r;if(31===t[0]&&139===t[1]){const e=o.ungzip(t,{to:"string"}),a=JSON.parse(e);r=a[0]?.matrix??[]}else{const e=(new TextDecoder).decode(a);r=JSON.parse(e)}if(!Array.isArray(r))throw new Error("Invalid data format: expected array");return r}catch(e){return[]}})();F(e);const a=d(e,p,S,f,h,M);v(a)}catch(e){v(m())}finally{j(!1)}})()},[p,f,h,M,S]),e.useEffect(()=>{if(A.length>0){const e=d(A,p,S,f,h,M);v(e)}},[p,f,h,A,S,M]);const w=[{label:"Number of Firms",icon:n,color:l.primary.main,value:p,onChange:y,options:[{value:2,label:"2"},{value:3,label:"3"},{value:4,label:"4"},{value:5,label:"5"}]},{label:"Demand Elasticity",icon:c,color:l.data.green,value:f,onChange:g,options:[{value:1.5,label:"1.5"},{value:2,label:"2.0"},{value:2.5,label:"2.5"}]},{label:"Base Price",icon:u,color:l.data.amber,value:h,onChange:b,options:[{value:30,label:"$30"},{value:40,label:"$40"},{value:50,label:"$50"}]}],E={type:"line",xAxisKey:"round",yAxisFormatter:e=>`$${e.toFixed(2)}`,yAxisDomain:["dataMin - 5","dataMax + 5"],dualYAxis:!0,rightYAxisFormatter:e=>e.toFixed(2),rightYAxisDomain:["dataMin - 0.05","dataMax + 0.05"],tooltipLabelFormatter:e=>`Round ${e.toString()}`,tooltipFormatter:(e,a)=>["Market Price"===a?`$${e.toFixed(2)}`:e.toFixed(2),a],lines:[{dataKey:"price",name:"Market Price",color:l.primary.main,yAxisId:"left"},{dataKey:"hhi",name:"HHI Concentration",color:l.data.amber,yAxisId:"right"}]};return a.jsx(r,{title:"Oligopoly",subtitle:"Agent-Based Economic Competition Analysis",githubUrl:s.oligopolyRepo,chartData:x,chartConfig:E,chartTitle:"Market Dynamics",controls:w,loading:_,loadingMessage:"Loading Cournot simulation data...",onReset:()=>{y(t.oligopoly.defaultFirms),g(t.oligopoly.defaultElasticity),b(t.oligopoly.defaultBasePrice)},resetLabel:"Reset"})};export{p as default};
