import{j as e,r as t}from"./vendor_react-WaSaIrII.js";import{C as n,u as o,c as s}from"./layout-_boOtwMs.js";import{L as r,f as i,e as a,a as c}from"./index-D08kVr1C.js";import{B as l,G as u}from"./vendor_mui_core-CC5VlWLf.js";import{w as d,x as f,E as m}from"./vendor_mui_icons-nmK6gwuH.js";import{G as h}from"./GlobalHeader-CxAfY2Df.js";function w(t){const{frontProps:o,backProps:s,size:i,rows:a,cols:c,frontLayerSx:u,backLayerSx:d}=t;return e.jsxs(l,{sx:{display:"grid",placeItems:"center"},children:[e.jsx(l,{sx:{gridArea:"1/1",...d},children:e.jsx(n,{space:0,size:i,rows:a-1,cols:c-1,cellProps:s})}),e.jsx(l,{sx:{gridArea:"1/1",zIndex:r.zIndex.base+1,...u},children:e.jsx(n,{space:0,size:i,rows:a,cols:c,cellProps:o})})]})}function p({rows:t,cols:n,dynamicSize:o,minSize:s,maxSize:r,handlePlus:c,handleMinus:l,onRefresh:u,disabled:m=!1,children:h}){const w=t<=s&&n<=s,p=t>=r&&n>=r||t===o.rows&&n===o.cols;return e.jsxs(i,{onRefresh:u,children:[e.jsx(a,{title:"Decrease Size",Icon:d,onClick:l,disabled:m||w}),e.jsx(a,{title:"Increase Size",Icon:f,onClick:c,disabled:m||p}),h]})}const g={gridSizes:{mobile:2.5,desktop:4},timing:{winAnimationDelay:2e3,interactionDelay:500,touchHoldDelay:500},layout:{headerHeight:{mobile:64,desktop:80}}};function x(){const[e,n]=t.useState({height:window.innerHeight,width:window.innerWidth});return t.useEffect(()=>{const e=()=>{n({height:window.innerHeight,width:window.innerWidth})};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[]),e}function b({onAction:e,checkEnabled:n=()=>!0,touchTimeout:o=500,posAttribute:s="data-pos",preventDefault:r=!0,transition:i="all 0.2s"}){const[a,c]=t.useState(null),l=t.useRef(new Set),u=t.useRef(0),d=t.useCallback(()=>{c(null),l.current.clear()},[]),f=t.useCallback(t=>{if(null===a)return;const n=t.touches[0];if(!n)return;const o=document.elementFromPoint(n.clientX,n.clientY);if(!o)return;const r=o.closest(`[${s}]`);if(r){const t=r.getAttribute(s);t&&!l.current.has(t)&&(e(t,2===a,!1),l.current.add(t))}},[a,e,s]);t.useEffect(()=>(window.addEventListener("mouseup",d),window.addEventListener("touchend",d),window.addEventListener("touchcancel",d),window.addEventListener("touchmove",f,{passive:!1}),()=>{window.removeEventListener("mouseup",d),window.removeEventListener("touchend",d),window.removeEventListener("touchcancel",d),window.removeEventListener("touchmove",f)}),[d,f]);const m=t.useCallback(t=>({onMouseDown:s=>{n()&&(0!==s.button&&2!==s.button||Date.now()-u.current<o||(r&&s.preventDefault(),c(s.button),e(t,2===s.button,!0),l.current.add(t)))},onMouseEnter:()=>{null!==a&&!l.current.has(t)&&n()&&(e(t,2===a,!1),l.current.add(t))},onTouchStart:o=>{n()&&(o.cancelable&&r&&o.preventDefault(),u.current=Date.now(),c(0),e(t,!1,!0),l.current.add(t))},onContextMenu:e=>{r&&e.preventDefault()},[s]:t,sx:{touchAction:"none",transition:i}}),[e,n,a,o,s,r,i]);return{isDragging:null!==a,draggingButton:a,getDragProps:m,lastTouchTime:u}}function S({storageKey:e,rows:n,cols:o,state:s,onRestore:r,serialize:i,deserialize:a,enabled:c=!0,saveDebounceMs:l=300}){const u=`${e}-${String(n)}x${String(o)}`,d=t.useRef(r),f=t.useRef(a),m=t.useRef(i);t.useEffect(()=>{d.current=r,f.current=a,m.current=i}),t.useEffect(()=>{if(!c)return;const e=localStorage.getItem(u);if(e)try{const t=JSON.parse(e),n=f.current??(e=>e);d.current(n(t))}catch(t){localStorage.removeItem(u)}},[u,c]),t.useEffect(()=>{if(!c)return;const e=setTimeout(()=>{const e=(m.current??(e=>e))(s);localStorage.setItem(u,JSON.stringify(e))},l);return()=>{clearTimeout(e)}},[u,s,c,l])}function y({storageKeys:e,pageTitle:n,gridConfig:r,boardConfig:i,reducer:a,getInitialState:c,winAnimationDelay:l,isSolved:u,persistence:d}){const{rows:f,cols:m,dynamicSize:h,handlePlus:w,handleMinus:p,mobile:g,minSize:b,maxSize:y}=function({storageKey:e,defaultSize:n,minSize:r=2,maxSize:i=10,headerOffset:a,paddingOffset:c=0,widthLimit:l=1300,cellSizeReference:u,mobileRowOffset:d=0}){const{height:f,width:m}=x(),h=o("sm"),[w,p]=t.useState(()=>{const t=localStorage.getItem(e);return"null"===t?null:t?parseInt(t,10):n}),g=t.useMemo(()=>{const e=h?a.mobile:a.desktop,t="number"==typeof u?u:h?u.mobile:u.desktop,n=s(t,f-e-c,Math.min(m,l));let o=n.rows-1;const i=n.cols-1;return h&&(o+=d),{rows:Math.max(r,o),cols:Math.max(r,i)}},[u,f,m,h,a,c,l,r,d]),{rows:b,cols:S}=t.useMemo(()=>null===w?g:{rows:Math.min(w,g.rows),cols:Math.min(w,g.cols)},[w,g]);return t.useEffect(()=>{localStorage.setItem(e,String(w))},[w,e]),{rows:b,cols:S,dynamicSize:g,handlePlus:()=>{const e=Math.min(b,S);null!==w&&(e<Math.min(g.rows,g.cols)?p(e+1):g.rows===g.cols||b===g.rows&&S===g.cols||p(null))},handleMinus:()=>{const e=Math.min(b,S);if(null===w){const e=Math.min(g.rows,g.cols);g.rows===g.cols?p(Math.max(r,e-1)):p(e)}else e>r&&p(e-1)},desiredSize:w,setDesiredSize:p,mobile:h,width:m,height:f,minSize:r,maxSize:i}}({storageKey:e.size,...r}),z=t.useMemo(()=>c(f,m),[f,m,c]),[v,M]=t.useReducer(a,z),j=t.useMemo(()=>u(v),[v,u]),E=t.useCallback(()=>{M({type:"new"})},[M]);var k;S({storageKey:e.state,rows:f,cols:m,state:v,onRestore:e=>{M({type:"restore",state:e}),M({type:"hydrate",state:e})},...d}),function(e,n,o=2e3){const s=t.useRef(n);s.current=n,t.useEffect(()=>{if(e){const e=setTimeout(()=>{s.current()},o);return()=>{clearTimeout(e)}}},[e,o])}(j,E,l),k=n,t.useEffect(()=>{document.title=k},[k]),t.useEffect(()=>{M({type:"resize",rows:f,cols:m,newRows:f,newCols:m})},[f,m,M]);const C=t.useMemo(()=>"function"==typeof i.paddingOffset?i.paddingOffset(g):i.paddingOffset,[i,g]),R=function({rows:e,cols:n,headerOffset:s,paddingOffset:r,boardMaxWidth:i,boardSizeFactor:a,maxCellSize:c,remBase:l}){const{width:u,height:d}=x(),f=o("sm");return t.useMemo(()=>{const t=f?s.mobile:s.desktop,o="number"==typeof r?0:r.x,m="number"==typeof r?r:r.y,h=(Math.min(u,i)-o)*a,w=(d-t-m)*a;return Math.min(h/n,w/e,c)/l},[u,d,f,e,n,s,r,i,a,c,l])}({rows:f+(i.rowOffset??0),cols:m+(i.colOffset??0),headerOffset:r.headerOffset,...i,paddingOffset:C});return{rows:f,cols:m,state:v,dispatch:M,size:R,mobile:g,solved:j,handleNext:E,controlsProps:{rows:f,cols:m,dynamicSize:h,minSize:b,maxSize:y,handlePlus:w,handleMinus:p,onRefresh:E}}}function z({onToggle:e,checkEnabled:n,touchTimeout:o,transition:s,posAttribute:r}){const i=t.useRef(void 0),a=t.useRef(e);a.current=e;const c=t.useCallback((e,t,o)=>{if(!n())return;const[s,r]=e.split(",").map(Number);void 0!==s&&void 0!==r&&(o?i.current=a.current(s,r,t,void 0,!0):a.current(s,r,t,i.current,!1))},[n]),{getDragProps:l}=b({onAction:c,checkEnabled:n,touchTimeout:o,transition:s,posAttribute:r});return{getDragProps:l}}function v({show:t,onReset:n,size:o,iconSizeRatio:s,primaryColor:r,secondaryColor:i,useSecondary:a=!1}){return e.jsx(l,{onClick:n,sx:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",opacity:t?1:0,transform:t?"scale(1)":"scale(0.5)",visibility:t?"visible":"hidden",transition:"all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1)",cursor:"pointer",zIndex:10,backgroundColor:"transparent"},children:o>0&&e.jsx(m,{sx:{fontSize:`${(o*s).toString()}rem`,color:a?i:r,filter:"drop-shadow(0 4px 12px rgba(0,0,0,0.1))"}})})}function M({children:t,controls:n,infoUrl:s,_title:r,background:i=c.surface.background,paddingBottom:a={xs:"80px",md:"120px"},contentSx:d={},showTrophy:f=!1,onReset:m,boardSize:w=0,iconSizeRatio:p=1,primaryColor:g,secondaryColor:x,useSecondaryTrophy:b=!1,boardSx:S}){return o("sm"),e.jsxs(u,{container:!0,minHeight:"100vh",flexDirection:"column",sx:{background:i,position:"relative",overflow:"hidden",height:"100vh",transition:"background 0.5s ease-in-out"},children:[e.jsx(h,{showHome:!0,infoUrl:s}),e.jsx(l,{sx:[{flex:1,position:"relative",width:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",overflow:"hidden",pb:a},...d?Array.isArray(d)?d:[d]:[]],children:e.jsxs(l,{sx:[{position:"relative",width:"fit-content"},...S?Array.isArray(S)?S:[S]:[]],children:[t,e.jsx(v,{show:f,onReset:m,size:w,iconSizeRatio:p,primaryColor:g,secondaryColor:x,useSecondary:b})]})}),n]})}function j(e,t){return`${e.toString()},${t.toString()}`}function E(e,n,o){return t.useMemo(()=>e(n,...o),[e,n,...o])}export{w as B,M as G,y as a,z as b,E as c,p as d,g as e,S as f,j as g,b as u};
