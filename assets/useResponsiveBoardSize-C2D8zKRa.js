import{j as e,r as t}from"./vendor_react-WaSaIrII.js";import{C as n,u as o,c as s}from"./layout-BFxZ9w7k.js";import{L as r,f as i,e as a,a as c}from"./index-B-l19WKQ.js";import{B as l,G as u}from"./vendor_mui_core-CC5VlWLf.js";import{w as d,x as f,E as m}from"./vendor_mui_icons-nmK6gwuH.js";import{G as h}from"./GlobalHeader-BJIpmPyL.js";function p(t){const{frontProps:o,backProps:s,size:i,rows:a,cols:c,frontLayerSx:u,backLayerSx:d}=t;return e.jsxs(l,{sx:{display:"grid",placeItems:"center"},children:[e.jsx(l,{sx:{gridArea:"1/1",...d},children:e.jsx(n,{space:0,size:i,rows:a-1,cols:c-1,cellProps:s})}),e.jsx(l,{sx:{gridArea:"1/1",zIndex:r.zIndex.base+1,...u},children:e.jsx(n,{space:0,size:i,rows:a,cols:c,cellProps:o})})]})}function S({rows:t,cols:n,dynamicSize:o,minSize:s,maxSize:r,handlePlus:c,handleMinus:l,onRefresh:u,disabled:m=!1,children:h}){const p=t<=s&&n<=s,S=t>=r&&n>=r||t===o.rows&&n===o.cols;return e.jsxs(i,{onRefresh:u,children:[e.jsx(a,{title:"Decrease Size",Icon:d,onClick:l,disabled:m||p}),e.jsx(a,{title:"Increase Size",Icon:f,onClick:c,disabled:m||S}),h]})}function w(){const[e,n]=t.useState({height:window.innerHeight,width:window.innerWidth});return t.useEffect(()=>{const e=()=>{n({height:window.innerHeight,width:window.innerWidth})};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[]),e}function x({onAction:e,checkEnabled:n=()=>!0,touchTimeout:o=500,posAttribute:s="data-pos",preventDefault:r=!0,transition:i="all 0.2s"}){const[a,c]=t.useState(null),l=t.useRef(new Set),u=t.useRef(0),d=t.useCallback(()=>{c(null),l.current.clear()},[]),f=t.useCallback(t=>{if(null===a)return;const n=t.touches[0];if(!n)return;const o=document.elementFromPoint(n.clientX,n.clientY);if(!o)return;const r=o.closest(`[${s}]`);if(r){const t=r.getAttribute(s);t&&!l.current.has(t)&&(e(t,2===a,!1),l.current.add(t))}},[a,e,s]);t.useEffect(()=>(window.addEventListener("mouseup",d),window.addEventListener("touchend",d),window.addEventListener("touchcancel",d),window.addEventListener("touchmove",f,{passive:!1}),()=>{window.removeEventListener("mouseup",d),window.removeEventListener("touchend",d),window.removeEventListener("touchcancel",d),window.removeEventListener("touchmove",f)}),[d,f]);const m=t.useCallback(t=>({onMouseDown:s=>{n()&&(0!==s.button&&2!==s.button||Date.now()-u.current<o||(r&&s.preventDefault(),c(s.button),e(t,2===s.button,!0),l.current.add(t)))},onMouseEnter:()=>{null!==a&&!l.current.has(t)&&n()&&(e(t,2===a,!1),l.current.add(t))},onTouchStart:o=>{n()&&(o.cancelable&&r&&o.preventDefault(),u.current=Date.now(),c(0),e(t,!1,!0),l.current.add(t))},onContextMenu:e=>{r&&e.preventDefault()},[s]:t,sx:{touchAction:"none",transition:i}}),[e,n,a,o,s,r,i]);return{isDragging:null!==a,draggingButton:a,getDragProps:m,lastTouchTime:u}}function g({storageKey:e,defaultSize:n,minSize:r=2,maxSize:i=10,headerOffset:a,paddingOffset:c=0,widthLimit:l=1300,cellSizeReference:u,mobileRowOffset:d=0}){const{height:f,width:m}=w(),h=o("sm"),[p,S]=t.useState(()=>{const t=localStorage.getItem(e);return"null"===t?null:t?parseInt(t,10):n}),x=t.useMemo(()=>{const e=h?a.mobile:a.desktop,t="number"==typeof u?u:h?u.mobile:u.desktop,n=s(t,f-e-c,Math.min(m,l));let o=n.rows-1;const i=n.cols-1;return h&&(o+=d),{rows:Math.max(r,o),cols:Math.max(r,i)}},[u,f,m,h,a,c,l,r,d]),{rows:g,cols:E}=t.useMemo(()=>null===p?x:{rows:Math.min(p,x.rows),cols:Math.min(p,x.cols)},[p,x]);t.useEffect(()=>{localStorage.setItem(e,String(p))},[p,e]);return{rows:g,cols:E,dynamicSize:x,handlePlus:()=>{const e=Math.min(g,E);null!==p&&(e<Math.min(x.rows,x.cols)?S(e+1):x.rows===x.cols||g===x.rows&&E===x.cols||S(null))},handleMinus:()=>{const e=Math.min(g,E);if(null===p){const e=Math.min(x.rows,x.cols);x.rows===x.cols?S(Math.max(r,e-1)):S(e)}else e>r&&S(e-1)},desiredSize:p,setDesiredSize:S,mobile:h,width:m,height:f,minSize:r,maxSize:i}}function E({storageKey:e,rows:n,cols:o,state:s,onRestore:r,serialize:i,deserialize:a,enabled:c=!0,saveDebounceMs:l=300}){const u=`${e}-${String(n)}x${String(o)}`,d=t.useRef(r),f=t.useRef(a),m=t.useRef(i);t.useEffect(()=>{d.current=r,f.current=a,m.current=i}),t.useEffect(()=>{if(!c)return;const e=localStorage.getItem(u);if(e)try{const t=JSON.parse(e),n=f.current??(e=>e);d.current(n(t))}catch(t){localStorage.removeItem(u)}},[u,c]),t.useEffect(()=>{if(!c)return;const e=setTimeout(()=>{const e=(m.current??(e=>e))(s);localStorage.setItem(u,JSON.stringify(e))},l);return()=>{clearTimeout(e)}},[u,s,c,l])}const b="32px",I="48px",v=.4,T={WIN_ANIMATION_DELAY:2e3,TOUCH_HOLD_DELAY:500},D={LINE_WIDTH:"130%",LINE_THICKNESS:"6px",CALCULATOR_BORDER_RADIUS:"24px",HEADER_OFFSET:{MOBILE:64,DESKTOP:80},PADDING_OFFSET:100,WIDTH_LIMIT:1e3,BOARD_MAX_WIDTH:1200,BOARD_SIZE_FACTOR:.95,MAX_CELL_SIZE:100,REM_BASE:16,ICON_SIZE_RATIO:.8},R={SIZE:"slant-size",STATE:"slant-state",GHOST_MOVES:"slant-ghost-moves"},_={MIN_SIZE:3,DEFAULT_SIZE:7,PUZZLE_GENERATION_ITERATIONS:30},A={COLORS:{WHITE:"#fff"},SHADOWS:{LINE:"0 2px 4px rgba(0,0,0,0.2)",HINT:"0 4px 8px rgba(0,0,0,0.1)"},GHOST:{BORDER:"rgba(255, 255, 255, 0.1)",BG_SUBTLE:"rgba(255, 255, 255, 0.02)",BG_HOVER:"rgba(255, 255, 255, 0.1)",DASHED_BORDER:"rgba(255, 255, 255, 0.2)",HINT_BG:"hsl(217, 50%, 8%)",HINT_BORDER:"rgba(255, 255, 255, 0.3)"}};function y({onToggle:e,checkEnabled:n,touchTimeout:o=T.TOUCH_HOLD_DELAY,transition:s,posAttribute:r}){const i=t.useRef(void 0),a=t.useRef(e);a.current=e;const c=t.useCallback((e,t,o)=>{if(!n())return;const[s,r]=e.split(",").map(Number);if(void 0!==s&&void 0!==r)if(o){const e=a.current(s,r,t);void 0!==e&&(i.current=e)}else a.current(s,r,t,i.current)},[n]),{getDragProps:l}=x({onAction:c,checkEnabled:n,touchTimeout:o,transition:s,posAttribute:r});return{getDragProps:l}}function z(e,n,o=2e3){const s=t.useRef(n);s.current=n,t.useEffect(()=>{if(e){const e=setTimeout(()=>{s.current()},o);return()=>{clearTimeout(e)}}},[e,o])}function O(e){t.useEffect(()=>{document.title=e},[e])}function L({show:t,onReset:n,size:o,iconSizeRatio:s,primaryColor:r,secondaryColor:i,useSecondary:a=!1}){return e.jsx(l,{onClick:n,sx:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",opacity:t?1:0,transform:t?"scale(1)":"scale(0.5)",visibility:t?"visible":"hidden",transition:"all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1)",cursor:"pointer",zIndex:10,backgroundColor:"transparent"},children:o>0&&e.jsx(m,{sx:{fontSize:`${(o*s).toString()}rem`,color:a?i:r,filter:"drop-shadow(0 4px 12px rgba(0,0,0,0.1))"}})})}function M({children:t,controls:n,infoUrl:s,_title:r,background:i=c.surface.background,paddingBottom:a={xs:"80px",md:"120px"},contentSx:d={},showTrophy:f=!1,onReset:m,boardSize:p=0,iconSizeRatio:S=1,primaryColor:w,secondaryColor:x,useSecondaryTrophy:g=!1,boardSx:E}){return o("sm"),e.jsxs(u,{container:!0,minHeight:"100vh",flexDirection:"column",sx:{background:i,position:"relative",overflow:"hidden",height:"100vh",transition:"background 0.5s ease-in-out"},children:[e.jsx(h,{showHome:!0,infoUrl:s}),e.jsx(l,{sx:[{flex:1,position:"relative",width:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",overflow:"hidden",pb:a},...d?Array.isArray(d)?d:[d]:[]],children:e.jsxs(l,{sx:[{position:"relative",width:"fit-content"},...E?Array.isArray(E)?E:[E]:[]],children:[t,e.jsx(L,{show:f,onReset:m,size:p,iconSizeRatio:S,primaryColor:w,secondaryColor:x,useSecondary:g})]})}),n]})}function C({rows:e,cols:n,headerOffset:s,paddingOffset:r,boardMaxWidth:i,boardSizeFactor:a,maxCellSize:c,remBase:l}){const{width:u,height:d}=w(),f=o("sm");return t.useMemo(()=>{const t=f?s.mobile:s.desktop,o="number"==typeof r?0:r.x,m="number"==typeof r?r:r.y,h=(Math.min(u,i)-o)*a,p=(d-t-m)*a;return Math.min(h/n,p/e,c)/l},[u,d,f,e,n,s,r,i,a,c,l])}export{p as B,I as D,M as G,D as L,b as M,v as N,A as S,T,g as a,y as b,E as c,z as d,O as e,C as f,S as g,_ as h,R as i,x as u};
