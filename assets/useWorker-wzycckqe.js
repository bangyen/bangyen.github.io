import{r as o}from"./vendor_react-D9AZKRQJ.js";function M(d,r={}){const[m,i]=o.useState(null),[S,s]=o.useState(!1),[b,n]=o.useState(null),l=o.useRef(null),c=o.useCallback(()=>{l.current&&(l.current.terminate(),l.current=null)},[]),p=o.useCallback(w=>{var g;c(),s(!0),n(null);try{const a=d();l.current=a,a.onmessage=u=>{var f,k;const t={setResult:i,setError:n,setLoading:s};if(r.onMessage)return void r.onMessage(u,t);const e=u.data;if(e.success&&e.result!==void 0)i(e.result),(f=r.onSuccess)==null||f.call(r,e.result),s(!1);else{const E=e.error??"An unknown error occurred.";n(E),(k=r.onError)==null||k.call(r,E),s(!1)}},a.onerror=u=>{var e;const t="An error occurred in the background worker.";n(t),(e=r.onError)==null||e.call(r,t),s(!1)},a.postMessage(w)}catch{const u="Failed to start calculation worker.";n(u),(g=r.onError)==null||g.call(r,u),s(!1)}},[d,r,c]);return o.useEffect(()=>()=>{c()},[c]),{result:m,loading:S,error:b,run:p,terminate:c,setResult:i,setError:n,setLoading:s}}export{M as u};
