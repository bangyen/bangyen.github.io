import{r as t,j as e}from"./vendor_react-WaSaIrII.js";import{a as n,T as o,R as r,d as s,e as i,L as a}from"./index-B-l19WKQ.js";import{B as c,u as l,a as d,b as f,c as u,d as p,e as x,f as m,G as h,g}from"./useResponsiveBoardSize-C2D8zKRa.js";import{G as y}from"./GlassCard-mrHjUWCi.js";import{C as b,u as j}from"./layout-BFxZ9w7k.js";import{b as S,E as v,c as k,K as w,d as z,e as C,R as $,N as I,f as P,g as R,M as A}from"./vendor_mui_icons-nmK6gwuH.js";import{G as B,B as M,d as T,M as D,h as O,I as E,e as F}from"./vendor_mui_core-CC5VlWLf.js";import"./GlobalHeader-BJIpmPyL.js";function W(e,n){const o=t.useCallback((t,o)=>{const r=e(t,o);return{front:r?n.primary:n.secondary,back:r?n.secondary:n.primary}},[e,n]),r=t.useCallback((t,n)=>function(t,e,n){const o=n(t,e),r={},s=o===n(t-1,e),i=o===n(t+1,e),a=o===n(t,e-1),c=o===n(t,e+1);return(s||a)&&(r.borderTopLeftRadius=0),(s||c)&&(r.borderTopRightRadius=0),(i||a)&&(r.borderBottomLeftRadius=0),(i||c)&&(r.borderBottomRightRadius=0),r}(t,n,e),[e]),s=t.useCallback((t,o)=>{const r=function(t,e,n){const o=n(t,e),r=n(t,e+1),s=n(t+1,e),i=n(t+1,e+1);let a=!0;const c=Number(o)+Number(r)+Number(s)+Number(i);return o&&i||!(c<3)||(a=!1),a}(t,o,e);return r?n.primary:n.secondary},[e,n]);return t.useMemo(()=>({getColor:o,getBorder:r,getFiller:s}),[o,r,s])}function L(e,n){const{grid:o,rows:r,cols:s}=e;return W(t.useCallback((t,e)=>t<0||e<0||t>=r||e>=s?-1:o[t]?.[e]??-1,[o,r,s]),n)}const H={mobile:2.5,desktop:4};function N(t,e){const n=t.length,o=[];for(let r=0;r<n;r++){const s=t[r];let i=0n;if(void 0!==s)for(let t=0;t<n;t++)if(s&1n<<BigInt(n-1-t)){const n=e[t];void 0!==n&&(i^=n)}o.push(i)}return o}function _(t){const e=Array(t).fill(1n);for(let n=0;n<t;n++){const o=e[n];void 0!==o&&(e[n]=o<<BigInt(t-n-1))}return e}function G(t,e,n){let o=_(t.length),r=[...t],s=e;for(;s>0;)s%2==1&&(o=N(o,r)),r=N(r,r),s=Math.floor(s/2);return o}function K(t,e){const n=t.length,o=[];for(let r=0;r<n;r++){const n=t[r],s=e[r];if(void 0!==n&&void 0!==s){const t=n^s;o.push(t)}}return o}function U(t,e){const n=t.length,o=[...Array(n).keys()].sort((e,n)=>{const o=t[n],r=t[e];return void 0===o||void 0===r?0:o>r?1:o<r?-1:0});return[o.map(e=>t[e]??0n),o.map(t=>e[t]??0n)]}const Y={};function Z(t,e,n){const o=`${e.toString()},${n.toString()}`;if(!Y[o]){const t=function(t){if(1===t)return[1n];const e=[7n<<BigInt(t-2)];for(let o=1;o<t;o++){const t=e[o-1];if(void 0!==t){const n=t>>1n;e.push(n)}}const n=e[0];return void 0!==n&&(e[0]=n-(1n<<BigInt(t))),e}(n),r=function(t,e){const n=t.length;let o=Array(n).fill(0n),r=0,s=e;for(;s>0n;)1n&s&&(o=K(o,G(t,r))),s>>=1n,r++;return o}(t,function(t){const e=[0n,1n];for(let n=1;n<t;n++){const t=e[n],o=e[n-1];if(void 0!==t&&void 0!==o){const n=t<<1n;e.push(n^o)}}return e[t]??0n}(e+1));Y[o]=function(t){const e=t.length;let n=t,o=_(e);for(let r=0;r<e;r++){const t=1n<<BigInt(e-r-1);[n,o]=U(n,o);for(let s=0;s<e;s++){const e=n[s];if(void 0!==e&&s!==r&&e&t){const t=n[r],e=o[r];if(void 0!==t){const e=n[s];void 0!==e&&(n[s]=e^t)}if(void 0!==e){const t=o[s];void 0!==t&&(o[s]=t^e)}}}}return o}(r)}const r=Y[o],s=t.join(""),i=s?BigInt("0b"+s):0n;return r.map(t=>1&function(t){let e=0,n=t;if(n<0n)throw new Error("countBits called on negative bigint");for(;n>0n;)n&=n-1n,e++;return e}(t&i))}function q(t,e){return Array.from({length:t},()=>Array(e).fill(0))}function J(t,e,n){const o=n.length,r=n.map(t=>[...t]),s=r[t];if(s&&e>=0&&e<s.length){const t=s[e];void 0!==t&&(s[e]=1^t)}if(t>0){const n=r[t-1];if(n&&e>=0&&e<n.length){const t=n[e];void 0!==t&&(n[e]=1^t)}}if(t<o-1){const n=r[t+1];if(n&&e>=0&&e<n.length){const t=n[e];void 0!==t&&(n[e]=1^t)}}if(s){if(e>0){const t=s[e-1];void 0!==t&&(s[e-1]=1^t)}if(e<s.length-1){const t=s[e+1];void 0!==t&&(s[e+1]=1^t)}}return r}function Q(t,e){const n=q(t,e);for(let o=0;o<t;o++)for(let r=0;r<e;r++)if(Math.random()>.5){const s=[[o,r],[o-1,r],[o+1,r],[o,r-1],[o,r+1]];for(const o of s){const r=o[0],s=o[1];if(void 0!==r&&void 0!==s&&r>=0&&r<t&&s>=0&&s<e){const t=n[r];if(t&&s>=0&&s<t.length){const e=t[s];void 0!==e&&(t[s]=1^e)}}}}return n}function V(t,e){const{type:n,row:o,col:r}=e;let{grid:s,score:i,rows:a,cols:c,initialized:l}=t;switch(n){case"adjacent":void 0!==o&&void 0!==r&&(s=J(o,r,s));break;case"random":case"randomize":s=Q(a,c);break;case"resize":{const{newRows:t,newCols:n}=e;void 0!==t&&void 0!==n&&(a=t,c=n,s=Q(a,c),l=!0);break}case"reset":s=q(a,c),i=0;break;case"next":s=Q(a,c),i+=1;break;case"restore":if(e.state)return{...e.state}}return{grid:s,score:i,rows:a,cols:c,initialized:l||!1}}function X(t,e){const n=[...t];let o=t.at(-1);if(!o)return n;for(let r=1;r<e;r++)for(let t=0;t<e;t++){if(!o[r-1]?.[t])continue;const e=J(r,t,o);n.push(e),o=e}return n}function tt(t,e){const n=t.at(-1);if(!n)return t;const o=[...t];for(;o.length<e;)o.push([...n]);return o}function et(t,e){let n=q(e,e);for(const m of t){n=J(Math.floor(m/e),m%e,n)}const o=X([n],e),r=o.at(-1);if(!r)return{boardStates:[],inputStates:[],outputStates:[]};const s=r.at(-1);if(!s)return{boardStates:[],inputStates:[],outputStates:[]};const{input:i,output:a}=function(t,e){const n=Array(e).fill(0),o=[n],r=[n],s=[...n];for(let i=0;i<e;i++){if(!t[i])continue;s[i]=1;const n=[...s],a=Z(n,e,e);o.push(n),r.push(a)}return{input:o,output:r}}(s,e),c=o.length+i.length+1,l=a.at(-1);if(!l)return{boardStates:[],inputStates:[],outputStates:[]};let d=[...r];for(let m=0;m<c-o.length;m++)o.push([...r]);const f=i[0];for(let m=0;m<c-i.length;m++)f&&i.unshift([...f]);const u=a[0];for(let m=0;m<c-a.length;m++)u&&a.unshift([...u]);for(let m=0;m<e;m++)l[m]&&(d=J(0,m,d),o.push([...d]));const p=X(o,e),x=p.length;return{boardStates:p,inputStates:tt(i,x),outputStates:tt(a,x)}}const nt={FAST:"background-color 100ms ease-in-out, color 100ms ease-in-out, opacity 100ms ease-in-out, border-radius 100ms ease-in-out",DEFAULT:"background-color 200ms ease, color 200ms ease, opacity 200ms ease, border-radius 200ms ease"},ot={DROP:"drop-shadow(0 2px 4px rgba(0,0,0,0.2))"},rt=500,st=2e3,it=1.25,at={MOBILE:-28,DESKTOP:-40},ct="lights-out-size",lt="lights-out-state";function dt({getColor:t,getBorder:n}){return(o,r)=>{const{front:s}=t(o,r);return{backgroundColor:s,color:s,children:e.jsx(S,{}),style:n(o,r),sx:{transition:nt.DEFAULT}}}}function ft(e,n,o){return W(t.useCallback((t,o)=>0!==t||o<0||o>=n?-1:e[o],[e,n]),o)}function ut(t,e,n,o,r,s=1){const i=t.length,a={},c=100/i;for(let l=0;l<i;l++){const d=l*c,f=(l+1)*c;let u=r.secondary,p=!1,x="";const m=t[l],h=l+1<i?t[l+1]:null;if(m&&h){const t=J(e,n,m);p=!0;for(let e=0;e<o;e++){const n=t[e],r=h[e];if(!n||!r){p=!1;break}for(let t=0;t<o;t++)if(n[t]!==r[t]){p=!1;break}if(!p)break}if(p){u=1===m[e]?.[n]?r.secondary:r.primary,x=`"${String(l+1)}"`}}p?(a[`${String(d)}%`]={opacity:0,content:x,color:u,transform:"scale(0.5)"},a[`${String(d+c*(.1/s))}%`]={opacity:1,content:x,color:u,transform:"scale(1.2)"},a[`${String(d+c*(.2/s))}%`]={opacity:1,content:x,color:u,transform:"scale(1)"},a[`${String(f-c*(.1/s))}%`]={opacity:1,content:x,color:u,transform:"scale(1)"},a[`${String(f)}%`]={opacity:0,content:x,color:u,transform:"scale(0.5)"}):(a[`${String(d)}%`]={opacity:0,content:'""',color:u,transform:"scale(0.5)"},a[`${String(f)}%`]={opacity:0,content:'""',color:u,transform:"scale(0.5)"})}return a}function pt({start:o=[],dims:r=3,size:s,palette:i,getFrontProps:a,getBackProps:l}){const[d,f]=t.useState(0);t.useEffect(()=>{const t=setInterval(()=>{f(t=>t+1)},2e3);return()=>{clearInterval(t)}},[]);const u=et(o,r),p=s,{boardStates:x,inputStates:m,outputStates:h}=u,g=d%m.length,y=g===m.length-1,j=L({grid:x[g]??x[0]??[],rows:r,cols:r},i),S=a(j),k=l(j),w=function(t,n,o,r){return(s,i)=>{const a=ut(t,s,i,n,r),c=t.length,l=`${o}-board-icon-${String(s)}-${String(i)}`;return{icon:e.jsx(M,{sx:{width:"100%",height:"100%",position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",zIndex:2,"&::after":{content:'""',fontSize:{xs:"0.8rem",sm:"1.2rem"},fontWeight:"bold",filter:ot.DROP,paddingTop:{xs:"0.08rem",sm:"0.15rem"},animation:`${l} ${String(2*c)}s linear infinite`}}}),keyframes:a,keyframeName:l}}}(x,r,"example",i),z=ft(m[g]??[],r,i),C=ft(h[g]??[],r,i),$=dt(z),I=dt(C),P=function(t,n,o,r){return(n,s)=>{const i=t.length,a={},c=100/i;for(let e=0;e<i;e++){const n=e*c,o=(e+1)*c;let l=r.secondary,d=!1,f="";const u=t[e],p=e+1<i?t[e+1]:null;u&&p&&u[s]!==p[s]&&(d=!0,l=1===u[s]?r.secondary:r.primary,f=`"${String(e+1)}"`),d?(a[`${String(n)}%`]={opacity:0,content:f,color:l,transform:"scale(0.5)"},a[`${String(n+.05*c)}%`]={opacity:1,content:f,color:l,transform:"scale(1.2)"},a[`${String(n+.1*c)}%`]={opacity:1,content:f,color:l,transform:"scale(1)"},a[`${String(o-.05*c)}%`]={opacity:1,content:f,color:l,transform:"scale(1)"},a[`${String(o)}%`]={opacity:0,content:f,color:l,transform:"scale(0.5)"}):(a[`${String(n)}%`]={opacity:0,content:'""',color:l,transform:"scale(0.5)"},a[`${String(o)}%`]={opacity:0,content:'""',color:l,transform:"scale(0.5)"})}const l=`${o}-input-icon-${String(n)}-${String(s)}`;return{icon:e.jsx(M,{sx:{width:"100%",height:"100%",position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",zIndex:2,"&::after":{content:'""',fontSize:{xs:"0.8rem",sm:"1.2rem"},fontWeight:"bold",filter:ot.DROP,paddingTop:{xs:"0.08rem",sm:"0.15rem"},animation:`${l} ${String(2*i)}s linear infinite`}}}),keyframes:a,keyframeName:l}}}(m,0,"example",i);return e.jsx(xt,{boardStates:x,inputStates:m,dims:r,id:"example",palette:i,children:e.jsx(B,{container:!0,size:12,spacing:2,sx:{height:"100%"},children:e.jsxs(B,{container:!0,size:12,wrap:"nowrap",sx:{justifyContent:"center",alignItems:"center",flex:1,height:"100%",overflow:"hidden"},children:[e.jsx(B,{size:6,sx:{display:"flex",justifyContent:"center",alignItems:"center",overflow:"hidden"},children:e.jsxs(M,{sx:{position:"relative",display:"inline-flex"},children:[e.jsx(c,{size:p,rows:r,cols:r,frontProps:(t,n)=>{const o=S(t,n),r=w(t,n);return{...o,children:e.jsxs(e.Fragment,{children:[o.children,r.icon]}),sx:{...o.sx,position:"relative"}}},backProps:k}),e.jsx(M,{sx:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",opacity:y?1:0,transform:y?"scale(1)":"scale(0.5)",visibility:y?"visible":"hidden",transition:"all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1)",pointerEvents:"none",zIndex:10},children:(()=>{const t=x[m.length-1],n=t?.flat().every(t=>1===t);return e.jsx(v,{sx:{fontSize:{xs:"2.5rem",sm:"4rem"},color:n?i.secondary:i.primary}})})()})]})}),e.jsxs(B,{container:!0,size:6,spacing:2,sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[e.jsxs(M,{sx:{mb:2,textAlign:"center"},children:[e.jsx(T,{variant:"subtitle2",sx:{mb:1,color:n.text.secondary},children:"Input"}),e.jsx(b,{rows:1,cols:r,size:p,cellProps:(t,n)=>{const o=$(t,n),r=P(t,n);return{...o,children:e.jsxs(e.Fragment,{children:[o.children,r.icon]}),sx:{...o.sx,position:"relative"}}},space:0})]}),e.jsxs(M,{sx:{textAlign:"center"},children:[e.jsx(b,{rows:1,cols:r,size:p,cellProps:I,space:0}),e.jsx(T,{variant:"subtitle2",sx:{mt:1,color:n.text.secondary},children:"Result"})]})]})]})})})}function xt({boardStates:n,inputStates:o,dims:r,id:s,palette:i,children:a}){const c=t.useMemo(()=>[...n.flatMap((t,e)=>Array.from({length:r},(t,o)=>({name:`${s}-board-icon-${String(e)}-${String(o)}`,frames:ut(n,e,o,r,i)}))),...o.flatMap((t,e)=>{const n=`${s}-input-icon-0-${String(e)}`,r={},a=o.length,c=100/a;for(let s=0;s<a;s++){const t=s*c,n=(s+1)*c;let l=!1,d=i.secondary,f="";const u=o[s],p=s+1<a?o[s+1]:null;u&&p&&u[e]!==p[e]&&(l=!0,f=`"${String(s+1)}"`,d=1===u[e]?i.secondary:i.primary),l?(r[`${String(t)}%`]={opacity:0,content:f,color:d,transform:"scale(0.5)"},r[`${String(t+.05*c)}%`]={opacity:1,content:f,color:d,transform:"scale(1.2)"},r[`${String(t+.1*c)}%`]={opacity:1,content:f,color:d,transform:"scale(1)"},r[`${String(n-.05*c)}%`]={opacity:1,content:f,color:d,transform:"scale(1)"},r[`${String(n)}%`]={opacity:0,content:f,color:d,transform:"scale(0.5)"}):(r[`${String(t)}%`]={opacity:0,content:'""',color:d},r[`${String(n)}%`]={opacity:0,content:'""',color:d})}return{name:n,frames:r}})],[n,o,r,s,i]);return e.jsxs(e.Fragment,{children:[e.jsx("style",{children:c.map(t=>`\n                @keyframes ${t.name} {\n                    ${Object.entries(t.frames).map(([t,e])=>`\n                        ${t} {\n                            ${Object.entries(e).map(([t,e])=>`${t.replace(/[A-Z]/g,t=>`-${t.toLowerCase()}`)}: ${e};`).join(" ")}\n                        }\n                    `).join("")}\n                }\n            `).join("")}),a]})}const mt=({children:t})=>e.jsx(T,{variant:"h5",sx:{color:n.text.primary,fontWeight:o.fontWeight.bold,textAlign:"left",fontSize:o.fontSize.h2},children:t}),ht=({Icon:t,title:r,text:s})=>e.jsxs(M,{sx:{px:2},children:[e.jsxs(T,{variant:"h6",sx:{color:n.text.primary,fontWeight:o.fontWeight.semibold,display:"flex",alignItems:"center",mb:1.5,fontSize:o.fontSize.subheading},children:[e.jsx(t,{sx:{mr:2,color:n.primary.main,fontSize:"1.75rem"}}),r]}),e.jsx(T,{variant:"body1",sx:{color:n.text.secondary,lineHeight:1.6,fontSize:o.fontSize.body,ml:6},children:s})]}),gt=["Chasing Lights","How It Works","Calculator"],yt=y;function bt(o){const{rows:s,cols:i,size:a,open:c,palette:d,toggleOpen:f,getFrontProps:u,getBackProps:p}=o,x=j("md"),[m,h]=t.useState(0),[g,y]=t.useState(Array(i).fill(0));t.useEffect(()=>{y(Array(i).fill(0))},[i,d]);const v=t.useCallback(t=>{const e=parseInt(t,10);y(t=>{const n=[...t];return void 0!==n[e]&&(n[e]^=1),n})},[y]),A=Z(g,s,i),{getDragProps:B}=l({onAction:v,checkEnabled:()=>2===m,posAttribute:"data-col"}),W=ft(g,i,d),L=ft(A,i,d),H=function(t,n){const{getColor:o,getBorder:r}=t;return(t,s)=>{const{front:i,back:a}=o(t,s),c=n(s.toString());return{...c,backgroundColor:i,style:r(t,s),sx:{...c.sx,"&:hover":{cursor:"pointer",color:a}},color:i,children:e.jsx(S,{})}}}(W,B),N=dt(L),_=()=>{f()},G=`#${r.pages.LightsOutResearch}`;let K;return K=x?e.jsx(E,{component:"a",href:G,size:"small",sx:{color:n.text.secondary},children:e.jsx(R,{})}):e.jsx(F,{component:"a",href:G,variant:"outlined",size:"small",startIcon:e.jsx(R,{}),sx:{borderColor:n.border.subtle,color:n.text.secondary,fontSize:"0.75rem",py:.75,px:1.5,"&:hover":{borderColor:n.primary.main,color:n.primary.main,backgroundColor:n.interactive.hover}},children:"Analysis"}),e.jsx(D,{open:c,onClose:_,slots:{backdrop:O},slotProps:{backdrop:{sx:{backgroundColor:t=>"dark"===t.palette.mode?"hsla(0, 0%, 3%, 0.85)":"hsla(0, 0%, 98%, 0.85)",backdropFilter:"blur(12px) saturate(180%)",transition:"all 0.3s ease-in-out !important"}}},sx:{zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs(M,{sx:{outline:"none",display:"flex",justifyContent:"center",alignItems:"center",width:"100%"},children:[e.jsxs(yt,{onClick:t=>{t.stopPropagation()},sx:{width:"100%",maxWidth:"1000px",height:{xs:"630px",sm:"495px"},minHeight:{xs:"630px",sm:"495px"},display:"flex",flexDirection:"column",p:0,overflow:"hidden",position:"relative",m:2},children:[e.jsxs(M,{sx:{flex:1,overflowY:1===m?"hidden":"auto",p:{xs:2.5,md:3},display:"flex",flexDirection:"column"},children:[e.jsxs(M,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,px:2},children:[e.jsx(mt,{children:gt[m]}),e.jsxs(M,{sx:{display:"flex",gap:2,alignItems:"center"},children:[K,e.jsx(E,{onClick:_,size:"small",sx:{color:n.text.secondary},children:e.jsx(k,{})})]})]}),0===m&&e.jsx(M,{sx:{animation:"fadeIn 0.3s ease",flex:1,display:"flex",flexDirection:"column"},children:e.jsxs(M,{sx:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center",gap:4},children:[e.jsx(ht,{Icon:w,title:"Chase to Bottom",text:"Turn off rows from top to bottom by clicking lights in each row to push them down."}),e.jsx(ht,{Icon:z,title:"Use Calulator",text:"Enter the remaining lights pattern from the bottom row into the calculator on the last page."}),e.jsx(ht,{Icon:C,title:"Chase Again",text:"Apply the solution pattern to the top row, then chase them down again to solve the puzzle."})]})}),1===m&&e.jsx(M,{sx:{flex:1,display:"flex",flexDirection:"column",animation:"fadeIn 0.3s ease"},children:e.jsx(M,{sx:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center"},children:e.jsx(pt,{dims:3,size:.7*a,start:[1,3,8],palette:d,getFrontProps:u,getBackProps:p})})}),2===m&&e.jsx(M,{sx:{animation:"fadeIn 0.3s ease",textAlign:"center",flex:1,display:"flex",flexDirection:"column"},children:e.jsxs(M,{sx:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center",gap:3},children:[e.jsxs(M,{children:[e.jsxs(T,{variant:"subtitle2",sx:{mb:1,color:n.text.primary,fontWeight:"bold"},children:["Input"," ",e.jsx(M,{component:"span",sx:{color:n.text.secondary,fontWeight:"normal"},children:"(Bottom Row)"})]}),e.jsx(b,{space:0,rows:1,cols:i,size:a*(x?.9:.8),cellProps:H})]}),e.jsxs(M,{children:[e.jsxs(T,{variant:"subtitle2",sx:{mb:1,color:n.text.primary,fontWeight:"bold"},children:["Solution"," ",e.jsx(M,{component:"span",sx:{color:n.text.secondary,fontWeight:"normal"},children:"(Top Row)"})]}),e.jsx(b,{space:0,rows:1,cols:i,size:a*(x?.9:.8),cellProps:N})]}),e.jsx(M,{sx:{display:"flex",justifyContent:"center"},children:e.jsx(F,{variant:"outlined",size:"small",startIcon:e.jsx($,{}),onClick:()=>{y(Array(i).fill(0))},sx:{borderColor:n.border.subtle,color:n.text.secondary},children:"Clear Pattern"})})]})})]}),e.jsxs(M,{sx:{p:2.5,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(F,{onClick:()=>{m>0&&h(m-1)},disabled:0===m,startIcon:e.jsx(I,{}),sx:{visibility:0===m?"hidden":"visible",color:n.text.primary},children:"Back"}),e.jsx(M,{sx:{display:"flex",gap:1},children:[0,1,2].map(t=>e.jsx(M,{sx:{width:8,height:8,borderRadius:"50%",backgroundColor:m===t?n.primary.main:n.interactive.disabled,transition:"background-color 0.3s"}},t))}),e.jsx(F,{onClick:()=>{m<2?h(m+1):f()},disabled:2===m,endIcon:e.jsx(P,{}),sx:{visibility:2===m?"hidden":"visible",color:n.text.primary},children:"Next"})]})]}),e.jsx("style",{children:"\n                    @keyframes fadeIn {\n                        from { opacity: 0; transform: translateY(10px); }\n                        to { opacity: 1; transform: translateY(0); }\n                    }\n                "})]})})}const jt=e.jsx(M,{sx:{width:"45%",height:"45%",borderRadius:"50%",backgroundColor:"currentColor"}});function St(t,e){const{getColor:n,getBorder:o}=t;return(t,r)=>{const s=o(t,r),{front:i,back:a}=n(t,r),c=`${t.toString()},${r.toString()}`,l=e(c);return{...l,children:jt,backgroundColor:i,color:i,style:s,sx:{...l.sx,"&:hover":{cursor:"pointer",color:a}}}}}function vt(t){return(e,n)=>({backgroundColor:t.getFiller(e,n),transition:nt.FAST})}function kt(t){const e=St(t,t=>({onMouseDown:()=>{},onMouseEnter:()=>{},onTouchStart:()=>{},"data-pos":t,sx:{touchAction:"none",transition:"none"}}));return(t,n)=>({...e(t,n),onMouseDown:void 0,onMouseEnter:void 0,onTouchStart:void 0,sx:{}})}function wt(){const{rows:o,cols:r,dynamicSize:l,handlePlus:y,handleMinus:b,mobile:j,minSize:S,maxSize:v}=d({storageKey:ct,defaultSize:null,headerOffset:{mobile:a.headerHeight.xs,desktop:a.headerHeight.md},cellSizeReference:{mobile:H.mobile,desktop:H.desktop},paddingOffset:120,mobileRowOffset:-2}),k=t.useMemo(()=>({grid:q(o,r),score:0,rows:o,cols:r,initialized:!1}),[o,r]),[w,z]=t.useReducer(V,k),[C,$]=t.useReducer(t=>!t,!1),I=t.useMemo(()=>({primary:n.primary.main,secondary:n.primary.dark}),[]),P=t.useMemo(()=>w.initialized&&function(t){const e=t.flat();return!e.includes(1)||!e.includes(0)}(w.grid),[w.initialized,w.grid]),{getDragProps:R}=f({onToggle:(t,e)=>{z({type:"adjacent",row:t,col:e})},checkEnabled:()=>!P,touchTimeout:rt,transition:nt.FAST}),B=t.useMemo(()=>w.initialized&&w.grid.flat().every(t=>1===t),[w.initialized,w.grid]),M=t.useCallback(()=>{z({type:"next"})},[]);u({storageKey:lt,rows:o,cols:r,state:w,onRestore:t=>{z({type:"restore",state:t})}}),p(P,M,st),x(s.lightsOut),t.useEffect(()=>{z({type:"resize",newRows:o,newCols:r})},[o,r]);const T=L(w,I),D=m({rows:o,cols:r,headerOffset:{mobile:a.headerHeight.xs,desktop:a.headerHeight.md},paddingOffset:180,boardMaxWidth:1200,boardSizeFactor:.9,maxCellSize:80,remBase:16}),O=t.useMemo(()=>St(T,R),[T,R]),E=t.useMemo(()=>vt(T),[T]),F=e.jsx(g,{rows:o,cols:r,dynamicSize:l,minSize:S,maxSize:v,handlePlus:y,handleMinus:b,onRefresh:M,children:e.jsx(i,{title:"How to Play",Icon:A,onClick:$})});return e.jsxs(h,{title:s.lightsOut,infoUrl:"https://en.wikipedia.org/wiki/Lights_Out_(game)",showTrophy:P,onReset:M,boardSize:D,iconSizeRatio:it,primaryColor:I.primary,secondaryColor:I.secondary,useSecondaryTrophy:B,boardSx:{marginTop:j?`${String(at.MOBILE)}px`:`${String(at.DESKTOP)}px`},controls:F,children:[e.jsx(c,{size:D,rows:o,cols:r,frontProps:O,backProps:E}),C&&e.jsx(bt,{rows:o,cols:r,size:D,open:C,palette:I,toggleOpen:$,getFrontProps:kt,getBackProps:vt})]})}export{wt as default};
