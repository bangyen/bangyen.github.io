import{r as e,j as t}from"./vendor_react-DdkxgTu-.js";import{B as n,d as r,e as o,u as s}from"./vendor_mui_core-BDo3HO1u.js";import{T as i,a,L as c,f as l,e as u,E as d,C as m,S as f}from"./index-TYa23pwm.js";import{l as h,m as p,E as g}from"./vendor_mui_icons-D_gaIqb2.js";import{G as x,P as b,t as S}from"./PageLayout-CbrkcNmG.js";const w={gridSizes:{mobile:2.5,desktop:4},timing:{winAnimationDelay:2e3,interactionDelay:500,touchHoldDelay:500},layout:{headerHeight:{mobile:64,desktop:80}}},y={divisor:4,fontSizeMultiplier:.375};const z={PADDING:{MOBILE:"30px",DESKTOP:"36px"},BORDER_RADIUS:"24px",BORDER:"2px solid transparent",SHADOW:"0 2px 4px rgba(0,0,0,0.2)",DROP_SHADOW:"drop-shadow(0 2px 4px rgba(0,0,0,0.2))"};function v(e){return{SIZE:`${e}-size`,STATE:`${e}-state`}}const E={boardMaxWidth:1200,boardSizeFactor:.94,remBase:16},R={minSize:3,mobileRowOffset:2,headerOffset:w.layout.headerHeight},M=e.memo(function({size:r,children:o,...s}){const c=`${r.toString()}rem`,l=`${(r/y.divisor).toString()}rem`,{backgroundColor:u,color:d,boxShadow:m,border:f,opacity:h,transition:p=!0,sx:g,...x}=s,b=!1===p?"none":"string"==typeof p?p:"background-color 200ms ease, color 200ms ease, opacity 200ms ease, transform 200ms ease, border-radius 200ms ease",S=e.useMemo(()=>({...a.flexCenter,borderRadius:l,height:c,width:c,fontSize:`${(r*y.fontSizeMultiplier).toString()}rem`,fontWeight:i.fontWeight.semibold,fontFamily:"monospace"}),[l,c,r]);return t.jsx(n,{role:"gridcell",...S,...x,sx:{backgroundColor:u,color:d,boxShadow:m,border:f,opacity:h,transition:b,...g},children:o})}),D=e.memo(function({cols:r,size:o,index:s,spacing:i,cellProps:a}){return t.jsx(n,{role:"row",sx:{display:"flex",gap:i,justifyContent:"center"},children:Array.from({length:r},(t,n)=>e.createElement(M,{...a(s,n),key:`${s.toString()}_${n.toString()}`,size:o}))})}),j=e.memo(function({size:e,rows:r,cols:o,cellProps:s,space:i,sx:a,...c}){const l=function(e){return`${(e*y.divisor).toString()}px`}(e),u=`${(i??l).toString()}rem`;return t.jsx(n,{role:"grid","aria-label":`Grid with ${r.toString()} rows and ${o.toString()} columns`,sx:{display:"flex",flexDirection:"column",alignItems:"center",gap:u,...a},...c,children:Array.from({length:r},(n,r)=>t.jsx(D,{index:r,cols:o,size:e,spacing:u,cellProps:s},`row_${r.toString()}`))})});function k(e){const{frontProps:r,backProps:o,size:s,rows:i,cols:a,frontLayerSx:l,backLayerSx:u}=e,d=l&&"pointerEvents"in l&&"none"===l.pointerEvents,m=u&&"pointerEvents"in u&&"none"===u.pointerEvents;return t.jsxs(n,{sx:{display:"grid",placeItems:"center"},children:[t.jsx(n,{sx:{gridArea:"1/1",...u},children:t.jsx(j,{space:0,size:s,rows:i-1,cols:a-1,cellProps:o,...m?{role:"presentation","aria-hidden":!0}:{}})}),t.jsx(n,{sx:{gridArea:"1/1",zIndex:c.zIndex.base+1,...l},children:t.jsx(j,{space:0,size:s,rows:i,cols:a,cellProps:r,...d?{role:"presentation","aria-hidden":!0}:{}})})]})}function C({rows:e,cols:n,dynamicSize:r,minSize:o,maxSize:s,handlePlus:i,handleMinus:a,onRefresh:c,disabled:d=!1,children:m}){const f=Math.min(e,n)<=o,g=Math.min(e,n)>=s||Math.min(e,n)>=Math.min(r.rows,r.cols);return t.jsxs(l,{onRefresh:c,children:[t.jsx(u,{title:"Decrease Size",Icon:h,onClick:a,disabled:d||f}),t.jsx(u,{title:"Increase Size",Icon:p,onClick:i,disabled:d||g}),m]})}const I=({children:e})=>t.jsx(d,{FallbackComponent:({error:e,resetErrorBoundary:s})=>t.jsx(n,{sx:{display:"flex",justifyContent:"center",alignItems:"center",p:4,minHeight:"300px"},children:t.jsxs(x,{sx:{p:4,maxWidth:"500px",textAlign:"center"},children:[t.jsx(r,{variant:"h5",sx:{mb:2,color:m.text.primary,fontWeight:"bold"},children:"Game Error"}),t.jsx(r,{sx:{mb:3,color:m.text.secondary,fontFamily:"monospace",fontSize:"0.9rem"},children:e?.message??"An unexpected error occurred."}),t.jsx(o,{variant:"contained",onClick:s,sx:{borderRadius:f.borderRadius.md,textTransform:"none"},children:"Reset Game"})]})}),children:e});function T({show:e,onReset:o,size:s,iconSizeRatio:i,primaryColor:a,secondaryColor:c,useSecondary:l=!1}){const u=l?c:a;return t.jsx(n,{sx:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",opacity:e?1:0,transform:e?"scale(1)":"scale(0.5)",visibility:e?"visible":"hidden",transition:"all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1)",zIndex:10,backgroundColor:"transparent",pointerEvents:"none"},children:s>0&&t.jsxs(x,{padding:f.padding.md,sx:{display:"flex",flexDirection:"column",alignItems:"center",gap:1.5,height:"auto",width:"auto",maxWidth:"80%"},children:[t.jsx(g,{sx:{fontSize:`${(s*i*.6).toString()}rem`,color:u,filter:"drop-shadow(0 4px 12px rgba(0,0,0,0.1))"}}),t.jsx(r,{variant:"h6",sx:{color:m.text.primary,fontWeight:600,letterSpacing:"0.02em"},children:"Solved!"})]})})}function O({children:e,controls:r,infoUrl:o,_title:s,background:i=m.surface.background,paddingBottom:a={xs:"80px",md:"120px"},contentSx:c={},showTrophy:l=!1,onReset:u,boardSize:d=0,iconSizeRatio:f=1,primaryColor:h=m.primary.main,secondaryColor:p=m.primary.main,useSecondaryTrophy:g=!1,boardSx:x,onClick:w}){return t.jsx(I,{children:t.jsxs(b,{infoUrl:o,background:i,containerSx:{height:"100vh",transition:"background 0.5s ease-in-out",cursor:w?"pointer":"inherit"},sx:{justifyContent:"center",alignItems:"center"},onClick:w,children:[t.jsx(n,{sx:[{flex:1,position:"relative",width:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",overflow:"hidden",pb:a},...S(c)],children:t.jsxs(n,{sx:[{position:"relative",width:"fit-content",userSelect:"none",padding:{xs:z.PADDING.MOBILE,sm:z.PADDING.DESKTOP},borderRadius:z.BORDER_RADIUS,border:z.BORDER},...S(x)],children:[e,t.jsx(T,{show:l,onReset:u,size:d,iconSizeRatio:f,primaryColor:h,secondaryColor:p,useSecondary:g})]})}),r]})})}function P({storageKey:t,rows:n,cols:r,state:o,onRestore:s,serialize:i,deserialize:a,enabled:c=!0,saveDebounceMs:l=300}){const u=`${t}-${String(n)}x${String(r)}`,d=e.useRef(s),m=e.useRef(a),f=e.useRef(i);e.useEffect(()=>{d.current=s,m.current=a,f.current=i}),e.useEffect(()=>{if(!c)return;const e=localStorage.getItem(u);if(e)try{const t=JSON.parse(e),n=m.current??(e=>e);d.current(n(t))}catch{localStorage.removeItem(u)}},[u,c]),e.useEffect(()=>{if(!c)return;const e=setTimeout(()=>{const e=(f.current??(e=>e))(o);localStorage.setItem(u,JSON.stringify(e))},l);return()=>{clearTimeout(e)}},[u,o,c,l])}function A(){const{innerWidth:e,innerHeight:t}=globalThis;return{width:e,height:t}}function $(){const{size:t}=function(t){const[n,r]=e.useState(t());return e.useEffect(()=>{function e(){r(t())}return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[t]),{size:n,setSize:r}}(A);return t}function L(e){return s(t=>t.breakpoints.down(e))}function B({storageKey:t,defaultSize:n,minSize:r=2,maxSize:o=10,headerOffset:s,paddingOffset:i=0,widthLimit:a=1300,cellSizeReference:c,mobileRowOffset:l=0}){const{height:u,width:d}=$(),m=L("sm"),[f,h]=e.useState(()=>{const e=localStorage.getItem(t);return"null"===e?null:e?Number.parseInt(e,10):n}),p=e.useMemo(()=>{const e=m?s.mobile:s.desktop,t="number"==typeof c?c:m?c.mobile:c.desktop,n="number"==typeof i?0:i.x,o="number"==typeof i?i:i.y,f=function(e,t,n){const r=16*e;return{rows:Math.floor(t/r),cols:Math.floor(n/r)}}(t,u-e-o,Math.min(d,a)-n);let h=f.rows-1;const p=f.cols-1;return m&&(h+=l),{rows:Math.max(r,h),cols:Math.max(r,p)}},[c,u,d,m,s,i,a,r,l]),{rows:g,cols:x}=e.useMemo(()=>{if(null===f)return p;const e=m?Math.max(0,l+1):0;return{rows:Math.min(f+e,p.rows),cols:Math.min(f,p.cols)}},[f,p,m,l]);e.useEffect(()=>{localStorage.setItem(t,String(f))},[f,t]);return{rows:g,cols:x,dynamicSize:p,handlePlus:()=>{const e=Math.min(g,x);null!==f&&e<Math.min(p.rows,p.cols)&&e<o&&h(e+1)},handleMinus:()=>{const e=Math.min(g,x);if(null===f){const e=Math.min(p.rows,p.cols);p.rows===p.cols?h(Math.max(r,e-1)):h(e)}else e>r&&h(e-1)},desiredSize:f,setDesiredSize:h,mobile:m,width:d,height:u,minSize:r,maxSize:o}}function W({storageKeys:t,pageTitle:n,gridConfig:r,boardConfig:o,reducer:s,getInitialState:i,winAnimationDelay:a,isSolved:c,persistence:l,manualResize:u=!1,onNext:d}){const m={...R,...r},f=e.useMemo(()=>({...E,...o}),[o]),{rows:h,cols:p,dynamicSize:g,handlePlus:x,handleMinus:b,mobile:S,minSize:w,maxSize:y}=B({storageKey:t.size,...m}),z=e.useRef(null);null===z.current&&(z.current=i(h,p));const[v,M]=e.useReducer(s,z.current),D=e.useMemo(()=>c(v),[v,c]),j=e.useCallback(()=>{M({type:"new"})},[M]),k=d??j;var C;P({storageKey:t.state,rows:h,cols:p,state:v,onRestore:e=>{M({type:"restore",state:e}),M({type:"hydrate",state:e})},...l}),function(t,n,r=2e3){const o=e.useRef(n);o.current=n,e.useEffect(()=>{if(t){const e=setTimeout(()=>{o.current()},r);return()=>{clearTimeout(e)}}},[t,r])}(D,k,a),C=n,e.useEffect(()=>{document.title=C},[C]),e.useEffect(()=>{u||M({type:"resize",rows:h,cols:p,newRows:h,newCols:p})},[h,p,M,u]);const I=e.useMemo(()=>"function"==typeof f.paddingOffset?f.paddingOffset(S):f.paddingOffset,[f,S]),T=function({rows:t,cols:n,headerOffset:r,paddingOffset:o,boardMaxWidth:s,boardSizeFactor:i,maxCellSize:a,remBase:c}){const{width:l,height:u}=$(),d=L("sm");return e.useMemo(()=>{const e=d?r.mobile:r.desktop,m="number"==typeof o?0:o.x,f="number"==typeof o?o:o.y,h=(Math.min(l,s)-m)*i,p=(u-e-f)*i;return Math.min(h/n,p/t,a)/c},[l,u,d,t,n,r,o,s,i,a,c])}({rows:h+(f.rowOffset??0),cols:p+(f.colOffset??0),headerOffset:m.headerOffset,...f,paddingOffset:I});return{rows:h,cols:p,state:v,dispatch:M,size:T,mobile:S,solved:D,handleNext:k,controlsProps:{rows:h,cols:p,dynamicSize:g,minSize:w,maxSize:y,handlePlus:x,handleMinus:b,onRefresh:k}}}function _({onAction:t,checkEnabled:n=()=>!0,touchTimeout:r=500,posAttribute:o="data-pos",preventDefault:s=!0,transition:i="all 0.2s"}){const[a,c]=e.useState(null),l=e.useRef(new Set),u=e.useRef(0),d=e.useCallback(()=>{c(null),l.current.clear()},[]),m=e.useCallback(e=>{if(null===a)return;const n=e.touches[0];if(!n)return;const r=document.elementFromPoint(n.clientX,n.clientY);if(!r)return;const s=r.closest(`[${o}]`);if(s){const e=s.getAttribute(o);e&&!l.current.has(e)&&(t(e,2===a,!1),l.current.add(e))}},[a,t,o]);e.useEffect(()=>(globalThis.addEventListener("mouseup",d),globalThis.addEventListener("touchend",d),globalThis.addEventListener("touchcancel",d),globalThis.addEventListener("touchmove",m,{passive:!1}),()=>{globalThis.removeEventListener("mouseup",d),globalThis.removeEventListener("touchend",d),globalThis.removeEventListener("touchcancel",d),globalThis.removeEventListener("touchmove",m)}),[d,m]);const f=e.useCallback(e=>({onMouseDown:o=>{n()&&(0!==o.button&&2!==o.button||Date.now()-u.current<r||(s&&o.preventDefault(),c(o.button),t(e,2===o.button,!0),l.current.add(e)))},onMouseEnter:()=>{null!==a&&!l.current.has(e)&&n()&&(t(e,2===a,!1),l.current.add(e))},onTouchStart:r=>{n()&&(r.cancelable&&s&&r.preventDefault(),u.current=Date.now(),c(0),t(e,!1,!0),l.current.add(e))},onKeyDown:r=>{n()&&("Enter"!==r.key&&" "!==r.key||(r.preventDefault(),t(e,!1,!0)))},onContextMenu:e=>{s&&e.preventDefault()},[o]:e,role:"button",tabIndex:0,sx:{touchAction:"none",transition:i}}),[t,n,a,r,o,s,i]);return{isDragging:null!==a,draggingButton:a,getDragProps:f,lastTouchTime:u}}function H({onToggle:t,checkEnabled:n,touchTimeout:r,transition:o,posAttribute:s}){const i=e.useRef(void 0),a=e.useRef(t);a.current=t;const c=e.useCallback((e,t,r)=>{if(!n())return;const[o,s]=e.split(",").map(Number);void 0!==o&&void 0!==s&&(r?i.current=a.current(o,s,t,void 0,!0):a.current(o,s,t,i.current,!1))},[n]),{getDragProps:l}=_({onAction:c,checkEnabled:n,touchTimeout:r,transition:o,posAttribute:s});return{getDragProps:l}}function N(e,t){return`${e.toString()},${t.toString()}`}function G(e){return(t,n)=>{if(e.customHandler){const r=e.customHandler(t,n);if(r!==t)return r}switch(n.type){case"resize":if("newRows"in n||"rows"in n||"cols"in n){const r=n.newRows??n.rows??t.rows,o=n.newCols??n.cols??t.cols;return r===t.rows&&o===t.cols?t:e.getInitialState(r,o)}return t;case"new":case"next":case"reset":return e.getInitialState(t.rows,t.cols);case"restore":case"hydrate":return"state"in n?n.state:t;default:return t}}}function K(t,n,r){return e.useMemo(()=>t(n,...r),[t,n,r])}const F=e=>{if(e<1||e>100)throw new Error("Invalid grid size: must be between 1 and 100");return e},U=e=>{if(e<0)throw new Error("Invalid cell index: cannot be negative");return e};export{z as B,j as C,O as G,F as a,v as b,G as c,k as d,_ as e,W as f,N as g,H as h,K as i,C as j,w as k,U as l,P as m,L as u};
