import{j as e,a as n,r}from"./vendor_react-De-BR_RD.js";import{B as t,l as o,g as s,d as l,G as i,u as a,C as c,b as u,m as d,T as f,n as p,L as g,o as h,e as y,c as m,a as x,h as b,f as S,i as v,j as w,k as A}from"./useBaseGame-BLbUA-Ad.js";import{T as C}from"./PageLayout-zqQjDcDy.js";import{d as I,T as N,B as k}from"./vendor_mui_core-hUAqgBQf.js";import{c as E,D as j,d as M,P as O,T,e as R,N as P}from"./vendor_mui_icons-BTq-bsb5.js";import{C as z,L as D,A as L,S as $,F as B,t as _,P as H}from"./index-BB_VRBM2.js";import{u as G,E as W}from"./lazyNamed-Ul4ADbaG.js";import{E as Y}from"./ErrorState-DldcMCCz.js";function q({onCopy:n,onClear:r,onClose:t}){return e.jsxs(I,{sx:{display:"flex",justifyContent:"center",gap:2,position:"absolute",bottom:-90,left:0,right:0,pointerEvents:"auto",zIndex:D.zIndex.base+5,paddingBottom:2},children:[e.jsx(C,{title:"Copy Board",Icon:E,onClick:n,sx:{backgroundColor:z.interactive.selected,color:z.primary.main,"&:hover":{backgroundColor:z.interactive.focus}}}),e.jsx(C,{title:"Clear Analysis",Icon:j,onClick:r,sx:{backgroundColor:"rgba(255, 68, 68, 0.1)",color:z.data.red,"&:hover":{backgroundColor:"rgba(255, 68, 68, 0.2)"}}}),e.jsx(C,{title:"Close Analysis",Icon:M,onClick:t,sx:{backgroundColor:"rgba(255, 193, 7, 0.1)",color:z.data.amber,"&:hover":{backgroundColor:"rgba(255, 193, 7, 0.2)"}}})]})}const U=.4,K=100,V=1e3,F=100,J=.8,X={...o("slant"),ANALYSIS_MOVES:"slant-analysis-moves"},Q=0,Z=8,ee=5,ne={COLORS:{WHITE:"#fff"},SHADOWS:{LINE:t.SHADOW,HINT:"0 4px 8px rgba(0,0,0,0.1)"},ANALYSIS:{BG_SUBTLE:"var(--slant-analysis-bg-subtle)",BG_HOVER:"var(--slant-analysis-bg-hover)",DASHED_BORDER:"var(--slant-analysis-dashed-border)",HINT_BG:"var(--slant-analysis-hint-bg)",HINT_BORDER:"var(--slant-analysis-hint-border)",HINT_TEXT:"var(--slant-analysis-hint-text)"},ANIMATIONS:{POP_IN:"\n            @keyframes slant-pop-in {\n                0% { transform: var(--slant-base-transform) scale(0.5); opacity: 0; }\n                70% { transform: var(--slant-base-transform) scale(1.1); opacity: 1; }\n                100% { transform: var(--slant-base-transform) scale(1); opacity: 1; }\n            }\n        ",POP_IN_STYLE:"slant-pop-in 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards"}},re=1,te=2,oe=n.memo(function({value:n,color:r,size:t}){const o=`${String(Math.max(2,t))}px`;return e.jsxs(I,{sx:{width:"100%",height:"100%",position:"relative"},children:[n===re&&e.jsx(I,{sx:{position:"absolute",width:"115%",height:o,backgroundColor:r,borderRadius:$.borderRadius.full,top:"50%",left:"50%","--slant-base-transform":"translate(-50%, -50%) rotate(-45deg)",transform:"var(--slant-base-transform)",boxShadow:ne.SHADOWS.LINE,transition:L.transition,animation:ne.ANIMATIONS.POP_IN_STYLE,pointerEvents:"none"}}),n===te&&e.jsx(I,{sx:{position:"absolute",width:"115%",height:o,backgroundColor:r,borderRadius:$.borderRadius.full,top:"50%",left:"50%","--slant-base-transform":"translate(-50%, -50%) rotate(45deg)",transform:"var(--slant-base-transform)",boxShadow:ne.SHADOWS.LINE,transition:L.transition,animation:ne.ANIMATIONS.POP_IN_STYLE,pointerEvents:"none"}})]})}),se=n.memo(function({value:n,hasConflict:r,isSatisfied:t,numberSize:o}){return e.jsx(I,{sx:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:`${String(.5*o)}rem`,fontWeight:"800",color:r?ne.COLORS.WHITE:t?z.interactive.disabledText:ne.ANALYSIS.HINT_TEXT,boxShadow:t&&!r?"none":ne.SHADOWS.HINT,opacity:t?.6:1,transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)",userSelect:"none",WebkitUserSelect:"none",paddingTop:"0.05rem",lineHeight:1,transform:r?"scale(1.15)":t?"scale(0.95)":"scale(1)"},children:n??""})});class le{constructor(e){this.parent=Array.from({length:e},(e,n)=>n)}find(e){const n=this.parent[e];if(void 0===n)throw new Error(`DSU: Index ${String(e)} out of bounds`);n!==e&&(this.parent[e]=this.find(n));const r=this.parent[e];if(void 0===r)throw new Error(`DSU: Parent of ${String(e)} became undefined`);return r}union(e,n){const r=this.find(e),t=this.find(n);return r!==t&&(this.parent[r]=t,!0)}connected(e,n){return this.find(e)===this.find(n)}}function ie(e,n,r){return e*(r+1)+n}function ae(e,n,r){const t=new Map,o=new Set;for(let s=0;s<n;s++)for(let n=0;n<r;n++){const o=e[s]?.[n];if(!o||0===o)continue;const l=ie(s,o===re?n+1:n,r),i=ie(s+1,o===re?n:n+1,r);t.has(l)||t.set(l,[]),t.has(i)||t.set(i,[]),t.get(l)?.push({node:i,r:s,c:n}),t.get(i)?.push({node:l,r:s,c:n})}const l=new Set,i=new Set,a=[],c=(e,n)=>{l.add(e),i.add(e);const r=t.get(e)??[];for(const{node:t,r:u,c:d}of r)if(t!==n)if(i.has(t)){o.add(s(u,d));for(let e=a.length-1;e>=0;e--){const n=a[e];if(!n)break;if(o.add(s(n.r,n.c)),n.u===t||n.v===t)break}}else l.has(t)||(a.push({r:u,c:d,u:e,v:t}),c(t,e),a.pop());i.delete(e)};for(const s of t.keys())l.has(s)||c(s,-1);return o}function ce({rows:e,cols:n,numbers:t,userMoves:o}){const[l,i]=r.useState(new Map),[a,c]=r.useState([]),[u,d]=r.useState(new Set),f=r.useRef(null),[p,g]=r.useState("probing");return r.useEffect(()=>{let e=!1;const n=new Worker(new URL("/assets/solverWorker-COVc7Vrp.js",import.meta.url),{type:"module"});f.current=n;const r=setTimeout(()=>{e||(g("broken"),f.current=null,n.terminate())},2e3);return n.onmessage=n=>{if(e)return;const t=n.data;"RESULT"===t.type&&g(e=>{if("probing"===e)return clearTimeout(r),"healthy";const{gridState:n,conflicts:o,cycleCells:s}=t.payload;return i(n),c(o),d(s),e})},n.onerror=()=>{clearTimeout(r),g("broken"),f.current=null,n.terminate()},n.postMessage({type:"SOLVE",payload:{rows:2,cols:2,numbers:[[null,null,null],[null,null,null],[null,null,null]],userMoves:new Map}}),()=>{e=!0,clearTimeout(r),n.terminate()}},[]),r.useEffect(()=>{if("healthy"===p&&f.current)f.current.postMessage({type:"SOLVE",payload:{rows:e,cols:n,numbers:t,userMoves:o}});else if("broken"===p){const r=function(e,n,r,t){const o=new Map,l=[],i=[];t.forEach((e,n)=>{o.set(n,{state:e,source:"user"});const[r,t]=n.split(",").map(Number);void 0!==r&&void 0!==t&&l.push({r:r,c:t})});const a=(r,t)=>{if(r<0||r>=e||t<0||t>=n)return 0;const l=s(r,t);return o.get(l)?.state??0},c=(e,n,r,t)=>{const a=s(e,n),c=o.get(a);c?c.state!==r&&i.push({type:"cell",r:e,c:n}):(o.set(a,{state:r,source:t}),l.push({r:e,c:n}))},u=(r,t)=>[{r:r-1,c:t-1,required:te},{r:r-1,c:t,required:re},{r:r,c:t-1,required:re},{r:r,c:t,required:te}].filter(r=>r.r>=0&&r.r<e&&r.c>=0&&r.c<n);let d=0;for(;d<l.length;){const e=l[d++];if(!e)break;const{r:n,c:t}=e,f=[{r:n,c:t},{r:n,c:t+1},{r:n+1,c:t},{r:n+1,c:t+1}];for(const l of f){const e=r[l.r]?.[l.c];if(null==e)continue;const d=u(l.r,l.c);let f=0;const p=[];for(const n of d){const e=a(n.r,n.c);0===e?p.push(n):e===n.required&&f++}if(f>e)i.push({type:"node",r:l.r,c:l.c});else if(f+p.length<e)i.push({type:"node",r:l.r,c:l.c});else if("user"===o.get(s(n,t))?.source)if(f===e&&p.length>0)for(const n of p){const e=n.required===re?te:re;c(n.r,n.c,e,"propagated")}else if(f+p.length===e&&p.length>0)for(const n of p)c(n.r,n.c,n.required,"propagated")}}const f=Array.from({length:e},()=>new Array(n).fill(0));for(const[s,g]of o.entries()){const[e,n]=s.split(",").map(Number);void 0!==e&&void 0!==n&&f[e]&&(f[e][n]=g.state)}const p=ae(f,e,n);return{gridState:o,conflicts:i,cycleCells:p}}(e,n,t,o);i(r.gridState),c(r.conflicts),d(r.cycleCells)}},[o,t,e,n,p]),{gridState:l,conflicts:a,cycleCells:u}}function ue({rows:n,cols:o,numbers:u,size:d,initialMoves:f,onMove:p,onCopy:g,onClear:h,onClose:y}){const m=G("sm"),x=f,{getDragProps:b}=l({onToggle:(e,n,r,t,o)=>{const l=s(e,n);if(!o)return void p(l,t);const i=x.get(l);let a;return a=r?i===re?te:i===te?void 0:re:i===te?re:i===re?void 0:te,p(l,a),a},touchTimeout:i.timing.touchHoldDelay,checkEnabled:()=>!0}),{handleKeyDown:S}=a({rows:n,cols:o}),v=r.useCallback(e=>{const n=b(e);return{...n,onKeyDown:e=>{n.onKeyDown(e),S(e)}}},[b,S]),{gridState:w,conflicts:A,cycleCells:C}=ce({rows:n,cols:o,numbers:u,userMoves:x}),N=d*U,k=d-N+.125,E=r.useMemo(()=>new Set(A.filter(e=>"cell"===e.type).map(e=>s(e.r,e.c))),[A]),j=r.useMemo(()=>new Set(A.filter(e=>"node"===e.type).map(e=>s(e.r,e.c))),[A]),M=r.useCallback((n,r)=>function({r:n,c:r,gridState:t,conflictSet:o,cycleCells:l,getDragProps:i,size:a}){const c=s(n,r),u=t.get(c),d=u?.state??0,f=u?.source,p=o.has(c),g=l.has(c),h=i(c);let y=z.text.primary;return p?y=z.data.red:g?y="user"===f?z.data.red:z.data.orange:"user"===f?y=z.primary.main:"propagated"===f&&(y=z.data.green),{...h,"data-pos":c,"data-type":"cell",sx:{...h.sx,cursor:"pointer",outline:"none",border:`2px solid ${z.border.subtle}`,position:"relative",backgroundColor:ne.ANALYSIS.BG_SUBTLE,"&:hover":{backgroundColor:ne.ANALYSIS.BG_HOVER},"&:focus-visible":{outline:`3px solid ${z.primary.main}`,outlineOffset:"-3px",backgroundColor:ne.ANALYSIS.BG_HOVER,boxShadow:`inset 0 0 15px ${z.interactive.focus}`}},children:e.jsx(oe,{value:d,color:y,size:a})}}({r:n,c:r,gridState:w,conflictSet:E,cycleCells:C,getDragProps:v,size:d}),[w,E,C,v,d]),O=r.useCallback((r,t)=>function({r:n,c:r,numbers:t,gridState:o,rows:l,cols:i,nodeConflictSet:a,numberSize:c}){const u=t[n]?.[r],d=a.has(s(n,r));let f=0,p=0;const g=[{r:n-1,c:r-1,required:te},{r:n-1,c:r,required:re},{r:n,c:r-1,required:re},{r:n,c:r,required:te}];for(const e of g)if(e.r>=0&&e.r<l&&e.c>=0&&e.c<i){const n=o.get(s(e.r,e.c));n&&0!==n.state&&(p++,n.state===e.required&&f++)}const h=null!=u&&f===u&&p>0;return{"data-pos":s(n,r),"data-type":"hint",children:e.jsx(se,{value:u??null,hasConflict:d,isSatisfied:h,numberSize:c}),sx:{borderRadius:"50%",backgroundColor:d?z.data.red:ne.ANALYSIS.HINT_BG,border:null==u?"none":`2px solid ${d?z.data.red:h?"transparent":ne.ANALYSIS.HINT_BORDER}`,zIndex:5,opacity:null==u?0:1,position:"relative",pointerEvents:"none",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)"}}}({r:r,c:t,numbers:u,gridState:w,rows:n,cols:o,nodeConflictSet:j,numberSize:N}),[u,w,n,o,j,N]);return e.jsxs(I,{sx:{position:"relative",userSelect:"none"},onContextMenu:e=>{e.preventDefault()},children:[e.jsx("style",{children:ne.ANIMATIONS.POP_IN}),e.jsxs(I,{sx:{position:"relative",padding:m?t.PADDING.MOBILE:t.PADDING.DESKTOP,border:`2px dashed ${ne.ANALYSIS.DASHED_BORDER}`,borderRadius:t.BORDER_RADIUS},children:[e.jsx(I,{sx:{position:"relative",zIndex:D.zIndex.base+1},children:e.jsx(c,{size:d,rows:n,cols:o,cellProps:M,space:.125,sx:{width:"fit-content"}})}),e.jsx(I,{sx:{position:"absolute",top:m?t.PADDING.MOBILE:t.PADDING.DESKTOP,left:m?t.PADDING.MOBILE:t.PADDING.DESKTOP,transform:`translate(calc(-${String(N/2)}rem - 0.0625rem), calc(-${String(N/2)}rem - 0.0625rem))`,zIndex:D.zIndex.base+2,pointerEvents:"none"},children:e.jsx(c,{size:N,rows:n+1,cols:o+1,cellProps:O,space:k,sx:{width:"fit-content"}})})]}),e.jsx(q,{onCopy:g,onClear:h,onClose:y})]})}function de({size:n,rows:t,cols:o}){const s=r.useCallback(()=>({sx:{backgroundColor:"var(--border)"}}),[]),l=r.useCallback(()=>({}),[]);return e.jsx(I,{sx:{"@keyframes pulse":{"0%, 100%":{opacity:.4},"50%":{opacity:.15}},animation:"pulse 1.4s ease-in-out infinite"},children:e.jsx(u,{size:n,rows:t+1,cols:o+1,cellRows:t,cellCols:o,overlayProps:l,cellProps:s,overlayLayerSx:{pointerEvents:"none"},overlayDecorative:!0})})}function fe({isAnalysisMode:n,generating:r,dimensionsMismatch:t,rows:o,cols:s,state:l,size:i,analysisMoves:a,onAnalysisMove:c,onAnalysisCopy:f,onAnalysisClear:p,onAnalysisClose:g,cellProps:h,overlayProps:y}){return n?e.jsx(W,{fallback:e.jsx(Y,{message:"Analysis mode encountered an error. Close and reopen to continue."}),children:e.jsx(ue,{rows:o,cols:s,numbers:l.numbers,size:i,initialMoves:a,onMove:c,onCopy:f,onClear:p,onClose:g})}):r||t?e.jsx(de,{size:i,rows:o,cols:s}):e.jsxs(W,{FallbackComponent:B,fallbackProps:{title:d.errors.boardTitle,resetLabel:d.errors.boardReset},children:[e.jsx("style",{children:ne.ANIMATIONS.POP_IN}),e.jsx(u,{size:i,rows:o+1,cols:s+1,cellRows:o,cellCols:s,space:.125,overlayProps:y,cellProps:h,overlayLayerSx:{pointerEvents:"none"},overlayDecorative:!0})]})}const pe=[{title:"Corner 0",description:'A "0" in a corner forces the line to point away from that corner.',rows:3,cols:3,numbers:[[0,null,null],[null,null,null],[null,null,null]],grid:[[re,0],[0,0]]},{title:"Corner 1",description:'A "1" in a corner forces the line to connect directly to that corner.',rows:3,cols:3,numbers:[[1,null,null],[null,null,null],[null,null,null]],grid:[[te,0],[0,0]]},{title:"Edge 0",description:'A "0" on the edge forces all surrounding lines to point away from it.',rows:3,cols:3,numbers:[[null,0,null],[null,null,null],[null,null,null]],grid:[[te,re],[0,0]]},{title:"Edge 1",description:'A "1" on the edge forces the two surrounding lines into the same orientation.',rows:3,cols:3,numbers:[[null,1,null],[null,null,null],[null,null,null]],grid:[[re,re],[0,0]]},{title:"Edge 2",description:'A "2" on the edge forces both surrounding lines to connect to it.',rows:3,cols:3,numbers:[[null,2,null],[null,null,null],[null,null,null]],grid:[[re,te],[0,0]]},{title:"Middle 4",description:'A "4" must catch lines from all four surrounding cells.',rows:3,cols:3,numbers:[[null,null,null],[null,4,null],[null,null,null]],grid:[[te,re],[re,te]]}],ge={display:"grid",gridTemplateColumns:{xs:"1fr",md:"1fr 1fr"},gap:4,width:"100%",py:2,pr:4},he={display:"flex",flexDirection:"row",alignItems:"center",gap:0,width:"100%"},ye={width:"180px",display:"flex",justifyContent:"center",flexShrink:0},me={display:"flex",flexDirection:"column",gap:1,flex:1,minWidth:0};function xe(e,n){return{position:"absolute",width:"115%",height:`${String(Math.max(2,n))}px`,backgroundColor:z.text.primary,borderRadius:"99px",top:"50%",left:"50%",transform:`translate(-50%, -50%) rotate(${e})`,boxShadow:ne.SHADOWS.LINE,pointerEvents:"none"}}function be(n,r){return(t,o)=>{const s=n[t]?.[o];return{sx:{border:`2px solid ${z.border.subtle}`,position:"relative",backgroundColor:ne.ANALYSIS.BG_SUBTLE},children:e.jsxs(I,{sx:{width:"100%",height:"100%",position:"relative"},children:[s===re&&e.jsx(I,{sx:xe("-45deg",r)}),s===te&&e.jsx(I,{sx:xe("45deg",r)})]})}}}function Se(n,r){return(t,o)=>{const s=n[t]?.[o];return{sx:{pointerEvents:"none"},children:e.jsx(I,{sx:{borderRadius:"50%",backgroundColor:z.surface.background,border:null==s?"none":`2px solid ${z.border.subtle}`,fontSize:`${String(.5*r)}rem`,fontWeight:"800",color:z.text.primary,boxShadow:null==s?"none":ne.SHADOWS.HINT,zIndex:5,opacity:null==s?0:1,display:"flex",alignItems:"center",justifyContent:"center",width:`${String(r)}rem`,height:`${String(r)}rem`},children:s??""})}}}const ve={display:"inline-flex",alignItems:"center",justifyContent:"center",width:"1.5em",height:"1.5em",borderRadius:"50%",backgroundColor:z.surface.background,border:`1px solid ${z.border.subtle}`,fontSize:"0.85em",fontWeight:"bold",mx:.4,verticalAlign:"middle",lineHeight:1,boxShadow:ne.SHADOWS.HINT,position:"relative",top:"-0.1em"};function we({text:n}){const r=n.split(/"(\d+)"/g);return e.jsx(N,{variant:"body2",sx:{color:z.text.secondary},children:r.map((n,r)=>r%2==1?e.jsx(I,{component:"span",sx:ve,children:n},`${String(r)}-${n}`):n)})}function Ae(){return e.jsx(I,{sx:ge,children:pe.map(n=>e.jsxs(I,{sx:he,children:[e.jsx(I,{sx:ye,children:e.jsx(u,{size:3,rows:n.rows,cols:n.cols,cellRows:n.rows-1,cellCols:n.cols-1,space:.125,overlayProps:Se(n.numbers,1.2000000000000002),cellProps:be(n.grid,3),overlayLayerSx:{pointerEvents:"none"},overlayDecorative:!0})}),e.jsxs(I,{sx:me,children:[e.jsx(N,{variant:"subtitle1",sx:{fontWeight:"bold",color:z.text.primary},children:n.title}),e.jsx(we,{text:n.description})]})]},n.title))})}const Ce={display:"flex",flexDirection:{xs:"column",sm:"row"},gap:2,justifyContent:"center",alignItems:"center",mt:2,width:"100%"},Ie={borderColor:z.border.subtle,color:z.text.secondary,width:{xs:"200px",sm:"180px"}},Ne=[[te,re,te],[re,re,te],[te,re,te]],ke=[[1,0,2,null],[null,null,null,1],[2,null,null,null],[null,2,0,1]],Ee=[[0,0],[0,1],[0,2],[1,2],[2,2],[2,1],[2,0],[1,0],[1,1]];function je(e,n,r){const t=Array.from({length:n+1},()=>new Array(r+1).fill(0));for(let o=0;o<n;o++){const n=e[o];if(n)for(let e=0;e<r;e++){const r=n[e];if(r===re){const n=t[o];if(n){const r=n[e+1];void 0!==r&&(n[e+1]=r+1)}const r=t[o+1];if(r){const n=r[e];void 0!==n&&(r[e]=n+1)}}else if(r===te){const n=t[o];if(n){const r=n[e];void 0!==r&&(n[e]=r+1)}const r=t[o+1];if(r){const n=r[e+1];void 0!==n&&(r[e+1]=n+1)}}}}return t}function Me(e,n,r,t){const o=new Set,l=je(e,r,t);for(let i=0;i<=r;i++)for(let a=0;a<=t;a++){const c=n[i]?.[a];if(null==c)continue;if((l[i]?.[a]??0)===c){let n=!1;const l=[{gr:i-1,gc:a-1},{gr:i-1,gc:a},{gr:i,gc:a-1},{gr:i,gc:a}];for(const{gr:o,gc:s}of l)if(o>=0&&o<r&&s>=0&&s<t&&0!==e[o]?.[s]){n=!0;break}n&&o.add(s(i,a))}}return o}function Oe(e,n){return{position:"absolute",width:"115%",height:`${String(Math.max(2,n))}px`,backgroundColor:z.text.primary,borderRadius:"99px",top:"50%",left:"50%","--slant-base-transform":`translate(-50%, -50%) rotate(${e})`,transform:"var(--slant-base-transform)",boxShadow:ne.SHADOWS.LINE,transition:L.transition,animation:ne.ANIMATIONS.POP_IN_STYLE,pointerEvents:"none"}}function Te({size:n,handleOpenAnalysis:t,handleClearBoard:o}){const l=r.useMemo(()=>function(){const e=[],n=Array.from({length:3},()=>new Array(3).fill(0));e.push(n);let r=n.map(e=>[...e]);for(const[t,o]of Ee){r=r.map(e=>[...e]);const n=Ne[t]?.[o];if(void 0!==n){const e=r[t];e&&(e[o]=n)}e.push(r)}return e.push(r.map(e=>[...e])),e}(),[]),[i,a]=r.useState(0);r.useEffect(()=>{const e=setInterval(()=>{a(e=>(e+1)%l.length)},1500);return()=>{clearInterval(e)}},[l.length]);const c=r.useMemo(()=>l[i]??l[0]??[],[l,i]),d=i>0&&i<=Ee.length?(()=>{const e=Ee[i-1];return e?s(e[0],e[1]):null})():null,p=r.useMemo(()=>Me(c,ke,3,3),[c]),g=n*U,h=i>=Ee.length&&c.every(e=>e.every(e=>0!==e)),y=r.useMemo(()=>function(n,r,t){return(o,l)=>{const i=n[o]?.[l],a=s(o,l)===t;return{sx:{border:`2px solid ${z.border.subtle}`,position:"relative",transition:L.transition,backgroundColor:ne.ANALYSIS.BG_SUBTLE,...a?{backgroundColor:z.interactive.hover}:{}},children:e.jsxs(I,{sx:{width:"100%",height:"100%",position:"relative"},children:[i===re&&e.jsx(I,{sx:Oe("-45deg",r)}),i===te&&e.jsx(I,{sx:Oe("45deg",r)})]})}}}(c,n,d),[c,n,d]),m=r.useMemo(()=>function(n,r,t){return(o,l)=>{const i=n[o]?.[l],a=s(o,l),c=r.has(a);return{sx:{pointerEvents:"none"},children:e.jsx(I,{sx:{borderRadius:"50%",backgroundColor:z.surface.background,border:null==i?"none":`2px solid ${c?"transparent":z.border.subtle}`,fontSize:`${String(.5*t)}rem`,fontWeight:"800",color:c?z.interactive.disabledText:z.text.primary,boxShadow:c?"none":ne.SHADOWS.HINT,zIndex:5,opacity:null==i?0:1,display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)",userSelect:"none",WebkitUserSelect:"none",transform:c?"scale(0.95)":"scale(1)",paddingTop:"0.05rem",lineHeight:1,width:`${String(t)}rem`,height:`${String(t)}rem`},children:i??""})}}}(ke,p,g),[p,g]);return e.jsxs(I,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",flex:1},children:[e.jsxs(I,{sx:{position:"relative",display:"inline-flex"},children:[e.jsx("style",{children:ne.ANIMATIONS.POP_IN}),e.jsx(u,{size:n,rows:4,cols:4,cellRows:3,cellCols:3,space:.125,overlayProps:m,cellProps:y,overlayLayerSx:{pointerEvents:"none"},overlayDecorative:!0}),e.jsx(f,{show:h,size:n,iconSizeRatio:1,primaryColor:z.primary.main,showLabel:!1})]}),e.jsxs(I,{sx:Ce,children:[e.jsx(k,{variant:"outlined",startIcon:e.jsx(j,{}),onClick:o,sx:Ie,children:"Clear Board"}),e.jsx(k,{variant:"outlined",startIcon:e.jsx(O,{}),onClick:t,sx:Ie,children:"Open Analysis"})]})]})}const Re=["Slant Rules","Example","Common Patterns"],Pe=[{Icon:T,title:"Fill with Slashes",text:String.raw`Place a forward (/) or backward (\) slash in every cell of the grid.`},{Icon:R,title:"Match the Numbers",text:"Each number at a corner tells how many slashes touch that point."},{Icon:P,title:"No Loops",text:"Slashes must never form a closed loop â€” every path stays open."}],ze={height:{xs:"660px",sm:"525px"},minHeight:{xs:"660px",sm:"525px"}},De=e=>[..._(p()),e<2?{overflowY:"hidden"}:{}];function Le(e){return{storageKey:"slant",grid:{defaultSize:ee,maxSize:Z,gridPadding:{x:e?48:80,y:120},widthLimit:V,cellSizeReference:4},board:{boardPadding:e=>({x:e?48:80,y:K}),...e?{boardSizeFactor:.92}:{},maxCellSize:F,rowOffset:1,colOffset:1}}}function $e({open:n,toggleOpen:r,handleOpenAnalysis:t,handleClearBoard:o}){const s=G("sm");return e.jsx(g,{open:n,toggleOpen:r,titles:Re,instructions:Pe,exampleContent:e.jsx(Te,{size:s?4:4.5,handleOpenAnalysis:t,handleClearBoard:o}),cardSx:ze,contentSxOverride:De,persistenceKey:"slant_info_step",extraSteps:[e.jsx(Ae,{},"patterns")]})}function Be(e,n){return`${X.STATE}-${String(e)}x${String(n)}`}function _e(e){return{...e,errorNodes:[...e.errorNodes],cycleCells:[...e.cycleCells],satisfiedNodes:[...e.satisfiedNodes]}}function He({rows:e,cols:n,isAnalysisMode:t,requestGeneration:o,cancelGeneration:s}){const l=r.useRef(`${String(e)},${String(n)}`);r.useEffect(()=>{const r=`${String(e)},${String(n)}`;r!==l.current&&(l.current=r,t||!function(e,n){const r=Be(e,n),t=localStorage.getItem(r);if(!t)return!1;try{const e=JSON.parse(t);return"object"==typeof e&&null!==e&&!1===e.solved}catch{return!1}}(e,n)?o(e,n):s())},[e,n,o,s,t])}function Ge(e,n,r,t){return{grid:Array.from({length:e},()=>new Array(n).fill(0)),numbers:r,solution:t,rows:e,cols:n,solved:!1,errorNodes:new Set,cycleCells:new Set,satisfiedNodes:new Set}}function We({getInitialState:e,dispatchRef:n,dimsRef:t,onStaleResult:o}){const[s,l]=r.useState(!1),i=r.useRef(null),a=r.useRef("probing"),c=r.useRef(0),u=r.useRef(0),d=r.useRef(null),f=r.useRef(0),p=r.useRef(o);p.current=o;const g=r.useRef(!1),h=r.useRef(null),y=r.useRef(!1),m=r.useCallback(()=>{if(h.current){const e=h.current;p.current?.(e,e.rows,e.cols)}g.current=!1,h.current=null,y.current=!1},[]),x=r.useCallback((r,t)=>{n.current?.({type:"hydrate",state:e(r,t)}),l(!1)},[n,e]),b=r.useCallback((e,n)=>{m(),l(!0),null!==d.current&&clearTimeout(d.current),cancelAnimationFrame(u.current),d.current=setTimeout(()=>{d.current=null;const r=++c.current;"healthy"===a.current&&i.current?(f.current++,i.current.postMessage({type:"GENERATE",payload:{rows:e,cols:n}})):u.current=requestAnimationFrame(()=>{c.current===r&&x(e,n)})},250)},[x,m]),S=r.useCallback((n,r)=>{g.current||(g.current=!0,h.current=null,y.current=!1,"healthy"===a.current&&i.current?(f.current++,i.current.postMessage({type:"GENERATE",payload:{rows:n,cols:r}})):requestAnimationFrame(()=>{g.current&&(h.current=e(n,r))}))},[e]),v=r.useCallback(()=>{null!==d.current&&(clearTimeout(d.current),d.current=null),cancelAnimationFrame(u.current),m(),l(!1)},[m]),w=r.useCallback(()=>{if(h.current){const e=h.current;return h.current=null,n.current?.({type:"hydrate",state:e}),m(),void l(!1)}if(g.current)return y.current=!0,void l(!0);b(t.current.rows,t.current.cols)},[b,t,n,m]);return r.useEffect(()=>{let e=!1;const r=new Worker(new URL("/assets/generationWorker-BGel4s87.js",import.meta.url),{type:"module"});i.current=r;const o=setTimeout(()=>{e||"probing"!==a.current||(a.current="broken",f.current=0,i.current=null,r.terminate())},2e3);return r.onmessage=s=>{if(!e){if("ERROR"===s.data.type)return clearTimeout(o),a.current="broken",f.current=0,i.current=null,void r.terminate();if("RESULT"===s.data.type){if("probing"===a.current)return clearTimeout(o),void(a.current="healthy");f.current--;const{rows:e,cols:r,numbers:i,solution:c}=s.data.payload,u=t.current;if(e!==u.rows||r!==u.cols)return p.current?.(Ge(e,r,i,c),e,r),void(f.current<=0&&l(!1));if(f.current>0)return;const d=Ge(e,r,i,c);if(g.current)return h.current=d,void(y.current&&(n.current?.({type:"hydrate",state:d}),g.current=!1,h.current=null,y.current=!1,l(!1)));n.current?.({type:"hydrate",state:d}),l(!1)}}},r.onerror=()=>{clearTimeout(o),a.current="broken",f.current=0,i.current=null,r.terminate()},r.postMessage({type:"GENERATE",payload:{rows:3,cols:3}}),()=>{e=!0,clearTimeout(o),null!==d.current&&clearTimeout(d.current),r.terminate()}},[n,t]),{generating:s,requestGeneration:b,handleNextAsync:w,prefetch:S,cancelGeneration:v}}function Ye(e,n,r){return{position:"absolute",width:"115%",height:`${String(Math.max(2,n))}px`,backgroundColor:r?z.data.red:z.text.primary,borderRadius:"99px",top:"50%",left:"50%","--slant-base-transform":`translate(-50%, -50%) rotate(${e})`,transform:"var(--slant-base-transform)",boxShadow:ne.SHADOWS.LINE,transition:L.transition,animation:ne.ANIMATIONS.POP_IN_STYLE,pointerEvents:"none"}}const qe={border:`2px solid ${z.border.subtle}`,position:"relative",backgroundColor:ne.ANALYSIS.BG_SUBTLE},Ue={width:"100%",height:"100%",position:"relative"},Ke={pointerEvents:"none"},Ve={cursor:"pointer",outline:"none","&:hover":{backgroundColor:z.interactive.hover},"&:focus-visible":{outline:`3px solid ${z.primary.main}`,outlineOffset:"-3px",backgroundColor:z.interactive.hover,boxShadow:`inset 0 0 15px ${z.interactive.focus}`}};function Fe(e){const{numberSize:n,hasError:r,isSatisfied:t,isVisible:o}=e;return{borderRadius:"50%",backgroundColor:r?z.data.red:z.surface.background,border:o?`2px solid ${r?z.data.red:t?"transparent":z.border.subtle}`:"none",fontSize:`${String(.5*n)}rem`,fontWeight:"800",color:r?ne.COLORS.WHITE:t?z.interactive.disabledText:z.text.primary,boxShadow:t&&!r?"none":ne.SHADOWS.HINT,zIndex:5,opacity:o?1:0,display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)",userSelect:"none",WebkitUserSelect:"none",paddingTop:"0.05rem",lineHeight:1,transform:r?"scale(1.15)":t?"scale(0.95)":"scale(1)",width:`${String(n)}rem`,height:`${String(n)}rem`}}const Je=(n,r,t)=>{const o=function(n,r){return(t,o)=>{const l=n.grid[t]?.[o],i=s(t,o),a=n.cycleCells.has(i),c=[{v:n.numbers[t]?.[o],p:s(t,o)},{v:n.numbers[t]?.[o+1],p:s(t,o+1)},{v:n.numbers[t+1]?.[o],p:s(t+1,o)},{v:n.numbers[t+1]?.[o+1],p:s(t+1,o+1)}].map(({v:e,p:r})=>{if(null==e)return"-";const t=n.errorNodes.has(r)?"Error":n.satisfiedNodes.has(r)?"Ok":"Pending";return`${String(e)} (${t})`});return{"aria-label":`Cell ${String(t+1)}, ${String(o+1)}. Clues: ${c.join(", ")}. ${0===l?"Empty":l===re?"Forward Slash":"Backward Slash"}${a?", Loop Error":""}`,sx:qe,children:e.jsxs(I,{sx:Ue,children:[l===re&&e.jsx(I,{sx:Ye("-45deg",r,a)}),l===te&&e.jsx(I,{sx:Ye("45deg",r,a)})]})}}}(r,t);return(e,r)=>{const t=o(e,r),l=s(e,r),i=n(l);return{...i,...t,sx:{...i.sx,...t.sx,...Ve}}}};function Xe({game:{state:n,rows:t,cols:o,size:l,mobile:i,isAnalysisMode:a,generating:c,handleNextAsync:u},analysis:{analysisMoves:d,handleAnalysisMove:f,handleAnalysisCopy:p,handleAnalysisClear:g,handleAnalysisClose:h,handleBoxClick:m,handleOpenAnalysis:x,boardSx:b},info:{infoOpen:S,toggleInfo:v,handleClearBoard:w},controls:A,getDragProps:C}){const N=l*U,k=y(Je,C,[n,l]),E=r.useMemo(()=>((n,r)=>(t,o)=>{const l=n.numbers[t]?.[o],i=s(t,o),a=n.errorNodes.has(i),c=n.satisfiedNodes.has(i);return{sx:Ke,children:e.jsx(I,{sx:Fe({numberSize:r,hasError:a,isSatisfied:c,isVisible:null!=l}),children:l??""})}})(n,N),[n,N]),j=r.useMemo(()=>(e=>({px:e?"1rem":"2rem",pt:e?"1rem":"2rem"}))(i),[i]);return{boardProps:{isAnalysisMode:a,generating:c,dimensionsMismatch:t!==n.rows||o!==n.cols,rows:t,cols:o,state:n,size:l,analysisMoves:d,onAnalysisMove:f,onAnalysisCopy:p,onAnalysisClear:g,onAnalysisClose:h,cellProps:k,overlayProps:E},controlsProps:{...A,onRefresh:u,disabled:c,onOpenInfo:v,hidden:a},layoutProps:{boardSx:b,contentSx:j,iconSizeRatio:J},infoProps:{open:S,toggleOpen:v,handleOpenAnalysis:x,handleClearBoard:w,handleBoxClick:m},trophyProps:{show:!a&&n.solved,onReset:u,size:l,iconSizeRatio:J}}}function Qe(e,n,r,t,o,s){const l=e[r];if(!l)return!1;l[t]=o;const i=ie(r,o===re?t+1:t,s),a=ie(r+1,o===re?t:t+1,s);return!n.connected(i,a)&&(n.union(i,a),!0)}function Ze(e,n,r){const t=Array.from({length:n},()=>new Array(r).fill(0)),o=new le((n+1)*(r+1)),s=function(e,n,r,t,o){let s=!0;for(;s;){s=!1;for(let l=0;l<=r;l++)for(let i=0;i<=t;i++){const a=n[l]?.[i];if(null==a)continue;const c=[{gr:l-1,gc:i-1,pt:te},{gr:l-1,gc:i,pt:re},{gr:l,gc:i-1,pt:re},{gr:l,gc:i,pt:te}].filter(({gr:e,gc:n})=>e>=0&&e<r&&n>=0&&n<t);let u=0;const d=[];for(const n of c){const r=e[n.gr]?.[n.gc];0===r?d.push(n):r===n.pt&&u++}if(u>a)return"contradiction";if(u+d.length<a)return"contradiction";if(u===a&&d.length>0){for(const{gr:n,gc:r,pt:l}of d)if(0===e[n]?.[r]){if(!Qe(e,o,n,r,l===re?te:re,t))return"contradiction";s=!0}}else if(u+d.length===a&&d.length>0)for(const{gr:n,gc:r,pt:l}of d)if(0===e[n]?.[r]){if(!Qe(e,o,n,r,l,t))return"contradiction";s=!0}}if(!s){for(let n=0;n<r;n++)for(let r=0;r<t;r++){const l=e[n];if(0!==l?.[r])continue;const i=ie(n,r+1,t),a=ie(n+1,r,t),c=o.connected(i,a),u=ie(n,r,t),d=ie(n+1,r+1,t),f=o.connected(u,d);if(c&&f)return"contradiction";c?(l[r]=te,s=!0,o.union(u,d)):f&&(l[r]=re,s=!0,o.union(i,a))}if(!s)for(let l=0;l<r;l++)for(let i=0;i<t;i++){const a=e[l];if(0!==a?.[i])continue;let c=!1,u=!1;const d=[{nr:l,nc:i,touchedBy:te},{nr:l,nc:i+1,touchedBy:re},{nr:l+1,nc:i,touchedBy:re},{nr:l+1,nc:i+1,touchedBy:te}];for(const{nr:o,nc:s,touchedBy:l}of d){const i=n[o]?.[s];if(null==i)continue;const a=[{gr:o-1,gc:s-1,pt:te},{gr:o-1,gc:s,pt:re},{gr:o,gc:s-1,pt:re},{gr:o,gc:s,pt:te}].filter(({gr:e,gc:n})=>e>=0&&e<r&&n>=0&&n<t);let d=0,f=0;for(const n of a){const r=e[n.gr]?.[n.gc];0===r?f++:r===n.pt&&d++}l===re?(d+1>i&&(c=!0),d+(f-1)<i&&(u=!0)):(d+1>i&&(u=!0),d+(f-1)<i&&(c=!0))}if(c&&u)return"contradiction";if(c){if(!Qe(e,o,l,i,te,t))return"contradiction";s=!0}else if(u){if(!Qe(e,o,l,i,re,t))return"contradiction";s=!0}}}}return e.every(e=>e.every(e=>0!==e))?"solved":"stuck"}(t,e,n,r,o);return"contradiction"!==s&&("solved"===s&&function(e,n,r,t){const o=je(e,r,t);for(let s=0;s<=r;s++)for(let e=0;e<=t;e++){const r=n[s]?.[e];if(null!=r&&o[s]?.[e]!==r)return!1}return!0}(t,e,n,r))}function en(e,n){let r=[],t=!1;for(let s=0;s<50&&!t;s++){r=Array.from({length:e},()=>new Array(n).fill(0));const o=new le((e+1)*(n+1)),s=[];for(let r=0;r<e;r++)for(let e=0;e<n;e++)s.push({r:r,c:e});for(let e=s.length-1;e>0;e--){const n=Math.floor(Math.random()*(e+1)),r=s[e],t=s[n];r&&t&&(s[e]=t,s[n]=r)}let l=!1;for(const{r:e,c:t}of s){const s=ie(e,t+1,n),i=ie(e+1,t,n),a=o.connected(s,i),c=ie(e,t,n),u=ie(e+1,t+1,n),d=o.connected(c,u);if(a&&d){l=!0;break}const f=r[e];f&&(a?(f[t]=te,o.union(c,u)):d||Math.random()<.5?(f[t]=re,o.union(s,i)):(f[t]=te,o.union(c,u)))}l||(t=!0)}t||(r=Array.from({length:e},(e,r)=>new Array(n).fill(r%2==0?re:te)));const o=function(e,n,r,t){const o=e.map(e=>[...e]),s=[];for(let a=0;a<=n;a++)for(let e=0;e<=r;e++)s.push({r:a,c:e});for(let a=s.length-1;a>0;a--){const e=Math.floor(Math.random()*(a+1)),n=s[a],r=s[e];n&&r&&(s[a]=r,s[e]=n)}const l=Math.floor((n+1)*(r+1)*t);let i=0;for(let a=0;a<=n;a++)for(let e=0;e<=r;e++)null!==o[a]?.[e]&&i++;for(const{r:a,c:c}of s){if(i<=l)break;const e=o[a];if(!e)continue;const t=e[c];null!=t&&(e[c]=null,Ze(o,n,r)?i--:e[c]=t)}return o}(je(r,e,n).map(e=>e.map(e=>e)),e,n,Q);return{numbers:o,solution:r}}const nn=m({getInitialState:rn,customHandler:(e,n)=>{if("reset"===n.type)return{...e,grid:Array.from({length:e.rows},()=>new Array(e.cols).fill(0)),solved:!1,errorNodes:new Set,cycleCells:new Set,satisfiedNodes:new Set};if("toggle"!==n.type)return null;if(e.solved)return e;const{row:r,col:t}=n;if(void 0===r||void 0===t)return e;const o=e.grid.map(e=>[...e]),l=o[r];if(!l)return e;const i=l[t];if(void 0===i)return e;n.reverse?l[t]=0===i?re:i===re?te:0:l[t]=0===i?te:i===te?re:0;let a=!1;if(o.every(e=>e.every(e=>0!==e))){const n=je(o,e.rows,e.cols);e.numbers.every((e,r)=>e.every((e,t)=>null==e||e===n[r]?.[t]))&&!function(e,n,r){const t=new le((n+1)*(r+1));for(let o=0;o<n;o++){const n=e[o];if(n)for(let e=0;e<r;e++){const s=n[e];if(void 0===s||0===s)continue;const l=ie(o,s===re?e+1:e,r),i=ie(o+1,s===re?e:e+1,r);if(!t.union(l,i))return!0}}return!1}(o,e.rows,e.cols)&&(a=!0)}const c=function(e,n,r,t){const o=new Set,l=je(e,r,t);for(let i=0;i<=r;i++)for(let a=0;a<=t;a++){const c=n[i]?.[a];if(null==c)continue;const u=l[i]?.[a]??0;u>c?o.add(s(i,a)):u+[{gr:i-1,gc:a-1},{gr:i-1,gc:a},{gr:i,gc:a-1},{gr:i,gc:a}].filter(({gr:n,gc:o})=>n>=0&&n<r&&o>=0&&o<t&&0===e[n]?.[o]).length<c&&o.add(s(i,a))}return o}(o,e.numbers,e.rows,e.cols),u=ae(o,e.rows,e.cols),d=Me(o,e.numbers,e.rows,e.cols);return{...e,grid:o,solved:a,errorNodes:c,cycleCells:u,satisfiedNodes:d}}});function rn(e,n){const{numbers:r,solution:t}=en(e,n);return{grid:Array.from({length:e},()=>new Array(n).fill(0)),numbers:r,solution:t,rows:x(e),cols:x(n),solved:!1,errorNodes:new Set,cycleCells:new Set,satisfiedNodes:new Set}}function tn(){const e=G("sm"),[t,o]=n.useState(!1),{isOpen:c,toggle:u}=b(),d=r.useRef(null),f=r.useRef({rows:0,cols:0}),p=r.useCallback((e,n,r)=>{t||function(e,n,r){const t=Be(n,r);try{localStorage.setItem(t,JSON.stringify(_e(e)))}catch{}}(e,n,r)},[t]),{generating:g,requestGeneration:y,handleNextAsync:m,prefetch:x,cancelGeneration:w}=We({getInitialState:rn,dispatchRef:d,dimsRef:f,onStaleResult:p}),{rows:A,cols:C,state:I,dispatch:N,size:k,controlsProps:E}=S({...Le(e),logic:{reducer:nn,getInitialState:(e,n)=>rn(e,n),onNext:m,isSolved:e=>e.solved,manualResize:!0,persistence:{enabled:!t,serialize:_e,deserialize:e=>{if(!function(e){if("object"!=typeof e||null===e)return!1;const n=e;return Array.isArray(n.grid)&&Array.isArray(n.numbers)&&Array.isArray(n.solution)&&"number"==typeof n.rows&&"number"==typeof n.cols&&"boolean"==typeof n.solved&&Array.isArray(n.errorNodes)&&Array.isArray(n.cycleCells)&&Array.isArray(n.satisfiedNodes)}(e))throw new Error(`Corrupt Slant state in localStorage: expected a valid SavedSlantState object but received ${JSON.stringify(e).slice(0,100)}`);return function(e){return{...e,errorNodes:new Set(e.errorNodes),cycleCells:new Set(e.cycleCells),satisfiedNodes:new Set(e.satisfiedNodes)}}(e)}}}});d.current=N,f.current={rows:A,cols:C};const j=r.useCallback(()=>{N({type:"reset"}),u()},[N,u]),{analysisMoves:M,boardSx:O,handleAnalysisMove:T,handleAnalysisCopy:R,handleAnalysisClear:P,handleAnalysisClose:z,handleBoxClick:D,handleOpenAnalysis:L}=function({isAnalysisMode:e,setIsAnalysisMode:n,state:t,rows:o,cols:l,storageKey:i,toggleInfo:a}){const[c,u]=r.useState(new Map);h({storageKey:i,rows:o,cols:l,state:c,onRestore:e=>{u(e)},serialize:e=>[...e.entries()],deserialize:e=>new Map(e)});const d=r.useRef("");r.useEffect(()=>{const e=JSON.stringify(t.numbers);d.current&&d.current!==e&&u(new Map),d.current=e},[t.numbers,t.rows,t.cols]);const f=r.useCallback((e,n)=>{u(r=>{const t=new Map(r);return void 0===n?t.delete(e):t.set(e,n),t})},[]),p=r.useCallback(()=>{const e=new Map;t.grid.forEach((n,r)=>{n.forEach((n,t)=>{0!==n&&e.set(s(r,t),n)})}),u(e)},[t.grid]),g=r.useCallback(()=>{u(new Map)},[]),y=r.useCallback(()=>{n(!1)},[n]),m=r.useCallback(e=>{e.stopPropagation()},[]);return{analysisMoves:c,boardSx:r.useMemo(()=>e?{padding:{xs:0,sm:0},border:"none"}:void 0,[e]),handleAnalysisMove:f,handleAnalysisCopy:p,handleAnalysisClear:g,handleAnalysisClose:y,handleBoxClick:m,handleOpenAnalysis:r.useCallback(()=>{a(),n(!0)},[a,n])}}({isAnalysisMode:t,setIsAnalysisMode:o,state:I,rows:A,cols:C,storageKey:X.ANALYSIS_MOVES,toggleInfo:u});He({rows:A,cols:C,isAnalysisMode:t,requestGeneration:y,cancelGeneration:w}),r.useEffect(()=>{I.solved&&!t&&x(A,C)},[I.solved,t,A,C,x]);const{handleKeyDown:$}=a({rows:A,cols:C}),{getDragProps:B}=l({onToggle:(e,n,r)=>{N({type:"toggle",row:v(e),col:v(n),reverse:r})},checkEnabled:()=>!I.solved,touchTimeout:i.timing.touchHoldDelay}),_=r.useCallback(e=>{const n=B(e);return{...n,onKeyDown:e=>{n.onKeyDown(e),$(e)}}},[B,$]);return Xe({game:{state:I,rows:A,cols:C,size:k,mobile:e,isAnalysisMode:t,generating:g,handleNextAsync:m},analysis:{analysisMoves:M,handleAnalysisMove:T,handleAnalysisCopy:R,handleAnalysisClear:P,handleAnalysisClose:z,handleBoxClick:D,handleOpenAnalysis:L,boardSx:O},info:{infoOpen:c,toggleInfo:u,handleClearBoard:j},controls:E,getDragProps:_})}function on(){const{boardProps:n,controlsProps:r,layoutProps:t,infoProps:o,trophyProps:s}=tn();return e.jsxs(w,{title:H.slant,infoUrl:"https://en.wikipedia.org/wiki/Gokigen_Naname",controls:e.jsx(A,{...r}),trophyProps:s,layout:{paddingBottom:{xs:"120px",md:"150px"},contentSx:t.contentSx,boardSx:t.boardSx},onClick:n.isAnalysisMode?n.onAnalysisClose:void 0,children:[e.jsx(I,{onClick:o.handleBoxClick,children:e.jsx(fe,{...n})}),e.jsx($e,{...o})]})}export{on as Slant};
