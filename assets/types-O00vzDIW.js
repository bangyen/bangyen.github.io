import{j as h,r as o}from"./vendor_react-D9AZKRQJ.js";import{C as Y,d as _,u as q,c as se}from"./layout-Pt8faN6F.js";import{B as I,d as Q,e as ie}from"./vendor_mui_core-CcNgE9EE.js";import{L as ae,f as ce,e as V,E as le,C as W,S as ue}from"./index-Dh9eOJXR.js";import{v as de,w as fe,E as me}from"./vendor_mui_icons-i_Xb35He.js";import{G as he}from"./GlassCard-CnxQqiCZ.js";import{P as pe,t as Z}from"./PageLayout-CHV4ftwa.js";function we(e){const{frontProps:t,backProps:n,size:r,rows:f,cols:m,frontLayerSx:a,backLayerSx:l}=e,u=a&&"pointerEvents"in a&&a.pointerEvents==="none",s=l&&"pointerEvents"in l&&l.pointerEvents==="none";return h.jsxs(I,{sx:{display:"grid",placeItems:"center"},children:[h.jsx(I,{sx:{gridArea:"1/1",...l},children:h.jsx(Y,{space:0,size:r,rows:f-1,cols:m-1,cellProps:n,...s?{role:"presentation","aria-hidden":!0}:{}})}),h.jsx(I,{sx:{gridArea:"1/1",zIndex:ae.zIndex.base+1,...a},children:h.jsx(Y,{space:0,size:r,rows:f,cols:m,cellProps:t,...u?{role:"presentation","aria-hidden":!0}:{}})})]})}function xe({rows:e,cols:t,dynamicSize:n,minSize:r,maxSize:f,handlePlus:m,handleMinus:a,onRefresh:l,disabled:u=!1,children:s}){const c=e<=r&&t<=r,w=e>=f&&t>=f||e===n.rows&&t===n.cols;return h.jsxs(ce,{onRefresh:l,children:[h.jsx(V,{title:"Decrease Size",Icon:de,onClick:a,disabled:u||c}),h.jsx(V,{title:"Increase Size",Icon:fe,onClick:m,disabled:u||w}),s]})}const ge=({children:e})=>h.jsx(le,{FallbackComponent:({error:t,resetErrorBoundary:n})=>h.jsx(I,{sx:{display:"flex",justifyContent:"center",alignItems:"center",p:4,minHeight:"300px"},children:h.jsxs(he,{sx:{p:4,maxWidth:"500px",textAlign:"center"},children:[h.jsx(Q,{variant:"h5",sx:{mb:2,color:W.text.primary,fontWeight:"bold"},children:"Game Error"}),h.jsx(Q,{sx:{mb:3,color:W.text.secondary,fontFamily:"monospace",fontSize:"0.9rem"},children:(t==null?void 0:t.message)??"An unexpected error occurred."}),h.jsx(ie,{variant:"contained",onClick:n,sx:{borderRadius:ue.borderRadius.md,textTransform:"none"},children:"Reset Game"})]})}),children:e});function be({show:e,onReset:t,size:n,iconSizeRatio:r,primaryColor:f,secondaryColor:m,useSecondary:a=!1}){const[l,u]=o.useState(!1);return o.useEffect(()=>{if(e){const s=setTimeout(()=>{u(!0)},500);return()=>{clearTimeout(s)}}u(!1)},[e]),h.jsx(I,{onClick:s=>{l&&t&&(s.stopPropagation(),t())},sx:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",opacity:e?1:0,transform:e?"scale(1)":"scale(0.5)",visibility:e?"visible":"hidden",transition:"all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1)",cursor:l?"pointer":"default",zIndex:10,backgroundColor:"transparent",pointerEvents:e?"auto":"none"},children:n>0&&h.jsx(me,{sx:{fontSize:`${(n*r).toString()}rem`,color:a?m:f,filter:"drop-shadow(0 4px 12px rgba(0,0,0,0.1))"}})})}function Se({children:e,controls:t,infoUrl:n,_title:r,background:f=W.surface.background,paddingBottom:m={xs:"80px",md:"120px"},contentSx:a={},showTrophy:l=!1,onReset:u,boardSize:s=0,iconSizeRatio:c=1,primaryColor:w,secondaryColor:g,useSecondaryTrophy:d=!1,boardSx:i,onClick:S}){return h.jsxs(pe,{infoUrl:n,background:f,containerSx:{height:"100vh",transition:"background 0.5s ease-in-out",cursor:S?"pointer":"inherit"},sx:{justifyContent:"center",alignItems:"center"},onClick:S,children:[h.jsx(I,{sx:[{flex:1,position:"relative",width:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",overflow:"hidden",pb:m},...Z(a)],children:h.jsxs(I,{sx:[{position:"relative",width:"fit-content"},...Z(i)],children:[e,h.jsx(be,{show:l,onReset:u,size:s,iconSizeRatio:c,primaryColor:w,secondaryColor:g,useSecondary:d})]})}),t]})}const ye={gridSizes:{mobile:2.5,desktop:4},timing:{winAnimationDelay:2e3,interactionDelay:500,touchHoldDelay:500},layout:{headerHeight:{mobile:64,desktop:80}}};function ee({storageKey:e,rows:t,cols:n,state:r,onRestore:f,serialize:m,deserialize:a,enabled:l=!0,saveDebounceMs:u=300}){const s=`${e}-${String(t)}x${String(n)}`,c=o.useRef(f),w=o.useRef(a),g=o.useRef(m);o.useEffect(()=>{c.current=f,w.current=a,g.current=m}),o.useEffect(()=>{if(!l)return;const d=localStorage.getItem(s);if(d)try{const i=JSON.parse(d),S=w.current??(D=>D);c.current(S(i))}catch{localStorage.removeItem(s)}},[s,l]),o.useEffect(()=>{if(!l)return;const d=setTimeout(()=>{const i=(g.current??(S=>S))(r);localStorage.setItem(s,JSON.stringify(i))},u);return()=>{clearTimeout(d)}},[s,r,l,u])}function ve({storageKeys:e,pageTitle:t,gridConfig:n,boardConfig:r,reducer:f,getInitialState:m,winAnimationDelay:a,isSolved:l,persistence:u}){const{rows:s,cols:c,dynamicSize:w,handlePlus:g,handleMinus:d,mobile:i,minSize:S,maxSize:D}=(function({storageKey:b,defaultSize:R,minSize:x=2,maxSize:y=10,headerOffset:E,paddingOffset:O=0,widthLimit:$=1300,cellSizeReference:C,mobileRowOffset:B=0}){const{height:P,width:A}=_(),j=q("sm"),[v,k]=o.useState(()=>{const z=localStorage.getItem(b);return z==="null"?null:z?parseInt(z,10):R}),p=o.useMemo(()=>{const z=j?E.mobile:E.desktop,F=typeof C=="number"?C:j?C.mobile:C.desktop,U=se(F,P-z-O,Math.min(A,$));let X=U.rows-1;const re=U.cols-1;return j&&(X+=B),{rows:Math.max(x,X),cols:Math.max(x,re)}},[C,P,A,j,E,O,$,x,B]),{rows:L,cols:H}=o.useMemo(()=>v===null?p:{rows:Math.min(v,p.rows),cols:Math.min(v,p.cols)},[v,p]);return o.useEffect(()=>{localStorage.setItem(b,String(v))},[v,b]),{rows:L,cols:H,dynamicSize:p,handlePlus:()=>{const z=Math.min(L,H);v!==null&&(z<Math.min(p.rows,p.cols)?k(z+1):p.rows===p.cols||L===p.rows&&H===p.cols||k(null))},handleMinus:()=>{const z=Math.min(L,H);if(v===null){const F=Math.min(p.rows,p.cols);p.rows===p.cols?k(Math.max(x,F-1)):k(F)}else z>x&&k(z-1)},desiredSize:v,setDesiredSize:k,mobile:j,width:A,height:P,minSize:x,maxSize:y}})({storageKey:e.size,...n}),T=o.useMemo(()=>m(s,c),[s,c,m]),[K,M]=o.useReducer(f,T),J=o.useMemo(()=>l(K),[K,l]),G=o.useCallback(()=>{M({type:"new"})},[M]);var N;ee({storageKey:e.state,rows:s,cols:c,state:K,onRestore:b=>{M({type:"restore",state:b}),M({type:"hydrate",state:b})},...u}),(function(b,R,x=2e3){const y=o.useRef(R);y.current=R,o.useEffect(()=>{if(b){const E=setTimeout(()=>{y.current()},x);return()=>{clearTimeout(E)}}},[b,x])})(J,G,a),N=t,o.useEffect(()=>{document.title=N},[N]),o.useEffect(()=>{M({type:"resize",rows:s,cols:c,newRows:s,newCols:c})},[s,c,M]);const ne=o.useMemo(()=>typeof r.paddingOffset=="function"?r.paddingOffset(i):r.paddingOffset,[r,i]),oe=(function({rows:b,cols:R,headerOffset:x,paddingOffset:y,boardMaxWidth:E,boardSizeFactor:O,maxCellSize:$,remBase:C}){const{width:B,height:P}=_(),A=q("sm");return o.useMemo(()=>{const j=A?x.mobile:x.desktop,v=typeof y=="number"?0:y.x,k=typeof y=="number"?y:y.y,p=(Math.min(B,E)-v)*O,L=(P-j-k)*O;return Math.min(p/R,L/b,$)/C},[B,P,A,b,R,x,y,E,O,$,C])})({rows:s+(r.rowOffset??0),cols:c+(r.colOffset??0),headerOffset:n.headerOffset,...r,paddingOffset:ne});return{rows:s,cols:c,state:K,dispatch:M,size:oe,mobile:i,solved:J,handleNext:G,controlsProps:{rows:s,cols:c,dynamicSize:w,minSize:S,maxSize:D,handlePlus:g,handleMinus:d,onRefresh:G}}}function te({onAction:e,checkEnabled:t=()=>!0,touchTimeout:n=500,posAttribute:r="data-pos",preventDefault:f=!0,transition:m="all 0.2s"}){const[a,l]=o.useState(null),u=o.useRef(new Set),s=o.useRef(0),c=o.useCallback(()=>{l(null),u.current.clear()},[]),w=o.useCallback(d=>{if(a===null)return;const i=d.touches[0];if(!i)return;const S=document.elementFromPoint(i.clientX,i.clientY);if(!S)return;const D=S.closest(`[${r}]`);if(D){const T=D.getAttribute(r);T&&!u.current.has(T)&&(e(T,a===2,!1),u.current.add(T))}},[a,e,r]);o.useEffect(()=>(window.addEventListener("mouseup",c),window.addEventListener("touchend",c),window.addEventListener("touchcancel",c),window.addEventListener("touchmove",w,{passive:!1}),()=>{window.removeEventListener("mouseup",c),window.removeEventListener("touchend",c),window.removeEventListener("touchcancel",c),window.removeEventListener("touchmove",w)}),[c,w]);const g=o.useCallback(d=>({onMouseDown:i=>{t()&&(i.button!==0&&i.button!==2||Date.now()-s.current<n||(f&&i.preventDefault(),l(i.button),e(d,i.button===2,!0),u.current.add(d)))},onMouseEnter:()=>{a!==null&&!u.current.has(d)&&t()&&(e(d,a===2,!1),u.current.add(d))},onTouchStart:i=>{t()&&(i.cancelable&&f&&i.preventDefault(),s.current=Date.now(),l(0),e(d,!1,!0),u.current.add(d))},onKeyDown:i=>{t()&&(i.key!=="Enter"&&i.key!==" "||(i.preventDefault(),e(d,!1,!0)))},onContextMenu:i=>{f&&i.preventDefault()},[r]:d,role:"button",tabIndex:0,sx:{touchAction:"none",transition:m}}),[e,t,a,n,r,f,m]);return{isDragging:a!==null,draggingButton:a,getDragProps:g,lastTouchTime:s}}function ze({onToggle:e,checkEnabled:t,touchTimeout:n,transition:r,posAttribute:f}){const m=o.useRef(void 0),a=o.useRef(e);a.current=e;const l=o.useCallback((s,c,w)=>{if(!t())return;const[g,d]=s.split(",").map(Number);g!==void 0&&d!==void 0&&(w?m.current=a.current(g,d,c,void 0,!0):a.current(g,d,c,m.current,!1))},[t]),{getDragProps:u}=te({onAction:l,checkEnabled:t,touchTimeout:n,transition:r,posAttribute:f});return{getDragProps:u}}function Ee(e,t){return`${e.toString()},${t.toString()}`}function Ce(e){return(t,n)=>{if(e.customHandler){const r=e.customHandler(t,n);if(r!==t)return r}switch(n.type){case"resize":if("newRows"in n||"rows"in n||"cols"in n){const r=n.newRows??n.rows??t.rows,f=n.newCols??n.cols??t.cols;return e.getInitialState(r,f)}return t;case"new":case"next":case"reset":return e.getInitialState(t.rows,t.cols);case"restore":case"hydrate":return"state"in n?n.state:t;default:return t}}}function ke(e,t,n){return o.useMemo(()=>e(t,...n),[e,t,n])}const Me=e=>{if(e<1||e>100)throw new Error("Invalid grid size: must be between 1 and 100");return e},Re=e=>{if(e<0)throw new Error("Invalid cell index: cannot be negative");return e};export{we as B,ge as G,Me as a,ve as b,Ce as c,ze as d,ke as e,Se as f,Ee as g,xe as h,ye as i,Re as j,ee as k,te as u};
