import{r as e,j as t}from"./vendor_react-WaSaIrII.js";import{a,R as o}from"./ResearchDemo-DpBWyhDB.js";import{d as r,a as i,U as l}from"./index-BUeESl4T.js";import{o as n,T as s,p as c}from"./vendor_mui_icons-GFlgYi_M.js";import"./GlassCard-Cv4Q1jWy.js";import"./vendor_mui_core-3PJY_Tg4.js";import"./GlobalHeader-CpcF8oju.js";import"./vendor_recharts-Cvb0gzTV.js";const u=(e,t,o,r,i,l)=>{if(!e||0===e.length)return d();const n=e.filter(e=>e.num_firms===t&&e.model_type===o&&e.demand_elasticity===r&&e.base_price===i&&e.collusion_enabled===l);if(0===n.length){return e.filter(e=>e.num_firms===t&&e.model_type===o).sort((e,t)=>e.round-t.round).slice(0,a.oligopoly.maxRounds)}return n.sort((e,t)=>e.round-t.round).slice(0,15)},d=()=>{const e=[];for(let t=1;t<=a.oligopoly.maxRounds;t++){const o=a.oligopoly.simulation;e.push({round:t,price:o.fallbackPrice+Math.sin(t*o.priceFrequency)*o.priceAmplitude,hhi:o.fallbackHHI+Math.sin(t*o.hhiFrequency)*o.hhiAmplitude,collusion:t>o.collusionStart&&t<o.collusionEnd})}return e},m=()=>{const[m,p]=e.useState(a.oligopoly.defaultFirms),[y,f]=e.useState(a.oligopoly.defaultElasticity),[g,h]=e.useState(a.oligopoly.defaultBasePrice),[b,x]=e.useState([]),[v,w]=e.useState([]),[A,F]=e.useState(!0),_=a.modelTypes.cournot,S=!1;e.useEffect(()=>{document.title=r.oligopoly;(async()=>{F(!0);try{const e=await(async()=>{try{const e=await fetch("/oligopoly_data.json.gz");if(!e.ok)throw new Error(`HTTP error! status: ${e.status} - Failed to load Oligopoly data`);if("undefined"==typeof DecompressionStream)throw new Error("DecompressionStream not supported in this browser");const t=await e.arrayBuffer(),a=new Uint8Array(t);let o;if(31===a[0]&&139===a[1]){const e=await new Response(new ReadableStream({start(e){const a=new DecompressionStream("gzip"),o=a.writable.getWriter(),r=a.readable.getReader();return o.write(t).then(()=>o.close()),function t(){return r.read().then(({done:a,value:o})=>{if(!a)return e.enqueue(o),t();e.close()})}()}})).text();o=JSON.parse(e)}else{const e=(new TextDecoder).decode(t);o=JSON.parse(e)}if(!Array.isArray(o))throw new Error("Invalid data format: expected array");return o}catch(e){return[]}})();w(e);const t=u(e,m,_,y,g,S);x(t)}catch(e){x(d())}finally{F(!1)}})()},[m,y,g,S,_]),e.useEffect(()=>{if(v.length>0){const e=u(v,m,_,y,g,S);x(e)}},[m,y,g,v,_,S]);const j=[{label:"Number of Firms",icon:n,color:i.primary.main,value:m,onChange:p,options:[{value:2,label:"2"},{value:3,label:"3"},{value:4,label:"4"},{value:5,label:"5"}]},{label:"Demand Elasticity",icon:s,color:i.data.green,value:y,onChange:f,options:[{value:1.5,label:"1.5"},{value:2,label:"2.0"},{value:2.5,label:"2.5"}]},{label:"Base Price",icon:c,color:i.data.amber,value:g,onChange:h,options:[{value:30,label:"$30"},{value:40,label:"$40"},{value:50,label:"$50"}]}],R={type:"line",xAxisKey:"round",yAxisFormatter:e=>`$${e.toFixed(2)}`,yAxisDomain:["dataMin - 5","dataMax + 5"],dualYAxis:!0,rightYAxisFormatter:e=>e.toFixed(2),rightYAxisDomain:["dataMin - 0.05","dataMax + 0.05"],tooltipLabelFormatter:e=>`Round ${e}`,tooltipFormatter:(e,t)=>["Market Price"===t?`$${e.toFixed(2)}`:e.toFixed(2),t],lines:[{dataKey:"price",name:"Market Price",color:i.primary.main,yAxisId:"left"},{dataKey:"hhi",name:"HHI Concentration",color:i.data.amber,yAxisId:"right"}]};return t.jsx(o,{title:"Oligopoly",subtitle:"Agent-Based Economic Competition Analysis",githubUrl:l.oligopolyRepo,chartData:b,chartConfig:R,chartTitle:"Market Dynamics",controls:j,loading:A,loadingMessage:"Loading Cournot simulation data...",onReset:()=>{p(a.oligopoly.defaultFirms),f(a.oligopoly.defaultElasticity),h(a.oligopoly.defaultBasePrice)},resetLabel:"Reset"})};export{m as default};
