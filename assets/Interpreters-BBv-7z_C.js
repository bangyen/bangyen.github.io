import{r as x,j as n,a as Z,u as $e}from"./vendor_react-D9AZKRQJ.js";import{G as ee,C as h,S as W,T as S,e as A,L as Be,d as te,A as B,E as De,R as C}from"./index-Dh9eOJXR.js";import{G as re}from"./GlassCard-CnxQqiCZ.js";import{i as Oe,d as D,j as Ae,B as M,u as Te,G as v,e as V,k as He,S as Le,l as N}from"./vendor_mui_core-CcNgE9EE.js";import{P as Ge}from"./PageLayout-CHV4ftwa.js";import{u as le,G as Y,a as de,g as Ve,b as q,C as Ne,c as Ye}from"./layout-Pt8faN6F.js";import{j as ue,D as pe,k as xe,l as he,m as qe,n as Ke,F as fe,o as ge,e as Ue,N as Xe}from"./vendor_mui_icons-i_Xb35He.js";function me(e){const s=x.useRef([]),t=x.useRef(0),o=x.useRef(!1),a=x.useRef(e);return x.useEffect(()=>{a.current=e},[e]),x.useCallback(({type:r,payload:i})=>{const c=s.current;switch(r){case"next":{if(o.current){const u=c[t.current];return u?{...u}:i}o.current=!0;const p=t.current;if(p+1===c.length){const u=c[p];if(!u)return{...c[0]};const g=a.current(u);g===u||(c.push(g),t.current++)}else t.current++;const l=c[t.current];if(!l)return i;const d={...l};return setTimeout(()=>{o.current=!1},ee.processing.resetDelay),d}case"prev":{if(o.current){const d=c[t.current];return d?{...d}:i}o.current=!0,t.current&&t.current--;const p=c[t.current];if(!p)return i;const l={...p};return setTimeout(()=>{o.current=!1},ee.processing.resetDelay),l}case"clear":s.current=[{...i}],t.current=0}return i},[])}let z=null,T=null,K=200;function be(e){const s=x.useRef(null),t=x.useRef(e),o=x.useCallback(({repeat:r,speed:i})=>{z!==null&&clearInterval(z),T=r??T,K=i??K,s.current=T,t.current=K,T&&(z=setInterval(T,K))},[]),a=x.useCallback(()=>{z!==null&&(clearInterval(z),z=null)},[]);return x.useEffect(()=>()=>{z!==null&&(clearInterval(z),z=null)},[]),{create:o,clear:a}}const I=x.createContext(null);function ye({value:e,readOnly:s=!1,infoLabel:t="Program code",fillValue:o="Hello, World!",placeholder:a,handleChange:r}){const i=x.useContext(I);if(!i)throw new Error("TextArea must be used within EditorContext.Provider");const{height:c}=i,p=le("md"),l=Math.floor(c/(p?24:32)),d=e!==void 0?{value:e||"",onChange:r}:{defaultValue:o,onChange:r};return n.jsx(Oe,{variant:"outlined",label:t,placeholder:a,slotProps:{inputLabel:{shrink:!0},htmlInput:{readOnly:s}},fullWidth:!0,multiline:!0,rows:l,...d,sx:{"& .MuiInputBase-root":{alignItems:"flex-start",backgroundColor:h.surface.glass,backdropFilter:"blur(24px) saturate(180%)",borderRadius:W.borderRadius.md,border:`1px solid ${h.border.subtle}`},"& .MuiInputBase-input":{fontFamily:"monospace",color:"text.primary","&::placeholder":{opacity:.6,color:"text.secondary"}},"& .MuiOutlinedInput-notchedOutline":{borderColor:h.border.subtle},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:h.border.subtle},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"primary.light"},"& .MuiInputLabel-root":{color:"text.secondary"},"& .MuiInputLabel-root.Mui-focused":{color:"primary.light"}}})}function O({text:e,...s}){return n.jsx(D,{...s,sx:[{fontSize:"inherit",fontWeight:"inherit",fontFamily:"inherit",userSelect:"none",lineHeight:1,display:"inline"},...Array.isArray(s.sx)?s.sx:[s.sx]],children:e})}const _e=re,Je=x.memo(function({compact:e=!1}){const s=x.useContext(I);if(!s)return null;const{code:t,index:o}=s;return t===void 0?null:e?n.jsx(X,{Icon:ue,title:"Program",data:[...t],pointer:o}):n.jsx(U,{Icon:ue,title:"Program",data:[...t],pointer:o,children:n.jsx(O,{text:"\xA0"})})}),Qe=x.memo(function({compact:e=!1}){const s=x.useContext(I);if(!s)return null;const{tape:t,pointer:o,tapeFlag:a}=s;return a?e?n.jsx(X,{Icon:pe,title:"Tape",data:t,pointer:o}):n.jsx(U,{Icon:pe,title:"Tape",data:t,pointer:o,children:n.jsx(O,{text:"\xA0"})}):null}),Ze=x.memo(function({compact:e=!1}){const s=x.useContext(I);if(!s)return null;const{output:t,outFlag:o}=s;if(!o)return null;const a=Array.isArray(t)?t:[t];return e?n.jsx(X,{Icon:xe,title:"Output",data:a}):n.jsx(U,{Icon:xe,title:"Output",data:a,children:n.jsx(O,{text:"\xA0"})})}),et=x.memo(function({compact:e=!1}){const s=x.useContext(I);if(!s)return null;const{register:t,regFlag:o}=s;return o?e?n.jsx(X,{Icon:he,title:"Register",data:[t]}):n.jsx(U,{Icon:he,title:"Register",data:[t],children:n.jsx(O,{text:"\xA0"})}):null});function U({Icon:e,title:s,data:t,pointer:o,children:a}){const r=Z.useMemo(()=>t.map((i,c)=>({id:`${s}-${String(c)}`,val:i,ind:c})),[t,s]).map(i=>{const c=o===i.ind?"info":"inherit";return n.jsx(O,{color:c,text:i.val,sx:{fontSize:S.fontSize.body,fontWeight:S.fontWeight.semibold,fontFamily:"monospace"}},i.id)});return n.jsxs(M,{sx:{height:"100%"},children:[n.jsxs(M,{sx:{display:"flex",alignItems:"center",gap:1,marginBottom:1},children:[n.jsx(e,{sx:{color:h.primary.main}}),n.jsx(D,{variant:"subtitle2",sx:{color:h.primary.main,fontWeight:S.fontWeight.semibold,fontSize:S.fontSize.body},children:s})]}),n.jsxs(tt,{children:[r,a]})]})}function X({Icon:e,title:s,data:t,pointer:o}){const a=Z.useMemo(()=>t.map((r,i)=>({id:`${s}-${String(i)}`,val:r,ind:i})),[t,s]).map(r=>{const i=o===r.ind?"info":"inherit";return n.jsx(Ae,{label:String(r.val),size:"small",sx:{backgroundColor:i==="info"?h.primary.main:h.surface.glass,color:h.text.primary,fontFamily:"monospace",fontSize:S.fontSize.caption,height:"32px",border:`1px solid ${h.border.subtle}`,backdropFilter:"blur(24px) saturate(180%)"}},r.id)});return n.jsxs(_e,{sx:{height:"100%",minHeight:"24rem"},children:[n.jsxs(M,{sx:{display:"flex",alignItems:"center",gap:1,marginBottom:1},children:[n.jsx(e,{sx:{color:h.primary.main,fontSize:S.fontSize.body}}),n.jsx(D,{variant:"caption",sx:{color:h.primary.main,fontWeight:S.fontWeight.semibold,fontSize:S.fontSize.caption},children:s})]}),n.jsx(M,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:a})]})}function tt({children:e}){return n.jsx(re,{sx:{overflowX:"auto",width:"100%",maxWidth:"100%",height:"60px",display:"flex",flexDirection:"column",justifyContent:"center",padding:2},children:n.jsx(M,{sx:{display:"flex",alignItems:"center",gap:1,width:"max-content",minWidth:0},children:e})})}function rt(){const e=x.useContext(I),s=Te("(min-width:650px)"),t=(e==null?void 0:e.pause)??!1,o=x.useMemo(()=>(e==null?void 0:e.dispatch)??(()=>{}),[e]),a=(e==null?void 0:e.fastForward)??!1,r=x.useMemo(()=>t?n.jsx(A,{title:"Run",onClick:o("run"),Icon:qe},"Run"):n.jsx(A,{title:"Pause",onClick:o("stop"),Icon:Ke},"Pause"),[o,t]);if(!e)return[];const i={Reset:{icon:fe,action:"reset",flag:!0},"Fast Forward":{icon:ge,flag:a,action:"ff"},Previous:{icon:Xe,flag:s,action:"prev"},Next:{icon:Ue,flag:s,action:"next"}},c=[],p=i["Fast Forward"]??{icon:ge,flag:!1};return c.push(r),c.push(n.jsx(A,{title:"Reset",Icon:fe,onClick:o("reset")},"Reset")),c.push(n.jsx(A,{title:"Fast Forward",Icon:p.icon,onClick:p.flag?o("ff"):void 0,disabled:!p.flag,sx:{opacity:p.flag?1:.3,"&.Mui-disabled":{color:"inherit",opacity:.3}}},"Fast Forward")),["Previous","Next"].forEach(l=>{const d=i[l];if(!d)return;const{icon:u,flag:g,action:f}=d;f&&g&&c.push(n.jsx(A,{title:l,Icon:u,onClick:o(f)},l))}),c}function ve(e,s){const{type:t,payload:o}=s;let a={};const{dispatch:r,create:i,clear:c}=o,p=(function(m){return(b,k)=>{const{nextIter:R,clear:j}=m;return k&&j(),{...R({type:b,payload:m}),select:null}}})(o),l=()=>{r({type:"timer",payload:o})},d=!1,u=!0,g=!0,f=!0;switch(t){case"run":i({repeat:l,speed:ee.timer.defaultSpeed}),a.pause=d;break;case"timer":{const m=e.end?"stop":"next";r({type:m,payload:o});break}case"stop":c(),a.pause=u;break;case"reset":window.confirm("Are you sure you want to reset the code?")&&(a=p("clear",!0),a.pause=g);break;case"prev":a=p("prev",!0),a.pause=f;break;case"next":a=p("next",!1);break;case"share":{const m=window.location.href;navigator.clipboard.writeText(m);break}}return a}function ke({container:e,sideProps:s={},hide:t=!1,navigation:o,children:a}){const r=x.useContext(I);if(!r)throw new Error("Editor must be used within EditorContext.Provider");const{tapeFlag:i,outFlag:c,regFlag:p,code:l}=r;let d,u;t?(d="none",u=12):(u={xs:6,md:8},d="flex");const g={flex:{xs:"none",md:1},spacing:2,ref:e,container:!0,display:"flex",alignItems:"center",sx:{overflowY:"hidden",height:{xs:l!==void 0?Y.layout.editorHeight.xs.withCode:Y.layout.editorHeight.xs.withoutCode,md:"auto"}}};return n.jsxs(v,{container:!0,spacing:2,minHeight:{xs:"50vh",md:"auto"},height:{xs:"auto",md:`calc(100vh - ${Be.headerHeight.md.toString()}px)`},direction:"column",wrap:"nowrap",padding:Y.layout.padding,sx:{background:h.surface.background,position:"relative",boxSizing:"border-box",width:"100% !important",margin:"0 !important",display:"flex",flexDirection:"column",overflowY:"auto",height:"100%"},children:[n.jsxs(v,{container:!0,alignItems:"center",direction:{xs:"column",md:"row"},justifyContent:"space-between",sx:{mb:{xs:2,md:0},gap:{xs:2,md:0}},children:[n.jsx(v,{size:"grow",display:"flex",alignItems:"center",justifyContent:{xs:"center",md:"flex-start"},sx:{width:"100%"},children:n.jsx(D,{variant:"h4",sx:{fontSize:S.fontSize.h2,fontWeight:S.fontWeight.semibold,paddingLeft:{xs:0,md:2},flexShrink:0},children:"Interpreters"})}),n.jsxs(v,{display:"flex",alignItems:"center",gap:1,size:"auto",justifyContent:{xs:"center",md:"flex-end"},sx:{paddingRight:1,width:{xs:"100%",md:"auto"}},children:[n.jsx(rt,{}),o&&n.jsx(M,{sx:{flexShrink:0},children:o})]})]}),n.jsxs(v,{...g,children:[n.jsx(v,{size:u,children:a}),n.jsx(v,{display:d,size:{xs:6,md:4},children:n.jsx(ye,{...s})})]}),n.jsx(v,{size:{xs:12},sx:{minHeight:[l!==void 0,i,c,p].filter(Boolean).length>0?{xs:"auto",md:Y.layout.fieldsMinHeight.md}:0,flexShrink:0},children:n.jsx(v,{container:!0,spacing:2,sx:{width:"100%",maxWidth:"100%"},children:(()=>{const f=[],m={xs:12,md:6};return l!==void 0&&f.push(n.jsx(v,{size:m,sx:{width:"100%",maxWidth:"100%",overflow:"hidden"},children:n.jsx(Je,{})},"program")),i&&f.push(n.jsx(v,{size:m,sx:{width:"100%",maxWidth:"100%",overflow:"hidden"},children:n.jsx(Qe,{})},"tape")),c&&f.push(n.jsx(v,{size:m,sx:{width:"100%",maxWidth:"100%",overflow:"hidden"},children:n.jsx(Ze,{})},"output")),p&&f.push(n.jsx(v,{size:m,sx:{width:"100%",maxWidth:"100%",overflow:"hidden"},children:n.jsx(et,{})},"register")),f})()})})]})}let ne=null;function nt(e,s){const{type:t,payload:o}=s,{nextIter:a,clear:r,create:i,dispatch:c}=o;let p={};switch(t){case"ff":{const l=()=>{c({type:"timer",payload:o})};e.pause?(p={pause:!1},i({repeat:l,speed:50})):(r(),p={pause:!1},i({repeat:l,speed:10}));break}case"edit":{const{newText:l,clean:d}=o;l!==void 0&&d&&(p={...e,text:l,code:d(l)},r(),a({type:"clear",payload:p}),p.pause=!0);break}default:p=ve(e,s)}return{...e,...p}}function je({name:e,start:s,runner:t,clean:o,tape:a,output:r,register:i,navigation:c}){const p=Z.useRef(null),l=de(p),[d,u]=x.useReducer(nt,{...s,pause:!0,text:"",code:""}),{create:g,clear:f}=be(200),m=me(t);x.useEffect(()=>{document.title=te.interpreter(e)},[e]);const b=x.useCallback(y=>{u({type:"edit",payload:{newText:y.target.value,clean:o,nextIter:m,clear:f,create:g,dispatch:u}})},[o,m,f,g,u]),k=x.useCallback(y=>{b(y)},[b]),R=x.useCallback(y=>{if(typeof y=="string")return()=>{u({type:y,payload:{start:s,nextIter:m,dispatch:u,create:g,clear:f}})};u({type:y.type,payload:{...y.payload,start:s,nextIter:m,dispatch:u,create:g,clear:f}})},[s,m,g,f,u]),j=x.useMemo(()=>{let{height:y}=l;return y===0&&ne!==null&&(y=ne.height),{name:e,tapeFlag:a??!1,outFlag:r??!1,regFlag:i??!1,code:d.code?Array.from(d.code):[],index:d.index??0,tape:d.tape??[],pointer:d.pointer??0,output:d.output??"",register:d.register??0,height:y,size:0,dispatch:R,fastForward:!0,pause:d.pause??!1}},[l,e,a,r,i,d.code,d.index,d.tape,d.pointer,d.output,d.register,d.pause,R]);return x.useEffect(()=>{l.height>0&&(ne={height:l.height})},[l.height]),n.jsx(I.Provider,{value:j,children:n.jsx(ke,{hide:!0,container:p,sideProps:{readOnly:!0,infoLabel:"RISC-V Equivalent",fillValue:"addi x0, x0, 0",value:""},navigation:c,children:n.jsx(ye,{value:d.text,placeholder:"Enter your code here...",handleChange:k})})})}function we({navigation:e}){const s=x.useCallback(o=>(function(a){let{pointer:r,index:i,tape:c,end:p}=a;const{code:l}=a;if(p){if(c[r]===void 0||!c[r])return a;p=!1}if(i===l.length)return{...a,index:0,end:!0};const d=l[i++];if(c=[...c],d==="+"){const u=c[r];u!==void 0&&(c[r]=u+1)}else if(c[r])if(d==="-"){const u=c[r];u!==void 0&&(c[r]=u-1)}else d===">"?c.length===++r&&c.push(1):r&&r--;return{pointer:r,index:i,code:l,tape:c,end:p}})(o),[]),t=x.useCallback(o=>(function(a){let r="";for(const i of a)"+-><".includes(i)&&(r+=i);return r})(o),[]);return n.jsx(je,{name:"Stun Step",start:{pointer:0,index:0,tape:[0],end:!1,code:""},runner:s,clean:t,tape:!0,navigation:e})}function ot({navigation:e}){const s=x.useCallback(o=>(function(a){let{register:r,pointer:i,output:c,index:p,tape:l,end:d}=a;const{code:u}=a;if(d&&(d=!1),p===u.length)return{...a,index:0,end:!0};const g=u[p++];switch(l=[...l],g){case">":l.length===++i&&l.push(0);break;case"<":{const f=l[i];f!==void 0&&(r+=f),i=0;break}case"!":{const f=l[i];if(f!==void 0){const m=f-(r-1);l[i]=m<0?0:m}r=0,i=0;break}case",":{const f=prompt("Input: ");r=f!=null&&f.length?f.charCodeAt(0):0;break}case".":r>0&&(c+=String.fromCharCode(r-1))}return{register:r,pointer:i,output:c,index:p,code:u,tape:l,end:d}})(o),[]),t=x.useCallback(o=>(function(a){let r="";for(const i of a)"><!,.".includes(i)&&(r+=i);return r})(o),[]);return n.jsx(je,{name:"Suffolk",start:{register:0,pointer:0,output:"",index:0,tape:[0],end:!1,code:""},runner:s,clean:t,tape:!0,output:!0,register:!0,navigation:e})}function st(e,s){const{type:t}=s;let o={};switch(t){case"edit":o=(function(a,r){let i,{grid:c,select:p}=a;const{key:l,resetState:d}=r;if(p===null)return{};if(l.includes("Arrow")){const f=Ve(l),{rows:m,cols:b}=a;return p=q(p,f,m,b),{select:p}}if(l==="Backslash"||l==="\\")i="\\";else if(l.length===1)i=l;else{if(l!=="Backspace"&&l!=="Delete")return{};i=" "}const u=c.slice(0,p),g=c.slice(p+1);return c=u+i+g,d(c),{grid:c,pause:!0}})(e,s.payload);break;case"resize":o=(function(a,r){const{resetState:i,...c}=r;let{grid:p}=a;const{rows:l,cols:d}=a;let u="";const{rows:g,cols:f}=c;g!==void 0&&g>l&&(p+=" ".repeat((g-l)*d));const m=g??l,b=f??d;for(let k=0;k<m;k++){const R=k*d;let j=R;j+=f!==void 0&&f>d?d:f??d,u+=p.substring(R,j).padEnd(b," ")}return i(u),{...c,grid:u,pause:!0}})(e,s.payload);break;case"click":{const{select:a}=s.payload;o=a===e.select?{select:null}:{select:a};break}case"delete":{const{tape:a,pointer:r}=e;r>0&&a[r]===0&&e.pointer--;break}default:o=ve(e,s)}return{...e,...o}}function it({handleClick:e,chooseColor:s,options:t,rows:o,cols:a}){const r=x.useContext(I);if(!r)throw new Error("GridArea must be used within EditorContext.Provider");const{size:i}=r,c=x.useMemo(()=>({primary:{bg:h.surface.glass,text:h.primary.main,border:`1px solid ${h.primary.main}`,hover:h.interactive.selected},info:{bg:h.interactive.focus,text:h.text.primary,border:`1px solid ${h.primary.main}`,hover:h.interactive.hover},secondary:{bg:h.surface.glass,text:h.text.secondary,border:`1px solid ${h.border.subtle}`,hover:h.interactive.selected}}),[]),p=x.useMemo(()=>l=>c[l]??c.secondary,[c]);return n.jsx(Ne,{cellProps:(l,d)=>{const u=a*l+d,g=s(u),f=t[u]??" ",m=p(g);return{color:m.text,backgroundColor:m.bg,onClick:e(u),onKeyDown:b=>{b.key!=="Enter"&&b.key!==" "||(b.preventDefault(),e(u)())},role:"button",tabIndex:0,"aria-label":`Cell ${String(l+1)}, ${String(d+1)}, value ${f}`,children:n.jsx(O,{text:f}),sx:{borderRadius:W.borderRadius.md,cursor:"pointer",transition:B.transition,...B.presets.glass,border:m.border,"&:hover":{backgroundColor:m.hover}}}},size:i,rows:o,cols:a})}const at=({keys:e,onSelect:s})=>n.jsx(M,{sx:{width:"100%",padding:"16px",background:h.surface.glass,borderTop:`1px solid ${h.border.subtle}`,backdropFilter:"blur(24px) saturate(180%)",position:"fixed",bottom:0,left:0,right:0,zIndex:1e3,display:"flex",flexDirection:"column",alignItems:"center",gap:1},children:n.jsxs(v,{container:!0,spacing:.5,justifyContent:"center",sx:{maxWidth:"468px",width:"100%"},children:[e.map(t=>n.jsx(v,{children:n.jsx(V,{variant:"contained",onClick:()=>{s(t)},sx:{minWidth:"44px",width:"44px",height:"44px",padding:0,background:h.surface.glass,color:h.text.primary,borderRadius:W.borderRadius.sm,border:`1px solid ${h.border.subtle}`,"&:hover":{background:h.interactive.hover}},children:t===" "?"\u2423":t})},t)),n.jsx(v,{children:n.jsx(V,{variant:"contained",onClick:()=>{s("Backspace")},sx:{minWidth:"44px",width:"44px",height:"44px",padding:0,background:h.surface.glass,color:h.text.primary,borderRadius:W.borderRadius.sm,border:`1px solid ${h.border.subtle}`,"&:hover":{background:h.interactive.hover}},children:"\u232B"})}),n.jsx(v,{children:n.jsx(V,{variant:"contained",onClick:()=>{s("Escape")},sx:{minWidth:"44px",width:"44px",height:"44px",padding:0,background:h.surface.glass,color:h.data.red,borderRadius:W.borderRadius.sm,border:`1px solid ${h.border.subtle}`,"&:hover":{background:h.interactive.hover}},children:"\u2715"})})]})});let oe=null;function Ce(e){const{create:s,clear:t}=(function(){const w=x.useRef(null),J=x.useCallback($=>{w.current=$,document.addEventListener("keydown",$)},[]),E=x.useCallback($=>{const P=$??w.current;P&&document.removeEventListener("keydown",P)},[]);return x.useEffect(()=>()=>{w.current&&document.removeEventListener("keydown",w.current)},[]),{create:J,clear:E}})(),{name:o,start:a,tape:r,output:i,register:c,navigation:p,keys:l=[]}=e,d=x.useRef(null);let{height:u,width:g}=de(d);const f=le("md"),m=f?4:6;u=(u||400)*(f?1:.8),g=.95*(g||600);const{rows:b,cols:k}=x.useMemo(()=>!d.current&&oe?oe:Ye(m,u,g),[m,u,g]);x.useEffect(()=>{d.current&&b>0&&k>0&&(oe={rows:b,cols:k})},[b,k]);const R={...a,grid:" ".repeat(b*k),select:null,pause:!0,rows:b,cols:k},[j,y]=x.useReducer(st,R),{resetState:H,handleClick:Ie,chooseColor:Re,wrapDispatch:We}=(function(w,J,E){const{runner:$,start:P}=J,{rows:se,cols:ie}=w,{create:ae,clear:L}=be(200),G=me($),Q=x.useCallback(F=>(L(),G({type:"clear",payload:{...P,grid:F,rows:se,cols:ie}})),[P,L,G,se,ie]),Fe=x.useCallback(F=>()=>{E({type:"click",payload:{select:F}})},[E]),Me=x.useCallback(F=>{const{position:ce,select:Pe}=w;return F===Pe?"primary":ce!==null&&F===ce?"info":"secondary"},[w]),Ee=x.useCallback(F=>()=>{E({type:F,payload:{start:P,resetState:Q,nextIter:G,dispatch:E,create:ae,clear:L}})},[Q,G,E,ae,L,P]);return{resetState:Q,handleClick:Fe,chooseColor:Me,wrapDispatch:Ee}})(j,e,y);x.useEffect(()=>{y({type:"resize",payload:{rows:b,cols:k,resetState:H}})},[b,k,H]);const _=x.useCallback(w=>{w!=="Escape"?y({type:"edit",payload:{key:w,resetState:H}}):j.select!==null&&y({type:"click",payload:{select:j.select}})},[H,j.select]);x.useEffect(()=>(document.title=te.interpreter(o),s(w=>{_(w.key)}),()=>{t()}),[o,s,_,t]);const ze={name:o,size:m,...j,dispatch:We,tapeFlag:r??!1,outFlag:i??!1,regFlag:c??!1,height:u,index:0,tape:[],pointer:0,output:j.output??"",register:0,code:void 0,fastForward:!1,pause:j.pause};return n.jsxs(I.Provider,{value:ze,children:[n.jsx(ke,{hide:!0,container:d,navigation:p,children:n.jsx(it,{rows:b,cols:k,options:j.grid.split(""),handleClick:Ie,chooseColor:Re})}),f&&j.select!==null&&n.jsx(at,{keys:l,onSelect:_})]})}function Se(e,s,t){let o=e,a=s;const r=o%t,i=a%t;o-=r,a-=i;const c=Math.abs(o-a);return Math.floor(c/t)+Math.abs(r-i)}function ct(e,s,t){const o=[];for(let r=0;r<s.length;r++)s[r]==="@"&&o.push(r);if(o.length===1)return e;const a=(function(r,i){return(c,p)=>Se(r,c,i)-Se(r,p,i)})(e,t);return o.sort(a),o[1]??e}function lt(e){const s="^<>v";let{position:t,velocity:o,output:a,register:r,end:i}=e;const{grid:c,rows:p,cols:l}=e;if(i)return e;if(t==null){const u=c.indexOf("!"),g=c.lastIndexOf("!");if(u===-1||u!==g)return{...e,end:!0};t=u}const d=c[t];if(d===void 0)return e;if(s.includes(d)){const u=s.indexOf(d);o=u%2+1,u<2&&(o-=3)}else+d&&(r=+d);switch(d){case"|":o*=-1;break;case"@":t=ct(t,c,l),t-=l,t<0&&(t+=p*l);break;case"+":r++;break;case"-":r--;break;case"*":r*=2;break;case"s":r*=r;break;case"/":r=Math.floor(r/2);break;case"~":a+=String.fromCharCode(r);break;case"?":{const u=4*Math.random(),g=Math.floor(u);o=g-2+(g>1?1:0);break}case".":t=null,i=!0}return t!==null&&d!=="@"&&(t=q(t,o,p,l)),{...e,position:t,velocity:o,grid:c,output:a,register:r,end:i,rows:p,cols:l}}function dt({navigation:e}){return n.jsx(Ce,{name:"WII2D",start:{position:null,velocity:-2,end:!1,output:"",register:0},runner:lt,output:!0,register:!0,navigation:e,keys:["^","<",">","v","|","'",'"',"@","+","-","*","s","/","~","?",".","!","0","1","2","3","4","5","6","7","8","9"]})}function ut(e){let{velocity:s,position:t,pointer:o,tape:a}=e;const{grid:r,rows:i,cols:c,end:p}=e;if(p||t==null)return e;const l=s>0?3:-3,d=r[t];switch(a=[...a],d){case"\\":s=l-s;break;case"/":s-=l;break;case"<":o&&o--;break;case">":++o===a.length&&a.push(0);break;case"-":{const u=a[o];u!==void 0&&(a[o]=1^u);break}case"+":{let u;if(!a[o])do t=q(t,s,i,c),u=r[t]??"";while(!"\\/<>-+*".includes(u));break}}return t=q(t,s,i,c),{...e,velocity:s,position:t,pointer:o,grid:r,tape:a,rows:i,cols:c,end:p}}function pt({navigation:e}){return n.jsx(Ce,{name:"Back",start:{velocity:1,pointer:0,position:0,tape:[0],end:!1},runner:ut,tape:!0,navigation:e,keys:["\\","/","<",">","-","+","*"]})}const xt=({children:e})=>n.jsx(De,{FallbackComponent:({error:s,resetErrorBoundary:t})=>n.jsx(M,{sx:{display:"flex",justifyContent:"center",alignItems:"center",p:4,minHeight:"300px"},children:n.jsxs(re,{sx:{p:4,maxWidth:"500px",textAlign:"center"},children:[n.jsx(D,{variant:"h5",sx:{mb:2,color:h.text.primary,fontWeight:"bold"},children:"Interpreter Error"}),n.jsx(D,{sx:{mb:3,color:h.text.secondary,fontFamily:"monospace",fontSize:"0.9rem"},children:(s==null?void 0:s.message)??"An unexpected error occurred."}),n.jsx(V,{variant:"contained",onClick:t,sx:{borderRadius:W.borderRadius.md,textTransform:"none"},children:"Reset Interpreter"})]})}),children:e}),ht=({active:e,onChange:s})=>n.jsx(He,{size:"small",sx:{minWidth:{xs:140,sm:160},"& .MuiOutlinedInput-root":{...B.presets.glass,borderRadius:W.borderRadius.full,color:h.text.primary,fontWeight:S.fontWeight.medium,transition:B.transition,"& fieldset":{border:`1px solid ${h.border.subtle}`},"&:hover fieldset":{borderColor:h.primary.main},"&.Mui-focused fieldset":{borderColor:h.primary.main,boxShadow:`0 0 0 2px ${h.primary.main}22`}},"& .MuiSelect-select":{py:1,px:{xs:2,sm:3}},"& .MuiSvgIcon-root":{color:h.text.secondary}},children:n.jsxs(Le,{value:e,onChange:t=>{s(t.target.value)},MenuProps:{autoFocus:!1,BackdropProps:{sx:{backdropFilter:"none",backgroundColor:"transparent"}},PaperProps:{sx:{...B.presets.glass,borderRadius:W.borderRadius.lg,mt:1,"& .MuiMenuItem-root":{color:h.text.secondary,fontSize:"0.9rem",transition:B.transition,"&:hover":{backgroundColor:h.interactive.hover,color:h.text.primary},"&.Mui-selected":{backgroundColor:h.interactive.selected,color:h.primary.main,fontWeight:"bold","&:hover":{backgroundColor:h.interactive.selected}}}}}},children:[n.jsx(N,{value:C.interpreters.StunStep,children:"Stun Step"}),n.jsx(N,{value:C.interpreters.Suffolk,children:"Suffolk"}),n.jsx(N,{value:C.interpreters.WII2D,children:"WII2D"}),n.jsx(N,{value:C.interpreters.Back,children:"Back"})]})});function ft(){const[e,s]=$e(),t=e.get("type")??C.interpreters.StunStep;x.useEffect(()=>{document.title=te.interpreters},[]);const o=i=>{s({type:i})},a=`https://esolangs.org/wiki/${(r=t,{[C.interpreters.StunStep]:"Stun Step",[C.interpreters.Suffolk]:"Suffolk",[C.interpreters.WII2D]:"WII2D",[C.interpreters.Back]:"Back"}[r]??"Stun Step").replace(" ","_")}`;var r;return n.jsx(Ge,{infoUrl:a,containerSx:{height:{xs:"100dvh",md:"100vh"}},sx:{width:"100%",maxWidth:W.maxWidth.lg,margin:"0 auto",flex:1,display:"flex",justifyContent:"center",overflow:"hidden",boxSizing:"border-box"},children:n.jsx(xt,{children:(()=>{const i=n.jsx(ht,{active:t,onChange:o});switch(t){case C.interpreters.StunStep:return n.jsx(we,{navigation:i});case C.interpreters.Suffolk:return n.jsx(ot,{navigation:i});case C.interpreters.WII2D:return n.jsx(dt,{navigation:i});case C.interpreters.Back:return n.jsx(pt,{navigation:i});default:return n.jsx(we,{navigation:i})}})()})})}export{ft as default};
