import{j as e,r as t}from"./vendor_react-WaSaIrII.js";import{C as o,u as n,c as s}from"./layout-CO2XOOno.js";import{L as r,f as i,e as a,a as c}from"./index-DRVHd1NR.js";import{B as l,G as u}from"./vendor_mui_core-CC5VlWLf.js";import{w as d,x as f,E as m}from"./vendor_mui_icons-nmK6gwuH.js";import{G as h}from"./GlobalHeader-DEYno4Cn.js";function p(t){const{frontProps:n,backProps:s,size:i,rows:a,cols:c,frontLayerSx:u,backLayerSx:d}=t;return e.jsxs(l,{sx:{display:"grid",placeItems:"center"},children:[e.jsx(l,{sx:{gridArea:"1/1",...d},children:e.jsx(o,{space:0,size:i,rows:a-1,cols:c-1,cellProps:s})}),e.jsx(l,{sx:{gridArea:"1/1",zIndex:r.zIndex.base+1,...u},children:e.jsx(o,{space:0,size:i,rows:a,cols:c,cellProps:n})})]})}function w({gridSize:t,onRefresh:o,disabled:n=!1,children:s}){const{rows:r,cols:c,dynamicSize:l,minSize:u,maxSize:m,handlePlus:h,handleMinus:p}=t,w=r<=u&&c<=u,g=r>=m&&c>=m||r===l.rows&&c===l.cols;return e.jsxs(i,{onRefresh:o,children:[e.jsx(a,{title:"Decrease Size",Icon:d,onClick:p,disabled:n||w}),e.jsx(a,{title:"Increase Size",Icon:f,onClick:h,disabled:n||g}),s]})}function g(){const[e,o]=t.useState({height:window.innerHeight,width:window.innerWidth});return t.useEffect(()=>{const e=()=>{o({height:window.innerHeight,width:window.innerWidth})};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[]),e}function S({onAction:e,checkEnabled:o=()=>!0,touchTimeout:n=500,posAttribute:s="data-pos",preventDefault:r=!0,transition:i="all 0.2s"}){const[a,c]=t.useState(null),l=t.useRef(new Set),u=t.useRef(0),d=t.useCallback(()=>{c(null),l.current.clear()},[]),f=t.useCallback(t=>{if(null===a)return;const o=t.touches[0];if(!o)return;const n=document.elementFromPoint(o.clientX,o.clientY);if(!n)return;const r=n.closest(`[${s}]`);if(r){const t=r.getAttribute(s);t&&!l.current.has(t)&&(e(t,2===a,!1),l.current.add(t))}},[a,e,s]);t.useEffect(()=>(window.addEventListener("mouseup",d),window.addEventListener("touchend",d),window.addEventListener("touchcancel",d),window.addEventListener("touchmove",f,{passive:!1}),()=>{window.removeEventListener("mouseup",d),window.removeEventListener("touchend",d),window.removeEventListener("touchcancel",d),window.removeEventListener("touchmove",f)}),[d,f]);const m=t.useCallback(t=>({onMouseDown:s=>{o()&&(0!==s.button&&2!==s.button||Date.now()-u.current<n||(r&&s.preventDefault(),c(s.button),e(t,2===s.button,!0),l.current.add(t)))},onMouseEnter:()=>{null!==a&&!l.current.has(t)&&o()&&(e(t,2===a,!1),l.current.add(t))},onTouchStart:n=>{o()&&(n.cancelable&&r&&n.preventDefault(),u.current=Date.now(),c(0),e(t,!1,!0),l.current.add(t))},onContextMenu:e=>{r&&e.preventDefault()},[s]:t,sx:{touchAction:"none",transition:i}}),[e,o,a,n,s,r,i]);return{isDragging:null!==a,draggingButton:a,getDragProps:m,lastTouchTime:u}}const x="32px",b="48px",E=.4,I={WIN_ANIMATION_DELAY:2e3,TOUCH_HOLD_DELAY:500},v={LINE_WIDTH:"130%",LINE_THICKNESS:"6px",CALCULATOR_BORDER_RADIUS:"24px",PADDING_OFFSET:100,WIDTH_LIMIT:1e3,BOARD_MAX_WIDTH:1200,BOARD_SIZE_FACTOR:.95,MAX_CELL_SIZE:100,REM_BASE:16,ICON_SIZE_RATIO:.8},R={SIZE:"slant-size",STATE:"slant-state",GHOST_MOVES:"slant-ghost-moves"},T={MIN_SIZE:3,DEFAULT_SIZE:7,PUZZLE_GENERATION_ITERATIONS:30},z={COLORS:{WHITE:"#fff"},SHADOWS:{LINE:"0 2px 4px rgba(0,0,0,0.2)",HINT:"0 4px 8px rgba(0,0,0,0.1)"},GHOST:{BORDER:"rgba(255, 255, 255, 0.1)",BG_SUBTLE:"rgba(255, 255, 255, 0.02)",BG_HOVER:"rgba(255, 255, 255, 0.1)",DASHED_BORDER:"rgba(255, 255, 255, 0.2)",HINT_BG:"hsl(217, 50%, 8%)",HINT_BORDER:"rgba(255, 255, 255, 0.3)"}};function y({onToggle:e,checkEnabled:o,touchTimeout:n=I.TOUCH_HOLD_DELAY,transition:s,posAttribute:r}){const i=t.useRef(void 0),a=t.useRef(e);a.current=e;const c=t.useCallback((e,t,n)=>{if(!o())return;const[s,r]=e.split(",").map(Number);if(void 0!==s&&void 0!==r)if(n){const e=a.current(s,r,t);void 0!==e&&(i.current=e)}else a.current(s,r,t,i.current)},[o]),{getDragProps:l}=S({onAction:c,checkEnabled:o,touchTimeout:n,transition:s,posAttribute:r});return{getDragProps:l}}function D({show:t,onReset:o,size:n,iconSizeRatio:s,primaryColor:r,secondaryColor:i,useSecondary:a=!1}){return e.jsx(l,{onClick:o,sx:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",opacity:t?1:0,transform:t?"scale(1)":"scale(0.5)",visibility:t?"visible":"hidden",transition:"all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1)",cursor:"pointer",zIndex:10,backgroundColor:"transparent"},children:n>0&&e.jsx(m,{sx:{fontSize:`${(n*s).toString()}rem`,color:a?i:r,filter:"drop-shadow(0 4px 12px rgba(0,0,0,0.1))"}})})}function _({children:t,controls:o,infoUrl:s,_title:r,background:i=c.surface.background,paddingBottom:a={xs:"80px",md:"120px"},contentSx:d={},showTrophy:f=!1,onReset:m,boardSize:p=0,iconSizeRatio:w=1,primaryColor:g,secondaryColor:S,useSecondaryTrophy:x=!1,boardSx:b}){return n("sm"),e.jsxs(u,{container:!0,minHeight:"100vh",flexDirection:"column",sx:{background:i,position:"relative",overflow:"hidden",height:"100vh",transition:"background 0.5s ease-in-out"},children:[e.jsx(h,{showHome:!0,infoUrl:s}),e.jsx(l,{sx:[{flex:1,position:"relative",width:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",overflow:"hidden",pb:a},...d?Array.isArray(d)?d:[d]:[]],children:e.jsxs(l,{sx:[{position:"relative",width:"fit-content"},...b?Array.isArray(b)?b:[b]:[]],children:[t,e.jsx(D,{show:f,onReset:m,size:p,iconSizeRatio:w,primaryColor:g,secondaryColor:S,useSecondary:x})]})}),o]})}function A({storageKey:e,defaultSize:o,minSize:r=2,maxSize:i=10,headerOffset:a,paddingOffset:c=0,widthLimit:l=1300,cellSizeReference:u,mobileRowOffset:d=0}){const{height:f,width:m}=g(),h=n("sm"),[p,w]=t.useState(()=>{const t=localStorage.getItem(e);return"null"===t?null:t?parseInt(t,10):o}),S=t.useMemo(()=>{const e=h?a.mobile:a.desktop,t="number"==typeof u?u:h?u.mobile:u.desktop,o=s(t,f-e-c,Math.min(m,l));let n=o.rows-1;const i=o.cols-1;return h&&(n+=d),{rows:Math.max(r,n),cols:Math.max(r,i)}},[u,f,m,h,a,c,l,r,d]),{rows:x,cols:b}=t.useMemo(()=>null===p?S:{rows:Math.min(p,S.rows),cols:Math.min(p,S.cols)},[p,S]);t.useEffect(()=>{localStorage.setItem(e,String(p))},[p,e]);return{rows:x,cols:b,dynamicSize:S,handlePlus:()=>{const e=Math.min(x,b);null!==p&&(e<Math.min(S.rows,S.cols)?w(e+1):S.rows===S.cols||x===S.rows&&b===S.cols||w(null))},handleMinus:()=>{const e=Math.min(x,b);if(null===p){const e=Math.min(S.rows,S.cols);S.rows===S.cols?w(Math.max(r,e-1)):w(e)}else e>r&&w(e-1)},desiredSize:p,setDesiredSize:w,mobile:h,width:m,height:f,minSize:r,maxSize:i}}function O({storageKey:e,rows:o,cols:n,state:s,onRestore:r,serialize:i,deserialize:a,enabled:c=!0,saveDebounceMs:l=300}){const u=`${e}-${String(o)}x${String(n)}`,d=t.useRef(r),f=t.useRef(a),m=t.useRef(i);t.useEffect(()=>{d.current=r,f.current=a,m.current=i}),t.useEffect(()=>{if(!c)return;const e=localStorage.getItem(u);if(e)try{const t=JSON.parse(e),o=f.current??(e=>e);d.current(o(t))}catch(t){localStorage.removeItem(u)}},[u,c]),t.useEffect(()=>{if(!c)return;const e=setTimeout(()=>{const e=(m.current??(e=>e))(s);localStorage.setItem(u,JSON.stringify(e))},l);return()=>{clearTimeout(e)}},[u,s,c,l])}function C({gridSizeConfig:e,responsiveBoardConfig:o,persistenceConfig:s,winTransitionConfig:r,pageTitle:i,reducer:a,getInitialState:c}){const l=A(e),{rows:u,cols:d}=l,f=t.useMemo(()=>c(u,d),[u,d,c]),[m,h]=t.useReducer(a,f);var p;p=i,t.useEffect(()=>{document.title=p},[p]);const w=t.useCallback(()=>{h({type:"next"})},[h]);O({...s,rows:u,cols:d,state:m,onRestore:e=>{h({type:"restore",state:e})}}),function(e,o,n=2e3){const s=t.useRef(o);s.current=o,t.useEffect(()=>{if(e){const e=setTimeout(()=>{s.current()},n);return()=>{clearTimeout(e)}}},[e,n])}(m.solved,w,r?.delay??1e3),t.useEffect(()=>{m.rows===u&&m.cols===d||h({type:"resize",rows:u,cols:d})},[u,d,m.rows,m.cols,h]);const S=function({rows:e,cols:o,headerOffset:s,paddingOffset:r,boardMaxWidth:i,boardSizeFactor:a,maxCellSize:c,remBase:l}){const{width:u,height:d}=g(),f=n("sm");return t.useMemo(()=>{const t=f?s.mobile:s.desktop,n="number"==typeof r?0:r.x,m="number"==typeof r?r:r.y,h=(Math.min(u,i)-n)*a,p=(d-t-m)*a;return Math.min(h/o,p/e,c)/l},[u,d,f,e,o,s,r,i,a,c,l])}({...o,rows:u+(o.rowOffset??0),cols:d+(o.colOffset??0)});return{gridSize:l,state:m,dispatch:h,boardSize:S,handleReset:w}}export{p as B,b as D,_ as G,v as L,x as M,E as N,z as S,I as T,C as a,y as b,w as c,T as d,A as e,O as f,R as g,S as u};
