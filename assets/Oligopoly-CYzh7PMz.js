import{r as o,j as t}from"./vendor_react-DdkxgTu-.js";import{p as e}from"./pako.esm-hE_UBizs.js";import{a as i,R as a}from"./ResearchDemo-DyBsLnXA.js";import{h as r,T as l,i as n}from"./vendor_mui_icons-BOQsY4SM.js";import{d as s,C as c,U as u}from"./index-cDAMucTj.js";import"./PageLayout-PpC1tA3C.js";import"./vendor_mui_core-CQ3K-gFd.js";import"./vendor_recharts-Bod-2OPO.js";const d=(o,t,e,a,r,l)=>{if(0===o.length)return m();const n=o.filter(o=>o.num_firms===t&&o.model_type===e&&o.demand_elasticity===a&&o.base_price===r&&o.collusion_enabled===l);if(0===n.length){return o.filter(o=>o.num_firms===t&&o.model_type===e).sort((o,t)=>o.round-t.round).slice(0,i.oligopoly.maxRounds)}return n.sort((o,t)=>o.round-t.round).slice(0,15)},m=()=>{const o=[];for(let t=1;t<=i.oligopoly.maxRounds;t++){const e=i.oligopoly.simulation;o.push({round:t,price:e.fallbackPrice+Math.sin(t*e.priceFrequency)*e.priceAmplitude,hhi:e.fallbackHHI+Math.sin(t*e.hhiFrequency)*e.hhiAmplitude,collusion:t>e.collusionStart&&t<e.collusionEnd})}return o},p=()=>{const[p,y]=o.useState(i.oligopoly.defaultFirms),[g,f]=o.useState(i.oligopoly.defaultElasticity),[h,x]=o.useState(i.oligopoly.defaultBasePrice),[F,A]=o.useState([]),[b,_]=o.useState([]),[S,j]=o.useState(!0),M=i.modelTypes.cournot,w=!1;o.useEffect(()=>{document.title=s.oligopoly;(async()=>{j(!0);try{const o=await(async()=>{try{const o=await fetch("/oligopoly_data.json.gz");if(!o.ok)throw new Error(`HTTP error! status: ${o.status.toString()} - Failed to load Oligopoly data`);const t=await o.arrayBuffer(),i=new Uint8Array(t);let a;a=31===i[0]&&139===i[1]?e.ungzip(i,{to:"string"}):(new TextDecoder).decode(t);const r=JSON.parse(a);if(!Array.isArray(r))throw new Error("Invalid data format: expected array");return r}catch(o){return[]}})();_(o);const t=d(o,p,M,g,h,w);A(t)}catch(o){A(m())}finally{j(!1)}})()},[p,g,h,w,M]),o.useEffect(()=>{if(b.length>0){const o=d(b,p,M,g,h,w);A(o)}},[p,g,h,b,M,w]);const E=[{label:"Number of Firms",icon:r,color:c.primary.main,value:p,onChange:y,options:i.oligopoly.options.firms},{label:"Demand Elasticity",icon:l,color:c.data.green,value:g,onChange:f,options:i.oligopoly.options.elasticity},{label:"Base Price",icon:n,color:c.data.amber,value:h,onChange:x,options:i.oligopoly.options.price}],v={type:"line",xAxisKey:"round",yAxisFormatter:o=>`$${o.toFixed(2)}`,yAxisDomain:["dataMin - 5","dataMax + 5"],dualYAxis:!0,rightYAxisFormatter:o=>o.toFixed(2),rightYAxisDomain:[`dataMin - ${String(i.oligopoly.simulation.hhiFrequency)}`,`dataMax + ${String(i.oligopoly.simulation.hhiFrequency)}`],tooltipLabelFormatter:o=>`Round ${o.toString()}`,tooltipFormatter:(o,t)=>["Market Price"===t?`$${o.toFixed(2)}`:o.toFixed(2),t],lines:[{dataKey:"price",name:"Market Price",color:c.primary.main,yAxisId:"left"},{dataKey:"hhi",name:"HHI Concentration",color:c.data.amber,yAxisId:"right"}]};return t.jsx(a,{title:"Oligopoly",subtitle:"Agent-Based Economic Competition Analysis",githubUrl:u.oligopolyRepo,chartData:F,chartConfig:v,chartTitle:"Market Dynamics",controls:E,loading:S,loadingMessage:"Loading Cournot simulation data...",onReset:()=>{y(i.oligopoly.defaultFirms),f(i.oligopoly.defaultElasticity),x(i.oligopoly.defaultBasePrice)},resetLabel:"Reset"})};export{p as default};
