import{r as o,j as t}from"./vendor_react-WaSaIrII.js";import{p as e}from"./pako.esm-hE_UBizs.js";import{a as i,R as a}from"./ResearchDemo-ug4qaFMT.js";import{d as r,a as l,U as s}from"./index-B-l19WKQ.js";import{h as n,T as c,i as d}from"./vendor_mui_icons-nmK6gwuH.js";import"./GlassCard-mrHjUWCi.js";import"./vendor_mui_core-CC5VlWLf.js";import"./GlobalHeader-BJIpmPyL.js";import"./vendor_recharts-CDIGGVwx.js";const u=(o,t,e,a,r,l)=>{if(0===o.length)return m();const s=o.filter(o=>o.num_firms===t&&o.model_type===e&&o.demand_elasticity===a&&o.base_price===r&&o.collusion_enabled===l);if(0===s.length){return o.filter(o=>o.num_firms===t&&o.model_type===e).sort((o,t)=>o.round-t.round).slice(0,i.oligopoly.maxRounds)}return s.sort((o,t)=>o.round-t.round).slice(0,15)},m=()=>{const o=[];for(let t=1;t<=i.oligopoly.maxRounds;t++){const e=i.oligopoly.simulation;o.push({round:t,price:e.fallbackPrice+Math.sin(t*e.priceFrequency)*e.priceAmplitude,hhi:e.fallbackHHI+Math.sin(t*e.hhiFrequency)*e.hhiAmplitude,collusion:t>e.collusionStart&&t<e.collusionEnd})}return o},p=()=>{const[p,y]=o.useState(i.oligopoly.defaultFirms),[g,f]=o.useState(i.oligopoly.defaultElasticity),[h,x]=o.useState(i.oligopoly.defaultBasePrice),[F,b]=o.useState([]),[A,_]=o.useState([]),[j,S]=o.useState(!0),M=i.modelTypes.cournot,w=!1;o.useEffect(()=>{document.title=r.oligopoly;(async()=>{S(!0);try{const o=await(async()=>{try{const o=await fetch("/oligopoly_data.json.gz");if(!o.ok)throw new Error(`HTTP error! status: ${o.status.toString()} - Failed to load Oligopoly data`);const t=await o.arrayBuffer(),i=new Uint8Array(t),a=31===i[0]&&139===i[1]?e.ungzip(i,{to:"string"}):(new TextDecoder).decode(t),r=JSON.parse(a);if(!Array.isArray(r))throw new Error("Invalid data format: expected array");return r}catch(o){return[]}})();_(o);const t=u(o,p,M,g,h,w);b(t)}catch(o){b(m())}finally{S(!1)}})()},[p,g,h,w,M]),o.useEffect(()=>{if(A.length>0){const o=u(A,p,M,g,h,w);b(o)}},[p,g,h,A,M,w]);const E=[{label:"Number of Firms",icon:n,color:l.primary.main,value:p,onChange:y,options:i.oligopoly.options.firms},{label:"Demand Elasticity",icon:c,color:l.data.green,value:g,onChange:f,options:i.oligopoly.options.elasticity},{label:"Base Price",icon:d,color:l.data.amber,value:h,onChange:x,options:i.oligopoly.options.price}],k={type:"line",xAxisKey:"round",yAxisFormatter:o=>`$${o.toFixed(2)}`,yAxisDomain:["dataMin - 5","dataMax + 5"],dualYAxis:!0,rightYAxisFormatter:o=>o.toFixed(2),rightYAxisDomain:[`dataMin - ${String(i.oligopoly.simulation.hhiFrequency)}`,`dataMax + ${String(i.oligopoly.simulation.hhiFrequency)}`],tooltipLabelFormatter:o=>`Round ${o.toString()}`,tooltipFormatter:(o,t)=>["Market Price"===t?`$${o.toFixed(2)}`:o.toFixed(2),t],lines:[{dataKey:"price",name:"Market Price",color:l.primary.main,yAxisId:"left"},{dataKey:"hhi",name:"HHI Concentration",color:l.data.amber,yAxisId:"right"}]};return t.jsx(a,{title:"Oligopoly",subtitle:"Agent-Based Economic Competition Analysis",githubUrl:s.oligopolyRepo,chartData:F,chartConfig:k,chartTitle:"Market Dynamics",controls:E,loading:j,loadingMessage:"Loading Cournot simulation data...",onReset:()=>{y(i.oligopoly.defaultFirms),f(i.oligopoly.defaultElasticity),x(i.oligopoly.defaultBasePrice)},resetLabel:"Reset"})};export{p as default};
