import{r as z,a as ze,j as k,__tla as Ae}from"./vendor_react-BC_ZxTUy.js";import{A as ee,S as be,a as $,L as ae,e as te,d as he,__tla as Me}from"./index-C8P4Xo67.js";import{c as Te,b as me,f as ne,g as we,a as Oe,h as Be,d as De,G as He,e as We,B as Le}from"./GamePageLayout-DLHhDour.js";import{u as Ue,C as xe}from"./layout-Csyrq1KZ.js";import{B as D}from"./vendor_mui_core-D6ruIU1t.js";import{u as Ge,v as Pe,c as qe,P as Ve}from"./vendor_mui_icons-DNj8xVz8.js";import"./GlobalHeader-1JimkmyO.js";let ye,Fe=Promise.all([(()=>{try{return Ae}catch{}})(),(()=>{try{return Me}catch{}})()]).then(async()=>{const Q="18px",Y="24px",ce="130%",le="24px",_e="slant-size",Se="slant-state",ve="slant-ghost-moves",de={WHITE:"#fff"},q={LINE:"0 2px 4px rgba(0,0,0,0.2)",HINT:"0 4px 8px rgba(0,0,0,0.1)"},G={BORDER:"var(--slant-ghost-border)",BG_SUBTLE:"var(--slant-ghost-bg-subtle)",BG_HOVER:"var(--slant-ghost-bg-hover)",DASHED_BORDER:"var(--slant-ghost-dashed-border)",HINT_BG:"var(--slant-ghost-hint-bg)",HINT_BORDER:"var(--slant-ghost-hint-border)",HINT_TEXT:"var(--slant-ghost-hint-text)"};function Ce(e,t,r){const i=(function(p,f){const c=f(1*p.length,1)>>>0;return F().set(p,c/1),J=p.length,c})(e,M.__wbindgen_malloc),n=J,a=M.find_cycles_wasm(i,n,t,r);var u=(function(p,f){p>>>=0;const c=oe(),l=[];for(let o=p;o<p+4*f;o+=4)l.push(M.__wbindgen_externrefs.get(c.getUint32(o,!0)));return M.__externref_drop_slice(p,f),l})(a[0],a[1]).slice();return M.__wbindgen_free(a[0],4*a[1],4),u}function $e(){return{__proto__:null,"./slant_wasm_bg.js":{__proto__:null,__wbg___wbindgen_debug_string_0bc8482c6e3508ae:function(e,t){const r=(function(n,a,u){if(u===void 0){const o=X.encode(n),d=a(o.length,1)>>>0;return F().subarray(d,d+o.length).set(o),J=o.length,d}let p=n.length,f=a(p,1)>>>0;const c=F();let l=0;for(;l<p;l++){const o=n.charCodeAt(l);if(o>127)break;c[f+l]=o}if(l!==p){l!==0&&(n=n.slice(l)),f=u(f,p,p=l+3*n.length,1)>>>0;const o=F().subarray(f+l,f+p);l+=X.encodeInto(n,o).written,f=u(f,p,l,1)>>>0}return J=l,f})(re(t),M.__wbindgen_malloc,M.__wbindgen_realloc),i=J;oe().setInt32(e+4,i,!0),oe().setInt32(e+0,r,!0)},__wbg___wbindgen_throw_be289d5034ed271b:function(e,t){throw new Error(ue(e,t))},__wbg_new_361308b2356cecd0:function(){return new Object},__wbg_new_3eb36ae241fe6f44:function(){return new Array},__wbg_set_3f1d0b984ed272ed:function(e,t,r){e[t]=r},__wbg_set_f43e577aea94465b:function(e,t,r){e[t>>>0]=r},__wbindgen_cast_0000000000000001:function(e){return e},__wbindgen_cast_0000000000000002:function(e,t){return ue(e,t)},__wbindgen_init_externref_table:function(){const e=M.__wbindgen_externrefs,t=e.grow(4);e.set(0,void 0),e.set(t+0,void 0),e.set(t+1,null),e.set(t+2,!0),e.set(t+3,!1)}}}}function re(e){const t=typeof e;if(t=="number"||t=="boolean"||e==null)return`${e}`;if(t=="string")return`"${e}"`;if(t=="symbol"){const n=e.description;return n==null?"Symbol":`Symbol(${n})`}if(t=="function"){const n=e.name;return typeof n=="string"&&n.length>0?`Function(${n})`:"Function"}if(Array.isArray(e)){const n=e.length;let a="[";n>0&&(a+=re(e[0]));for(let u=1;u<n;u++)a+=", "+re(e[u]);return a+="]",a}const r=/\[object ([^\]]+)\]/.exec(toString.call(e));let i;if(!(r&&r.length>1))return toString.call(e);if(i=r[1],i=="Object")try{return"Object("+JSON.stringify(e)+")"}catch{return"Object"}return e instanceof Error?`${e.name}: ${e.message}
${e.stack}`:i}let P=null;function oe(){return(P===null||P.buffer.detached===!0||P.buffer.detached===void 0&&P.buffer!==M.memory.buffer)&&(P=new DataView(M.memory.buffer)),P}function ue(e,t){return(function(r,i){return se+=i,se>=ke&&(Z=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}),Z.decode(),se=i),Z.decode(F().subarray(r,r+i))})(e>>>=0,t)}let V=null;function F(){return V!==null&&V.byteLength!==0||(V=new Uint8Array(M.memory.buffer)),V}let Z=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});Z.decode();const ke=2146435072;let se=0;const X=new TextEncoder;"encodeInto"in X||(X.encodeInto=function(e,t){const r=X.encode(e);return t.set(r),{read:e.length,written:r.length}});let M,J=0;const E=1,T=2;try{await(async function(e){if(M!==void 0)return M;e!==void 0&&Object.getPrototypeOf(e)===Object.prototype&&({module_or_path:e}=e),e===void 0&&(e=new URL("/assets/slant_wasm_bg-ClG2qspD.wasm",import.meta.url));const t=$e();(typeof e=="string"||typeof Request=="function"&&e instanceof Request||typeof URL=="function"&&e instanceof URL)&&(e=fetch(e));const{instance:r}=await(async function(i,n){if(typeof Response=="function"&&i instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(i,n)}catch(u){if(!i.ok||!(function(p){switch(p){case"basic":case"cors":case"default":return!0}return!1})(i.type)||i.headers.get("Content-Type")==="application/wasm")throw u}const a=await i.arrayBuffer();return await WebAssembly.instantiate(a,n)}{const a=await WebAssembly.instantiate(i,n);return a instanceof WebAssembly.Instance?{instance:a,module:i}:a}})(await e,t);return(function(i){return M=i.exports,P=null,V=null,M.__wbindgen_start(),M})(r)})()}catch{}class ie{constructor(t){this.parent=Array.from({length:t},(r,i)=>i)}find(t){const r=this.parent[t];if(r===void 0)throw new Error("Index out of bounds");if(r!==t&&(this.parent[t]=this.find(r)),this.parent[t]===void 0)throw new Error("Parent undefined");return this.parent[t]}union(t,r){const i=this.find(t),n=this.find(r);return i!==n&&(this.parent[i]=n,!0)}connected(t,r){return this.find(t)===this.find(r)}}function O(e,t,r){return e*(r+1)+t}function K(e,t,r){const i=Array.from({length:t+1},()=>Array(r+1).fill(0));for(let n=0;n<t;n++){const a=e[n];if(a)for(let u=0;u<r;u++){const p=a[u];if(p===E){const f=i[n];if(f){const l=f[u+1];l!==void 0&&(f[u+1]=l+1)}const c=i[n+1];if(c){const l=c[u];l!==void 0&&(c[u]=l+1)}}else if(p===T){const f=i[n];if(f){const l=f[u];l!==void 0&&(f[u]=l+1)}const c=i[n+1];if(c){const l=c[u+1];l!==void 0&&(c[u+1]=l+1)}}}}return i}function Ee(e,t,r){var p,f,c,l;const i=Array.from({length:t},()=>Array(r).fill(0)),n=new ie((t+1)*(r+1));let a=!0;for(;a;){a=!1;for(let o=0;o<=t;o++)for(let d=0;d<=r;d++){const w=(p=e[o])==null?void 0:p[d];if(w==null)continue;const x=[{gr:o-1,gc:d-1,pt:T},{gr:o-1,gc:d,pt:E},{gr:o,gc:d-1,pt:E},{gr:o,gc:d,pt:T}].filter(({gr:_,gc:g})=>_>=0&&_<t&&g>=0&&g<r);let v=0;const y=[];for(const _ of x){const g=(f=i[_.gr])==null?void 0:f[_.gc];g===0?y.push(_):g===_.pt&&v++}if(v===w&&y.length>0)for(const{gr:_,gc:g,pt:b}of y){const S=i[_];if((S==null?void 0:S[g])===0){const I=b===E?T:E;S[g]=I,a=!0;const B=O(_,I===E?g+1:g,r),H=O(_+1,I===E?g:g+1,r);if(n.connected(B,H))return!1;n.union(B,H)}}else if(v+y.length===w&&y.length>0)for(const{gr:_,gc:g,pt:b}of y){const S=i[_];if((S==null?void 0:S[g])===0){S[g]=b,a=!0;const I=O(_,b===E?g+1:g,r),B=O(_+1,b===E?g:g+1,r);if(n.connected(I,B))return!1;n.union(I,B)}}}if(!a)for(let o=0;o<t;o++)for(let d=0;d<r;d++){const w=i[o];if((w==null?void 0:w[d])!==0)continue;const x=O(o,d+1,r),v=O(o+1,d,r),y=n.connected(x,v),_=O(o,d,r),g=O(o+1,d+1,r),b=n.connected(_,g);if(y&&b)return!1;y?(w[d]=T,a=!0,n.union(_,g)):b&&(w[d]=E,a=!0,n.union(x,v))}}if(!i.every(o=>o.every(d=>d!==0)))return!1;const u=K(i,t,r);for(let o=0;o<=t;o++)for(let d=0;d<=r;d++){const w=(c=e[o])==null?void 0:c[d];if(w!=null&&((l=u[o])==null?void 0:l[d])!==w)return!1}return!0}function fe(e,t,r,i){var f;const n=e.map(c=>[...c]),a=[];for(let c=0;c<=t;c++)for(let l=0;l<=r;l++)a.push({r:c,c:l});for(let c=a.length-1;c>0;c--){const l=Math.floor(Math.random()*(c+1)),o=a[c],d=a[l];o&&d&&(a[c]=d,a[l]=o)}const u=Math.floor((t+1)*(r+1)*i);let p=0;for(let c=0;c<=t;c++)for(let l=0;l<=r;l++)((f=n[c])==null?void 0:f[l])!==null&&p++;for(const{r:c,c:l}of a){if(p<=u)break;const o=n[c];if(!o)continue;const d=o[l];d!=null&&(o[l]=null,Ee(n,t,r)?p--:o[l]=d)}return n}function Ie(e,t){try{const n=BigInt(Math.floor(Math.random()*Number.MAX_SAFE_INTEGER)),a=(function(u,p,f,c){return M.generate_puzzle_wasm(u,p,f,c)})(e,t,n);return{numbers:fe(a.numbers,e,t,0),solution:a.solution}}catch{}let r=[],i=!1;for(let n=0;n<50&&!i;n++){r=Array.from({length:e},()=>Array(t).fill(0));const a=new ie((e+1)*(t+1)),u=[];for(let f=0;f<e;f++)for(let c=0;c<t;c++)u.push({r:f,c});for(let f=u.length-1;f>0;f--){const c=Math.floor(Math.random()*(f+1)),l=u[f],o=u[c];l&&o&&(u[f]=o,u[c]=l)}let p=!1;for(const{r:f,c}of u){const l=O(f,c+1,t),o=O(f+1,c,t),d=a.connected(l,o),w=O(f,c,t),x=O(f+1,c+1,t),v=a.connected(w,x);if(d&&v){p=!0;break}const y=r[f];y&&(d?(y[c]=T,a.union(w,x)):v||Math.random()<.5?(y[c]=E,a.union(l,o)):(y[c]=T,a.union(w,x)))}p||(i=!0)}return i||(r=Array.from({length:e},(n,a)=>Array(t).fill(a%2==0?E:T))),{numbers:fe(K(r,e,t).map(n=>n.map(a=>a)),e,t,0),solution:r}}const Re=Te({getInitialState:ge,customHandler:(e,t)=>{if(t.type==="toggle"){if(e.solved)return e;const{row:r,col:i}=t,n=e.grid.map(o=>[...o]),a=n[r];if(!a)return e;const u=a[i];if(u===void 0)return e;t.reverse?a[i]=u===0?T:u===T?E:0:a[i]=u===0?E:u===E?T:0;let p=!1;if(n.every(o=>o.every(d=>d!==0))){const o=K(n,e.rows,e.cols);e.numbers.every((d,w)=>d.every((x,v)=>{var y;return x==null||x===((y=o[w])==null?void 0:y[v])}))&&!(function(d,w,x){const v=new ie((w+1)*(x+1));for(let y=0;y<w;y++){const _=d[y];if(_)for(let g=0;g<x;g++){const b=_[g];if(b===void 0||b===0)continue;const S=O(y,b===E?g+1:g,x),I=O(y+1,b===E?g:g+1,x);if(!v.union(S,I))return!0}}return!1})(n,e.rows,e.cols)&&(p=!0)}const f=(function(o,d,w,x){var _,g;const v=new Set,y=K(o,w,x);for(let b=0;b<=w;b++)for(let S=0;S<=x;S++){const I=(_=d[b])==null?void 0:_[S];if(I==null)continue;const B=((g=y[b])==null?void 0:g[S])??0;B>I?v.add(`${String(b)},${String(S)}`):B+[{gr:b-1,gc:S-1},{gr:b-1,gc:S},{gr:b,gc:S-1},{gr:b,gc:S}].filter(({gr:H,gc:C})=>{var h;return H>=0&&H<w&&C>=0&&C<x&&((h=o[H])==null?void 0:h[C])===0}).length<I&&v.add(`${String(b)},${String(S)}`)}return v})(n,e.numbers,e.rows,e.cols),c=(function(o,d,w){var S,I,B,H;try{const C=new Uint8Array(d*w);for(let R=0;R<d;R++)for(let s=0;s<w;s++)C[R*w+s]=((S=o[R])==null?void 0:S[s])??0;const h=Ce(C,d,w);if(h.length>0)return new Set(h)}catch{}const x=new Map,v=new Set;for(let C=0;C<d;C++)for(let h=0;h<w;h++){const R=(I=o[C])==null?void 0:I[h];if(!R||R===0)continue;const s=O(C,R===E?h+1:h,w),m=O(C+1,R===E?h:h+1,w);x.has(s)||x.set(s,[]),x.has(m)||x.set(m,[]),(B=x.get(s))==null||B.push({node:m,r:C,c:h}),(H=x.get(m))==null||H.push({node:s,r:C,c:h})}const y=new Set,_=new Set,g=[],b=(C,h)=>{y.add(C),_.add(C);const R=x.get(C)??[];for(const{node:s,r:m,c:N}of R)if(s!==h)if(_.has(s)){v.add(`${String(m)},${String(N)}`);for(let j=g.length-1;j>=0;j--){const A=g[j];if(!A||(v.add(`${String(A.r)},${String(A.c)}`),A.u===s||A.v===s))break}}else y.has(s)||(g.push({r:m,c:N,u:C,v:s}),b(s,C),g.pop());_.delete(C)};for(const C of x.keys())y.has(C)||b(C,-1);return v})(n,e.rows,e.cols),l=(function(o,d,w,x){var _,g;const v=new Set,y=K(o,w,x);for(let b=0;b<=w;b++)for(let S=0;S<=x;S++){const I=(_=d[b])==null?void 0:_[S];I!=null&&(((g=y[b])==null?void 0:g[S])??0)===I&&v.add(`${String(b)},${String(S)}`)}return v})(n,e.numbers,e.rows,e.cols);return{...e,grid:n,solved:p,errorNodes:f,cycleCells:c,satisfiedNodes:l}}return e}});function ge(e,t){const{numbers:r,solution:i}=Ie(e,t);return{grid:Array.from({length:e},()=>Array(t).fill(0)),numbers:r,solution:i,rows:e,cols:t,solved:!1,errorNodes:new Set,cycleCells:new Set,satisfiedNodes:new Set}}const je=({rows:e,cols:t,numbers:r,size:i,initialMoves:n,onMove:a,onCopy:u,onClear:p,onClose:f})=>{const c=Ue("sm"),l=n,{getDragProps:o}=me({onToggle:(h,R,s,m,N)=>{const j=`${String(h)},${String(R)}`;if(!N)return void a(j,m);const A=l.get(j);let L;return L=s?A===T?E:A===E?void 0:T:A===E?T:A===T?void 0:E,a(j,L),L},touchTimeout:ne.timing.touchHoldDelay,checkEnabled:()=>!0}),[d,w]=z.useState(new Map),[x,v]=z.useState([]),[y,_]=z.useState(new Set),g=ze.useRef(null);z.useEffect(()=>{const h=new Worker(new URL("/assets/solverWorker-C3xbqNlV.js",import.meta.url),{type:"module"});return g.current=h,h.onmessage=R=>{const s=R.data;if(s.type==="RESULT"){const{gridState:m,conflicts:N,cycleCells:j}=s.payload;w(m),v(N),_(j)}},()=>{h.terminate()}},[]),z.useEffect(()=>{g.current&&g.current.postMessage({type:"SOLVE",payload:{rows:e,cols:t,numbers:r,userMoves:l}})},[l,r,e,t]);const b=.4*i,S=i-b,I=z.useMemo(()=>new Set(x.filter(h=>h.type==="cell").map(h=>`${String(h.r)},${String(h.c)}`)),[x]),B=z.useMemo(()=>new Set(x.filter(h=>h.type==="node").map(h=>`${String(h.r)},${String(h.c)}`)),[x]),H=z.useCallback((h,R)=>{const s=`${String(h)},${String(R)}`,m=d.get(s),N=(m==null?void 0:m.state)??0,j=m==null?void 0:m.source,A=I.has(s),L=y.has(s),U=o(s);let W=$.text.primary;return A?W=$.data.red:L?W=j==="user"?$.data.red:"#ff9800":j==="user"?W=$.primary.main:j==="propagated"&&(W=$.data.green),{...U,"data-pos":s,"data-type":"cell",sx:{...U.sx,cursor:"pointer",border:`1px solid ${G.BORDER}`,position:"relative",backgroundColor:G.BG_SUBTLE,"&:hover":{backgroundColor:G.BG_HOVER}},children:k.jsxs(D,{sx:{width:"100%",height:"100%",position:"relative"},children:[N===E&&k.jsx(D,{sx:{position:"absolute",width:ce,height:"6px",backgroundColor:W,borderRadius:be.borderRadius.full,top:"50%",left:"50%",transform:"translate(-50%, -50%) rotate(-45deg)",boxShadow:q.LINE,transition:ee.transition,pointerEvents:"none"}}),N===T&&k.jsx(D,{sx:{position:"absolute",width:ce,height:"6px",backgroundColor:W,borderRadius:be.borderRadius.full,top:"50%",left:"50%",transform:"translate(-50%, -50%) rotate(45deg)",boxShadow:q.LINE,transition:ee.transition,pointerEvents:"none"}})]})}},[d,I,y,o]),C=z.useCallback((h,R)=>{var N;const s=(N=r[h])==null?void 0:N[R],m=B.has(`${String(h)},${String(R)}`);return{"data-pos":`${String(h)},${String(R)}`,"data-type":"hint",children:k.jsx(D,{children:s??""}),sx:{borderRadius:"50%",backgroundColor:m?$.data.red:G.HINT_BG,border:s!=null?`2px solid ${m?$.data.red:G.HINT_BORDER}`:"none",fontSize:`${String(.5*b)}rem`,fontWeight:"800",color:m?de.WHITE:G.HINT_TEXT,zIndex:5,opacity:s!=null?1:0,display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",userSelect:"none",WebkitUserSelect:"none",transform:m?"scale(1.1)":"scale(1)",position:"relative",pointerEvents:"none"}}},[r,B,b]);return k.jsxs(D,{sx:{position:"relative",userSelect:"none"},children:[k.jsxs(D,{sx:{position:"relative",padding:c?`calc(${Q} + 16px)`:`calc(${Y} + 24px)`,border:`2px dashed ${G.DASHED_BORDER}`,borderRadius:le},children:[k.jsx(D,{sx:{position:"relative",zIndex:ae.zIndex.base+1},children:k.jsx(xe,{size:i,rows:e,cols:t,cellProps:H,space:0,sx:{width:"fit-content"}})}),k.jsx(D,{sx:{position:"absolute",top:c?`calc(${Q} + 16px)`:`calc(${Y} + 24px)`,left:c?`calc(${Q} + 16px)`:`calc(${Y} + 24px)`,transform:`translate(-${String(b/2)}rem, -${String(b/2)}rem)`,zIndex:ae.zIndex.base+2,pointerEvents:"none"},children:k.jsx(xe,{size:b,rows:e+1,cols:t+1,cellProps:C,space:S,sx:{width:"fit-content"}})})]}),k.jsxs(D,{sx:{display:"flex",justifyContent:"center",gap:2,position:"absolute",bottom:-90,left:0,right:0,pointerEvents:"auto",zIndex:ae.zIndex.base+5,paddingBottom:2},children:[k.jsx(te,{title:"Copy Board",Icon:Ge,onClick:u,sx:{backgroundColor:$.interactive.selected,color:$.primary.main,"&:hover":{backgroundColor:$.interactive.focus}}}),k.jsx(te,{title:"Clear Calculator",Icon:Pe,onClick:p,sx:{backgroundColor:"rgba(255, 68, 68, 0.1)",color:$.data.red,"&:hover":{backgroundColor:"rgba(255, 68, 68, 0.2)"}}}),k.jsx(te,{title:"Close Calculator",Icon:qe,onClick:f,sx:{backgroundColor:"rgba(255, 193, 7, 0.1)",color:$.data.amber,"&:hover":{backgroundColor:"rgba(255, 193, 7, 0.2)"}}})]})]})},Ne=(e,t,r)=>(i,n)=>{var c;const a=(c=t.grid[i])==null?void 0:c[n],u=we(i,n),p=t.cycleCells.has(u),f=e(u);return{...f,sx:{...f.sx,cursor:"pointer",border:`1px solid ${$.border.subtle}`,position:"relative","&:hover":{backgroundColor:$.interactive.hover}},children:k.jsxs(D,{sx:{width:"100%",height:"100%",position:"relative"},children:[a===E&&k.jsx(D,{sx:{position:"absolute",width:"115%",height:`${String(Math.max(2,r))}px`,backgroundColor:p?$.data.red:$.text.primary,borderRadius:"99px",top:"50%",left:"50%",transform:"translate(-50%, -50%) rotate(-45deg)",boxShadow:q.LINE,transition:ee.transition,pointerEvents:"none"}}),a===T&&k.jsx(D,{sx:{position:"absolute",width:"115%",height:`${String(Math.max(2,r))}px`,backgroundColor:p?$.data.red:$.text.primary,borderRadius:"99px",top:"50%",left:"50%",transform:"translate(-50%, -50%) rotate(45deg)",boxShadow:q.LINE,transition:ee.transition,pointerEvents:"none"}})]})}};ye=function(){const[e,t]=z.useState(!1),{rows:r,cols:i,state:n,dispatch:a,size:u,mobile:p,handleNext:f,controlsProps:c}=Oe({storageKeys:{size:_e,state:Se},pageTitle:he.slant,gridConfig:{defaultSize:5,minSize:3,headerOffset:ne.layout.headerHeight,paddingOffset:160,widthLimit:1e3,cellSizeReference:4,mobileRowOffset:-2},boardConfig:{paddingOffset:s=>({x:s?32:224,y:100}),boardMaxWidth:1200,boardSizeFactor:.98,maxCellSize:100,remBase:16,rowOffset:1,colOffset:1},reducer:Re,getInitialState:(s,m)=>ge(s,m),winAnimationDelay:ne.timing.winAnimationDelay,isSolved:s=>s.solved,persistence:{enabled:!e,serialize:s=>({...s,errorNodes:Array.from(s.errorNodes),cycleCells:Array.from(s.cycleCells),satisfiedNodes:Array.from(s.satisfiedNodes)}),deserialize:s=>{const m=s;return{...m,errorNodes:new Set(m.errorNodes),cycleCells:new Set(m.cycleCells),satisfiedNodes:new Set(m.satisfiedNodes)}}}}),[l,o]=z.useState(new Map);Be({storageKey:ve,rows:r,cols:i,state:l,onRestore:s=>{o(s)},serialize:s=>Array.from(s.entries()),deserialize:s=>new Map(s)});const d=z.useRef("");z.useEffect(()=>{const s=JSON.stringify(n.numbers);d.current&&d.current!==s&&o(new Map),d.current=s},[n.numbers,n.rows,n.cols]);const w=f,{getDragProps:x}=me({onToggle:(s,m,N)=>{a({type:"toggle",row:s,col:m,reverse:N})},checkEnabled:()=>!n.solved,touchTimeout:ne.timing.touchHoldDelay}),v=.4*u,y=De(Ne,x,[n,u]),_=z.useMemo(()=>((s,m)=>(N,j)=>{var pe;const A=(pe=s.numbers[N])==null?void 0:pe[j],L=we(N,j),U=s.errorNodes.has(L),W=s.satisfiedNodes.has(L);return{sx:{pointerEvents:"none"},children:k.jsx(D,{sx:{borderRadius:"50%",backgroundColor:U?$.data.red:$.surface.background,border:A!=null?`2px solid ${U?$.data.red:W?"transparent":$.border.subtle}`:"none",fontSize:`${String(.5*m)}rem`,fontWeight:"800",color:U?de.WHITE:W?$.interactive.disabledText:$.text.primary,boxShadow:W&&!U?"none":q.HINT,zIndex:5,opacity:A!=null?1:0,display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",userSelect:"none",WebkitUserSelect:"none",transform:U?"scale(1.1)":"scale(1)",width:`${String(m)}rem`,height:`${String(m)}rem`},children:A??""})}})(n,v),[n,v]),g=z.useCallback((s,m)=>{o(N=>{const j=new Map(N);return m===void 0?j.delete(s):j.set(s,m),j})},[]),b=z.useCallback(()=>{const s=new Map;n.grid.forEach((m,N)=>{m.forEach((j,A)=>{j!==0&&s.set(`${String(N)},${String(A)}`,j)})}),o(s)},[n.grid]),S=z.useCallback(()=>{o(new Map)},[]),I=z.useCallback(()=>{t(!1)},[]),B=z.useCallback(s=>{s.stopPropagation()},[]),H=z.useMemo(()=>({background:`radial-gradient(circle at 50% 50%, ${$.surface.elevated} 0%, ${$.surface.background} 100%)`,padding:p?"1rem":"2rem"}),[p]),C=z.useMemo(()=>({userSelect:"none",padding:p?Q:Y,border:"2px solid transparent",borderRadius:le}),[p]),h=e?k.jsx(k.Fragment,{}):k.jsx(We,{...c,disabled:e,children:k.jsx(te,{title:"Open Calculator",Icon:Ve,onClick:()=>{t(!e)},sx:{color:"default"}})}),R=e?k.jsx(je,{rows:r,cols:i,numbers:n.numbers,size:u,initialMoves:l,onMove:g,onCopy:b,onClear:S,onClose:I}):k.jsx(Le,{size:u,rows:r+1,cols:i+1,frontProps:_,backProps:y,frontLayerSx:{pointerEvents:"none"}});return k.jsx(He,{title:he.slant,infoUrl:"https://en.wikipedia.org/wiki/Gokigen_Naname",paddingBottom:{xs:"180px",md:"150px"},controls:h,contentSx:H,showTrophy:!e&&n.solved,onReset:w,boardSize:u,iconSizeRatio:.8,primaryColor:$.primary.main,secondaryColor:$.primary.main,boardSx:C,children:k.jsx(D,{onClick:B,children:R})})}});export{Fe as __tla,ye as default};
