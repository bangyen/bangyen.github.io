import{r as l,j as k}from"./vendor_react-BC_ZxTUy.js";import{p as C}from"./pako.esm-D0myxAWH.js";import{a as i,R as P}from"./ResearchDemo-Cn0t1R0-.js";import{d as R,a as c,U as D}from"./index-DOijtkVn.js";import{h as T,T as B,i as H}from"./vendor_mui_icons-DNj8xVz8.js";import"./GlassCard-B_s2Hefr.js";import"./vendor_mui_core-D6ruIU1t.js";import"./GlobalHeader-DhcZv4Lq.js";import"./vendor_recharts-B8VboSh7.js";const b=(r,e,o,u,n,d)=>{if(r.length===0)return S();const p=r.filter(t=>t.num_firms===e&&t.model_type===o&&t.demand_elasticity===u&&t.base_price===n&&t.collusion_enabled===d);return p.length===0?r.filter(t=>t.num_firms===e&&t.model_type===o).sort((t,s)=>t.round-s.round).slice(0,i.oligopoly.maxRounds):p.sort((t,s)=>t.round-s.round).slice(0,15)},S=()=>{const r=[];for(let e=1;e<=i.oligopoly.maxRounds;e++){const o=i.oligopoly.simulation;r.push({round:e,price:o.fallbackPrice+Math.sin(e*o.priceFrequency)*o.priceAmplitude,hhi:o.fallbackHHI+Math.sin(e*o.hhiFrequency)*o.hhiAmplitude,collusion:e>o.collusionStart&&e<o.collusionEnd})}return r},I=()=>{const[r,e]=l.useState(i.oligopoly.defaultFirms),[o,u]=l.useState(i.oligopoly.defaultElasticity),[n,d]=l.useState(i.oligopoly.defaultBasePrice),[p,t]=l.useState([]),[s,M]=l.useState([]),[w,x]=l.useState(!0),m=i.modelTypes.cournot,y=!1;l.useEffect(()=>{document.title=R.oligopoly,(async()=>{x(!0);try{const a=await(async()=>{try{const f=await fetch("/oligopoly_data.json.gz");if(!f.ok)throw new Error(`HTTP error! status: ${f.status.toString()} - Failed to load Oligopoly data`);const F=await f.arrayBuffer(),h=new Uint8Array(F),$=h[0]===31&&h[1]===139?C.ungzip(h,{to:"string"}):new TextDecoder().decode(F),A=JSON.parse($);if(!Array.isArray(A))throw new Error("Invalid data format: expected array");return A}catch{return[]}})();M(a);const g=b(a,r,m,o,n,y);t(g)}catch{t(S())}finally{x(!1)}})()},[r,o,n,y,m]),l.useEffect(()=>{if(s.length>0){const a=b(s,r,m,o,n,y);t(a)}},[r,o,n,s,m,y]);const E=[{label:"Number of Firms",icon:T,color:c.primary.main,value:r,onChange:e,options:i.oligopoly.options.firms},{label:"Demand Elasticity",icon:B,color:c.data.green,value:o,onChange:u,options:i.oligopoly.options.elasticity},{label:"Base Price",icon:H,color:c.data.amber,value:n,onChange:d,options:i.oligopoly.options.price}],_={type:"line",xAxisKey:"round",yAxisFormatter:a=>`$${a.toFixed(2)}`,yAxisDomain:["dataMin - 5","dataMax + 5"],dualYAxis:!0,rightYAxisFormatter:a=>a.toFixed(2),rightYAxisDomain:[`dataMin - ${String(i.oligopoly.simulation.hhiFrequency)}`,`dataMax + ${String(i.oligopoly.simulation.hhiFrequency)}`],tooltipLabelFormatter:a=>`Round ${a.toString()}`,tooltipFormatter:(a,g)=>[g==="Market Price"?`$${a.toFixed(2)}`:a.toFixed(2),g],lines:[{dataKey:"price",name:"Market Price",color:c.primary.main,yAxisId:"left"},{dataKey:"hhi",name:"HHI Concentration",color:c.data.amber,yAxisId:"right"}]};return k.jsx(P,{title:"Oligopoly",subtitle:"Agent-Based Economic Competition Analysis",githubUrl:D.oligopolyRepo,chartData:p,chartConfig:_,chartTitle:"Market Dynamics",controls:E,loading:w,loadingMessage:"Loading Cournot simulation data...",onReset:()=>{e(i.oligopoly.defaultFirms),u(i.oligopoly.defaultElasticity),d(i.oligopoly.defaultBasePrice)},resetLabel:"Reset"})};export{I as default};
