import{j as r}from"./vendor_react-CiGj4Onb.js";import{B as d,e as p,G as f,d as u,w as U,x as F,u as W}from"./vendor_mui_core-Cb6gYFA4.js";import{c as S,a as e,A as v,T as h,S as c,E as Y,C as G}from"./index-CB166san.js";import{R as P,q as H}from"./vendor_mui_icons-88WVDz42.js";import{G as k}from"./GlassCard-ZVr2Az-J.js";import{R as V,L as $,C as K,X as Z,Y as j,T as q,a as X}from"./vendor_recharts-C7iXNUB1.js";import{P as J}from"./PageLayout-D4KkK3P1.js";const Q={oligopoly:{defaultFirms:3,defaultElasticity:2,defaultBasePrice:40,maxRounds:15,simulation:{fallbackPrice:20,fallbackHHI:.3,collusionStart:6,collusionEnd:10,priceAmplitude:5,hhiAmplitude:.1,priceFrequency:.3,hhiFrequency:.1},options:{firms:[{value:2,label:"2"},{value:3,label:"3"},{value:4,label:"4"},{value:5,label:"5"}],elasticity:[{value:1.5,label:"1.5"},{value:2,label:"2.0"},{value:2.5,label:"2.5"}],price:[{value:30,label:"$30"},{value:40,label:"$40"},{value:50,label:"$50"}]}},zsharp:{baseAccuracy:.65,maxAccuracy:.75,baseLoss:2,minLoss:.8,improvement:.05,lossReduction:.1,maxEpochs:20,yAxisPadding:.05,lossPadding:.1,gapPadding:.005,convergencePadding:.005},lightsOut:{yAxisMax:70},modelTypes:{cournot:"cournot"}},E=300,ee=4,re=3,C={strokeDashArray:"3 3",defaultStrokeWidth:2},te={multiplier:100,divisor:100},s={GLASS:{VERY_SUBTLE:"var(--glass-very-subtle)",SUBTLE:"var(--glass-subtle)",TRANSPARENT:"var(--glass-transparent)",SLIGHT:"var(--glass-slight)",MEDIUM:"var(--glass-medium)",DARK:"var(--glass-dark)"},CYAN:{BG_SUBTLE:"var(--research-cyan-bg)",BORDER_SUBTLE:"var(--research-cyan-border)"},GREEN:{BG_SUBTLE:"var(--research-green-bg)",BORDER_SUBTLE:"var(--research-green-border)",HOVER:"hsl(141, 64%, 39%)"},AMBER:{HOVER:"hsl(34, 95%, 48%)"},BORDER:{VERY_SUBTLE:"var(--research-border-very-subtle)",SUBTLE:"var(--research-border-subtle)"},LAYOUT:{BUTTON_HEIGHT:"36.5px",CONTROLS_SPACING:2.5,RESULT_CARD_HEIGHT:480,INNER_PADDING:"1rem",INNER_PADDING_SM:"0.6rem 0.8rem",FONT_SIZE_XS:"0.75rem",FONT_SIZE_SM:"0.85rem",FONT_SIZE_MD:"0.95rem",CARD_RADIUS:"6px"},ANIMATIONS:{SPIN:{animation:"spin 1s linear infinite","@keyframes spin":{"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}}}}},ie=({viewTypes:n,currentViewType:i,onViewTypeChange:l})=>n.length<=1?null:r.jsx(d,{sx:{marginBottom:3,width:"100%",boxSizing:"border-box"},children:r.jsx(d,{sx:{display:"grid",gridTemplateColumns:{xs:"repeat(2, minmax(0, 1fr))",md:`repeat(${Math.min(n.length,4).toString()}, 1fr)`},gap:1.5,width:"100%",margin:0},children:n.map(t=>{const x=t.icon;return r.jsx(p,{variant:"outlined",size:"small",startIcon:r.jsx(x,{}),onClick:()=>{l(t.key)},sx:{width:"100%",color:i===t.key?"inherit":e.text.secondary,backgroundColor:i===t.key?e.primary.main:e.surface.elevated,"&.MuiButton-root":{color:i===t.key?e.text.primary:e.text.secondary},borderColor:e.border.subtle,borderWidth:"1px",borderStyle:"solid",borderRadius:c.borderRadius.lg,minHeight:s.LAYOUT.BUTTON_HEIGHT,padding:s.LAYOUT.INNER_PADDING_SM,fontSize:s.LAYOUT.FONT_SIZE_SM,fontWeight:h.fontWeight.medium,transition:v.transitions.standard,"&:hover":{backgroundColor:i===t.key?e.primary.dark:e.interactive.hover,transform:"translateY(-1px)",boxShadow:S.sm}},children:t.label},t.key)})})}),oe=({controls:n,onReset:i,resetLabel:l="Reset"})=>n.length===0?null:r.jsxs(d,{sx:{marginBottom:0,width:"100%",boxSizing:"border-box",paddingBottom:c.padding.md},children:[i&&r.jsx(d,{sx:{display:"flex",justifyContent:"flex-end",alignItems:"center",mb:s.LAYOUT.CONTROLS_SPACING},children:r.jsx(p,{variant:"outlined",size:"small",startIcon:r.jsx(P,{}),onClick:i,sx:{color:e.text.secondary,borderColor:e.border.subtle,borderRadius:c.borderRadius.lg,px:2,py:.5,fontSize:s.LAYOUT.FONT_SIZE_MD,fontWeight:h.fontWeight.medium,transition:v.transitions.standard,"&:hover":{borderColor:e.primary.main,backgroundColor:e.interactive.hover,transform:"translateY(-1px)",boxShadow:S.sm}},children:l})}),r.jsx(f,{container:!0,spacing:s.LAYOUT.CONTROLS_SPACING,children:n.map((t,x)=>r.jsx(f,{size:{xs:12,md:4},children:r.jsxs(d,{sx:{marginBottom:0,padding:s.LAYOUT.INNER_PADDING,backgroundColor:e.interactive.disabled,borderRadius:c.borderRadius.lg,border:`1px solid ${e.border.subtle}`},children:[r.jsxs(d,{sx:{display:"flex",alignItems:"center",gap:1,mb:2},children:[t.icon&&r.jsx(t.icon,{sx:{color:t.color??e.primary.light,fontSize:"1.1rem"}}),r.jsx(u,{variant:"body2",sx:{color:e.text.secondary,fontWeight:h.fontWeight.medium},children:t.label})]}),r.jsx(U,{value:t.value,exclusive:!0,onChange:(a,o)=>{o!==null&&t.onChange(o)},size:"small",sx:{width:"100%",borderRadius:c.borderRadius.lg,overflow:"hidden",border:`1px solid ${e.border.subtle}`,"& .MuiToggleButtonGroup-grouped":{margin:0,border:0,borderRadius:0,"&:not(:first-of-type)":{borderLeft:`1px solid ${e.border.subtle}`}},"& .MuiToggleButton-root":{color:e.text.secondary,borderColor:e.border.subtle,padding:s.LAYOUT.INNER_PADDING_SM,flex:1,fontSize:s.LAYOUT.FONT_SIZE_MD,fontWeight:h.fontWeight.medium,borderRadius:0,transition:v.transitions.standard,"&.Mui-selected":{backgroundColor:t.color??e.primary.main,color:e.text.primary,borderColor:t.color??e.primary.main,"&:hover":{backgroundColor:t.hoverColor??(t.color===e.primary.main?e.primary.dark:t.color===e.data.green?s.GREEN.HOVER:t.color===e.data.amber?s.AMBER.HOVER:t.color??e.primary.dark),borderColor:t.hoverColor??(t.color===e.primary.main?e.primary.dark:t.color===e.data.green?s.GREEN.HOVER:t.color===e.data.amber?s.AMBER.HOVER:t.color??e.primary.dark),transform:"translateY(-1px)",boxShadow:S.sm}}},"&:hover":{backgroundColor:e.interactive.hover,transform:"translateY(-1px)"}},children:t.options.map(a=>r.jsx(F,{value:a.value,children:a.label},a.value))})]})},t.label||x))})]});function ae({currentData:n,currentChartConfig:i,loading:l,loadingMessage:t,chartTitle:x,isMobile:a}){return r.jsxs(k,{sx:{marginBottom:3,width:"100%",boxSizing:"border-box",overflow:"hidden"},children:[r.jsx(u,{variant:"subtitle1",sx:{color:e.text.secondary,marginBottom:2,textAlign:"center",fontWeight:h.fontWeight.medium,fontSize:h.fontSize.subheading},children:x}),r.jsx(d,{sx:{height:E,width:"100%",position:"relative"},children:l?r.jsx(d,{sx:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:e.text.secondary},children:r.jsx(u,{children:t})}):r.jsx(V,{width:"100%",height:E,minWidth:0,minHeight:0,debounce:1,children:r.jsxs($,{data:n,children:[r.jsx(K,{strokeDasharray:C.strokeDashArray,stroke:e.border.subtle,vertical:!1}),r.jsx(Z,{dataKey:i.xAxisKey,stroke:e.text.secondary,tick:{fill:e.text.secondary,fontSize:10},axisLine:{stroke:e.border.subtle},tickLine:!1}),r.jsx(j,{yAxisId:"left",hide:a,stroke:e.text.secondary,tick:{fill:e.text.secondary,fontSize:10},axisLine:!1,tickLine:!1,tickFormatter:i.yAxisFormatter,domain:i.yAxisDomain}),i.dualYAxis&&r.jsx(j,{yAxisId:"right",orientation:"right",hide:a,stroke:e.text.secondary,tick:{fill:e.text.secondary,fontSize:10},axisLine:!1,tickLine:!1,tickFormatter:i.rightYAxisFormatter,domain:i.rightYAxisDomain}),r.jsx(q,{contentStyle:{backgroundColor:e.surface.glass,backdropFilter:"blur(8px) saturate(180%)",border:`1px solid ${e.border.subtle}`,borderRadius:c.borderRadius.md,color:e.text.primary,boxShadow:"none"},itemStyle:{fontSize:"12px",padding:"2px 0"},labelStyle:{fontWeight:"bold",marginBottom:"4px",color:e.text.primary},labelFormatter:i.tooltipLabelFormatter,formatter:(o,b)=>{if(o===void 0)throw new Error("Value is undefined");if(b===void 0)throw new Error("Name is undefined");return i.tooltipFormatter(o,b)}}),i.lines.map(o=>r.jsx(X,{yAxisId:o.yAxisId??"left",type:"monotone",dataKey:o.dataKey,stroke:o.color,strokeWidth:re,name:o.name,dot:{fill:o.color,strokeWidth:C.defaultStrokeWidth,r:ee}},o.dataKey))]})})})]})}function ne({title:n,subtitle:i,backUrl:l,isMobile:t}){const x=o=>r.jsx(p,{component:"a",href:`#${l??""}`,startIcon:r.jsx(H,{}),size:"small",sx:{color:e.text.secondary,padding:0,minWidth:0,"&:hover":{backgroundColor:"transparent",color:e.primary.main},marginBottom:o,alignSelf:{xs:"center",sm:"flex-end"},textTransform:"none",fontSize:"0.8rem"},children:"Back to Simulation"});let a;return a=l&&t?x(0):r.jsx(u,{variant:"h5",sx:{color:e.text.secondary,fontSize:h.fontSize.subheading,textAlign:{xs:"center",md:"right"},whiteSpace:{xs:"normal",md:"nowrap"},display:{xs:"none",sm:"block"}},children:i}),r.jsxs(d,{sx:{display:"flex",flexDirection:"column",alignItems:{xs:"center",md:"flex-start"},gap:2,marginBottom:{xs:3,md:4},width:"100%"},children:[l&&!t&&x(-2),r.jsxs(d,{sx:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:{xs:"center",md:"baseline"},width:"100%"},children:[r.jsx(u,{variant:"h1",sx:{color:e.text.primary,fontWeight:h.fontWeight.bold,fontSize:h.fontSize.h2,textAlign:{xs:"center",md:"left"}},children:n}),a]})]})}const se=({children:n})=>r.jsx(Y,{FallbackComponent:({error:i,resetErrorBoundary:l})=>r.jsx(d,{sx:{display:"flex",justifyContent:"center",alignItems:"center",p:4,minHeight:"300px"},children:r.jsxs(k,{sx:{p:4,maxWidth:"500px",textAlign:"center"},children:[r.jsx(u,{variant:"h5",sx:{mb:2,color:e.text.primary,fontWeight:"bold"},children:"Research Tool Error"}),r.jsx(u,{sx:{mb:3,color:e.text.secondary,fontFamily:"monospace",fontSize:"0.9rem"},children:(i==null?void 0:i.message)??"An unexpected error occurred."}),r.jsx(p,{variant:"contained",onClick:l,sx:{borderRadius:c.borderRadius.md,textTransform:"none"},children:"Reset Component"})]})}),children:n}),le=({title:n,subtitle:i,githubUrl:l,chartData:t=[],chartConfig:x={type:"line",lines:[],xAxisKey:"x",yAxisFormatter:m=>m.toFixed(2),yAxisDomain:["dataMin - 0.05","dataMax + 0.05"],dualYAxis:!1,rightYAxisFormatter:m=>m.toFixed(2),rightYAxisDomain:["dataMin - 0.05","dataMax + 0.05"],tooltipLabelFormatter:m=>`Round ${String(m)}`,tooltipFormatter:(m,y)=>[m.toFixed(2),y]},viewTypes:a=[],currentViewType:o="default",onViewTypeChange:b=()=>{},controls:I=[],loading:w=!1,loadingMessage:L="Loading data...",onReset:N,resetLabel:D="Reset",chartTitle:B=null,children:O,backUrl:_})=>{var R,T;const m=(()=>{if(t.length===0)return[];if(!a.length)return t;const g=a.find(M=>M.key===o);return g!=null&&g.dataProcessor?g.dataProcessor(t):t})(),y=((R=a.find(g=>g.key===o))==null?void 0:R.chartConfig)??x,A=W("(max-width:600px)"),z=B??(a.length>0?((T=a.find(g=>g.key===o))==null?void 0:T.chartTitle)??"Data Visualization":"Data Visualization");return r.jsx(se,{children:r.jsx(J,{githubUrl:l,children:r.jsx(f,{container:!0,flex:1,flexDirection:"column",sx:{position:"relative",padding:c.padding.md,paddingTop:c.padding.xl,paddingBottom:{xs:c.padding.md,md:0},boxSizing:"border-box",width:"100%",maxWidth:"100vw",overflowX:"hidden"},children:r.jsx(f,{size:{xs:12},flex:1,sx:{...G.flexCenter,flexDirection:"column",zIndex:1,padding:0,minHeight:0},children:r.jsxs(d,{sx:{textAlign:"center",maxWidth:c.maxWidth.md,width:"100%",padding:{xs:"0 0.5rem",md:"0 2rem"},boxSizing:"border-box",overflow:"hidden"},children:[r.jsx(ne,{title:n,subtitle:i,backUrl:_,isMobile:A}),r.jsx(ae,{currentData:m,currentChartConfig:y,loading:w,loadingMessage:L,chartTitle:z,isMobile:A}),r.jsx(ie,{viewTypes:a,currentViewType:o,onViewTypeChange:b}),r.jsx(oe,{controls:I,onReset:N,resetLabel:D}),O]})})})})})};export{te as P,le as R,Q as a,s as b};
