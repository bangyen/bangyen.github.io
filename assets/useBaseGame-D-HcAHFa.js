import{r as e,j as t,a as n}from"./vendor_react-De-BR_RD.js";import{g as i,G as o,T as s,a as r,L as a,S as l,c,A as d,R as u,b as f,d as m,C as x,u as h}from"./index-DK0g0Heo.js";import{B as p,P as g,G as b,T as S,M as w,h as y,I as z,d as v}from"./vendor_mui_core-K-vIj0S5.js";import{f as j,A as C,M as I,E as O,d as D,g as M,h as R}from"./vendor_mui_icons-CuOnxl2z.js";import{P as k,t as E}from"./PageLayout-ClJ4BSWn.js";import{a as P,u as T}from"./layout-7S8-lW6h.js";const A=e.memo(function({size:n,children:i,...a}){const l=`${n.toString()}rem`,c=`${(n/o.cellSize.divisor).toString()}rem`,{backgroundColor:d,color:u,boxShadow:f,border:m,opacity:x,transition:h=!0,sx:g,...b}=a,S=!1===h?"none":"string"==typeof h?h:"background-color 200ms ease, color 200ms ease, opacity 200ms ease, transform 200ms ease, border-radius 200ms ease",w=e.useMemo(()=>({...r.flexCenter,borderRadius:c,height:l,width:l,fontSize:`${(n*o.cellSize.fontSizeMultiplier).toString()}rem`,fontWeight:s.fontWeight.semibold,fontFamily:"monospace"}),[c,l,n]);return t.jsx(p,{role:"gridcell",...w,...b,sx:{backgroundColor:d,color:u,boxShadow:f,border:m,opacity:x,transition:S,...g},children:i})}),L=e.memo(function({cols:n,size:i,index:o,spacing:s,cellProps:r}){return t.jsx(p,{role:"row",sx:{display:"flex",gap:s,justifyContent:"center"},children:Array.from({length:n},(t,n)=>e.createElement(A,{...r(o,n),key:`${o.toString()}_${n.toString()}`,size:i}))})}),$=e.memo(function({size:e,rows:n,cols:o,cellProps:s,space:r,sx:a,...l}){const c=i(e),d=`${(r??c).toString()}rem`;return t.jsx(p,{role:"grid","aria-label":`Grid with ${n.toString()} rows and ${o.toString()} columns`,sx:{display:"flex",flexDirection:"column",alignItems:"center",gap:d,...a},...l,children:Array.from({length:n},(n,i)=>t.jsx(L,{index:i,cols:o,size:e,spacing:d,cellProps:s},`row_${i.toString()}`))})}),W=n.memo(function(e){const{overlayProps:n,cellProps:i,size:o,rows:s,cols:r,cellRows:l=s,cellCols:c=r,overlayLayerSx:d,cellLayerSx:u}=e,f=d&&"pointerEvents"in d&&"none"===d.pointerEvents,m=u&&"pointerEvents"in u&&"none"===u.pointerEvents;return t.jsxs(p,{sx:{display:"grid",placeItems:"center"},children:[t.jsx(p,{sx:{gridArea:"1/1",...u},children:t.jsx($,{space:0,size:o,rows:l,cols:c,cellProps:i,...m?{role:"presentation","aria-hidden":!0}:{}})}),t.jsx(p,{sx:{gridArea:"1/1",zIndex:a.zIndex.base+1,...d},children:t.jsx($,{space:0,size:o,rows:s,cols:r,cellProps:n,...f?{role:"presentation","aria-hidden":!0}:{}})})]})});function B({children:e,...n}){return t.jsx(g,{elevation:0,component:"nav",role:"navigation","aria-label":"Game controls navigation",onClick:e=>{e.stopPropagation()},sx:{transform:"translateX(-50%)",position:"absolute",bottom:l.padding.xl,left:"50%",zIndex:a.zIndex.navigation,...d.presets.glass,borderRadius:l.borderRadius.lg,boxShadow:c.lg,padding:`${l.padding.sm} ${l.padding.lg}`,...n},children:t.jsx(b,{container:!0,spacing:2,sx:{...r.flexCenter,flexWrap:"nowrap",minWidth:0},children:e})})}const N=n.memo(function({rows:e,cols:n,dynamicSize:i,minSize:o,maxSize:s,handlePlus:r,handleMinus:a,onRefresh:l,disabled:c=!1,onOpenInfo:d,hidden:m=!1,children:x}){if(m)return null;const h=Math.min(e,n)<=o,p=Math.min(e,n)>=s||Math.min(e,n)>=Math.min(i.rows,i.cols);return t.jsxs(B,{children:[t.jsx(u,{onClick:l}),t.jsx(f,{title:"Decrease Size",Icon:j,onClick:a,disabled:c||h}),t.jsx(f,{title:"Increase Size",Icon:C,onClick:r,disabled:c||p}),d&&t.jsx(f,{title:"How to Play",Icon:I,onClick:d}),x]})});function H({show:e=!1,onReset:n,size:i=0,iconSizeRatio:o=1,primaryColor:s=x.primary.main,secondaryColor:r=x.primary.main,useSecondary:a=!1,showLabel:c=!0}){const d=a?r:s;return t.jsx(p,{sx:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",opacity:e?1:0,transform:e?"scale(1)":"scale(0.5)",visibility:e?"visible":"hidden",transition:"all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1)",zIndex:10,backgroundColor:"transparent",pointerEvents:"none"},children:i>0&&t.jsxs(m,{padding:l.padding.md,sx:{display:"flex",flexDirection:"column",alignItems:"center",gap:1.5,height:"auto",width:"auto",maxWidth:"80%"},children:[t.jsx(O,{sx:{fontSize:`${(i*o*.6).toString()}rem`,color:d,filter:"drop-shadow(0 4px 12px rgba(0,0,0,0.1))"}}),c&&t.jsx(S,{variant:"h6",sx:{color:x.text.primary,fontWeight:600,letterSpacing:"0.02em"},children:"Solved!"})]})})}const _={gridSizes:{mobile:2.5,desktop:4},timing:{winAnimationDelay:2e3,interactionDelay:500,touchHoldDelay:500},layout:{headerHeight:{mobile:64,desktop:80}}},F={PADDING:{MOBILE:"30px",DESKTOP:"36px"},BORDER_RADIUS:"24px",BORDER:"2px solid transparent",SHADOW:"0 2px 4px rgba(0,0,0,0.2)",DROP_SHADOW:"drop-shadow(0 2px 4px rgba(0,0,0,0.2))"};function G(e){return{SIZE:`${e}-size`,STATE:`${e}-state`}}const K={paddingOffset:0,boardMaxWidth:1200,boardSizeFactor:.94,maxCellSize:80,remBase:16},U={defaultSize:null,minSize:3,maxSize:10,mobileRowOffset:2,headerOffset:_.layout.headerHeight,paddingOffset:0,widthLimit:1300,cellSizeReference:{mobile:_.gridSizes.mobile,desktop:_.gridSizes.desktop}};function J({children:e,controls:n,infoUrl:i,title:o,background:s=x.surface.background,paddingBottom:r={xs:"80px",md:"120px"},contentSx:a={},trophyProps:l={},boardSx:c,onClick:d}){return t.jsxs(k,{title:o,infoUrl:i,background:s,containerSx:{height:"100vh",transition:"background 0.5s ease-in-out",cursor:d?"pointer":"inherit"},sx:{justifyContent:"center",alignItems:"center"},onClick:d,children:[t.jsx(p,{sx:[{flex:1,position:"relative",width:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",overflow:"hidden",pb:r},...E(a)],children:t.jsxs(p,{sx:[{position:"relative",width:"fit-content",userSelect:"none",padding:{xs:F.PADDING.MOBILE,sm:F.PADDING.DESKTOP},borderRadius:F.BORDER_RADIUS,border:F.BORDER},...E(c)],children:[e,t.jsx(H,{...l})]})}),n]})}function X(e,t){return`${e.toString()},${t.toString()}`}function Y(e){return(t,n)=>{if(e.customHandler){const i=e.customHandler(t,n);if(i!==t)return i}switch(n.type){case"resize":if("newRows"in n||"rows"in n||"cols"in n){const i=n.newRows??n.rows??t.rows,o=n.newCols??n.cols??t.cols;return i===t.rows&&o===t.cols?t:e.getInitialState(i,o)}return t;case"new":case"next":case"reset":return e.getInitialState(t.rows,t.cols);case"restore":case"hydrate":return"state"in n?n.state:t;default:return t}}}function Z(t,n,i){return e.useMemo(()=>t(n,...i),[t,n,i])}const q=e=>{if(e<1||e>100)throw new Error("Invalid grid size: must be between 1 and 100");return e},Q=e=>{if(e<0)throw new Error("Invalid cell index: cannot be negative");return e};function V(t){const n=e.useRef(t);return n.current=t,e.useCallback((...e)=>n.current(...e),[])}const ee={backgroundColor:e=>"dark"===e.palette.mode?"hsla(0, 0%, 3%, 0.85)":"hsla(0, 0%, 98%, 0.85)",backdropFilter:"blur(12px) saturate(180%)",transition:"all 0.3s ease-in-out !important"},te={zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},ne={outline:"none",display:"flex",justifyContent:"center",alignItems:"center",width:"100%"},ie={width:"100%",maxWidth:"1000px",height:{xs:"630px",sm:"495px"},minHeight:{xs:"630px",sm:"495px"},display:"flex",flexDirection:"column",p:0,overflow:"hidden",position:"relative",m:2},oe={display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,px:2},se={color:x.text.secondary},re=e=>({flex:1,display:"flex",flexDirection:"column",pr:0===e?{xs:3,md:0}:0}),ae=e=>({flex:1,overflowY:1===e?"hidden":"auto",p:{xs:2.5,md:3},display:"flex",flexDirection:"column"}),le=({children:e})=>t.jsx(S,{variant:"h5",sx:{color:x.text.primary,fontWeight:s.fontWeight.bold,textAlign:"left",fontSize:s.fontSize.h2},children:e});function ce({Icon:e,title:n,text:i}){return t.jsxs(p,{sx:{px:2},children:[t.jsxs(S,{variant:"h6",sx:{color:x.text.primary,fontWeight:s.fontWeight.semibold,display:"flex",alignItems:"center",mb:1.5,fontSize:s.fontSize.subheading},children:[t.jsx(e,{sx:{mr:2,color:x.primary.main,fontSize:"1.75rem"}}),n]}),t.jsx(S,{variant:"body1",sx:{color:x.text.secondary,lineHeight:1.6,fontSize:s.fontSize.body,ml:6},children:i})]})}function de({open:n,toggleOpen:i,titles:o,instructions:s,instructionsFooter:r,exampleContent:a,extraSteps:l=[],cardSx:c,contentSxOverride:d}){const[u,f]=e.useState(0),h=o.length,g=()=>{i()},b=[t.jsxs(p,{sx:{animation:"fadeIn 0.3s ease",flex:1,display:"flex",flexDirection:"column"},children:[t.jsx(p,{sx:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center",gap:4},children:s.map(({Icon:e,title:n,text:i})=>t.jsx(ce,{Icon:e,title:n,text:i},n))}),r]}),t.jsx(p,{sx:{flex:1,display:"flex",flexDirection:"column",animation:"fadeIn 0.3s ease"},children:t.jsx(p,{sx:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center"},children:a})}),...l],S=d?d(u):ae(u);return t.jsx(w,{open:n,onClose:g,slots:{backdrop:y},slotProps:{backdrop:{sx:ee}},sx:te,children:t.jsx(p,{sx:ne,children:t.jsxs(m,{onClick:e=>{e.stopPropagation()},sx:{...ie,...c},children:[t.jsxs(p,{sx:S,children:[t.jsxs(p,{sx:oe,children:[t.jsx(le,{children:o[u]}),t.jsx(z,{onClick:g,size:"small",sx:se,children:t.jsx(D,{})})]}),t.jsx(p,{sx:re(u),children:b[u]})]}),t.jsxs(p,{sx:{p:2.5,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx(v,{onClick:()=>{u>0&&f(u-1)},disabled:0===u,startIcon:t.jsx(M,{}),sx:{visibility:0===u?"hidden":"visible",color:x.text.primary},children:"Back"}),t.jsx(p,{sx:{display:"flex",gap:1},children:Array.from({length:h},(e,n)=>t.jsx(p,{sx:{width:8,height:8,borderRadius:"50%",backgroundColor:u===n?x.primary.main:x.interactive.disabled,transition:"background-color 0.3s"}},n))}),t.jsx(v,{onClick:()=>{u<h-1?f(u+1):i()},disabled:u===h-1,endIcon:t.jsx(R,{}),sx:{visibility:u===h-1?"hidden":"visible",color:x.text.primary},children:"Next"})]})]})})})}function ue({checkEnabled:t=()=>!0,touchTimeout:n=500,posAttribute:i="data-pos",preventDefault:o=!0,transition:s="all 0.2s",...r}){const a=e.useRef(void 0),l=e.useRef(r.onToggle);l.current=r.onToggle;const c=void 0!==r.onToggle,d=r.onAction,u=e.useMemo(()=>!c&&d?d:(e,n,i)=>{if(!t())return;const o=l.current;if(!o)return;const[s,r]=e.split(",").map(Number);void 0!==s&&void 0!==r&&(i?a.current=o(s,r,n,void 0,!0):o(s,r,n,a.current,!1))},[c,d,t]),[f,m]=e.useState(null),x=e.useRef(new Set),h=e.useRef(0),p=e.useCallback(()=>{m(null),x.current.clear()},[]),g=e.useCallback(e=>{if(null===f)return;const t=e.touches[0];if(!t)return;const n=document.elementFromPoint(t.clientX,t.clientY);if(!n)return;const o=n.closest(`[${i}]`);if(o){const e=o.getAttribute(i);e&&!x.current.has(e)&&(u(e,2===f,!1),x.current.add(e))}},[f,u,i]);e.useEffect(()=>(globalThis.addEventListener("mouseup",p),globalThis.addEventListener("touchend",p),globalThis.addEventListener("touchcancel",p),globalThis.addEventListener("touchmove",g,{passive:!1}),()=>{globalThis.removeEventListener("mouseup",p),globalThis.removeEventListener("touchend",p),globalThis.removeEventListener("touchcancel",p),globalThis.removeEventListener("touchmove",g)}),[p,g]);const b=e.useCallback(e=>({onMouseDown:i=>{t()&&(0!==i.button&&2!==i.button||Date.now()-h.current<n||(o&&i.preventDefault(),m(i.button),u(e,2===i.button,!0),x.current.add(e)))},onMouseEnter:()=>{null!==f&&!x.current.has(e)&&t()&&(u(e,2===f,!1),x.current.add(e))},onTouchStart:n=>{t()&&(n.cancelable&&o&&n.preventDefault(),h.current=Date.now(),m(0),u(e,!1,!0),x.current.add(e))},onKeyDown:n=>{t()&&("Enter"!==n.key&&" "!==n.key||(n.preventDefault(),u(e,!1,!0)))},onContextMenu:e=>{o&&e.preventDefault()},[i]:e,role:"button",tabIndex:0,sx:{touchAction:"none",transition:s}}),[u,t,f,n,i,o,s]);return{isDragging:null!==f,draggingButton:f,getDragProps:b,lastTouchTime:h}}function fe({rows:t,cols:n,width:i,height:o,mobile:s,headerOffset:r,boardConfig:a}){return e.useMemo(()=>{const e="function"==typeof a.paddingOffset?a.paddingOffset(s):a.paddingOffset;return function({rows:e,cols:t,width:n,height:i,mobile:o,headerOffset:s,paddingOffset:r,boardMaxWidth:a,boardSizeFactor:l,maxCellSize:c,remBase:d}){const u=o?s.mobile:s.desktop,f="number"==typeof r?0:r.x,m="number"==typeof r?r:r.y,x=(Math.min(n,a)-f)*l,h=(i-u-m)*l;return Math.min(x/t,h/e,c)/d}({rows:t+(a.rowOffset??0),cols:n+(a.colOffset??0),width:i,height:o,mobile:s,headerOffset:r,...a,paddingOffset:e})},[t,n,i,o,s,r,a])}function me({storageKey:t,rows:n,cols:i,state:o,onRestore:s,serialize:r,deserialize:a,enabled:l=!0,saveDebounceMs:c=300}){const d=`${t}-${String(n)}x${String(i)}`,u=V(s),f=V(r??(e=>e)),m=V(a??(e=>e));var x,h,p;e.useEffect(()=>{if(!l)return;const e=localStorage.getItem(d);if(e)try{const t=JSON.parse(e);u(m(t))}catch{localStorage.removeItem(d)}},[d,l,u,m]),x=()=>{if(!l)return;const e=f(o);localStorage.setItem(d,JSON.stringify(e))},h=c,p=[d,o,l,f],e.useEffect(()=>{const e=setTimeout(x,h);return()=>{clearTimeout(e)}},[...p,h])}function xe({storageKey:t,defaultSize:n,minSize:i=2,maxSize:o=10,headerOffset:s,paddingOffset:r=0,widthLimit:a=1300,cellSizeReference:l,mobileRowOffset:c=0}){const{height:d,width:u}=P(),f=T("sm"),[m,x]=h(t,n,{serialize:String,deserialize:e=>{if("null"===e)return null;const t=Number.parseInt(e,10);return Number.isNaN(t)?void 0:t}}),p=e.useMemo(()=>{const e=f?s.mobile:s.desktop,t="number"==typeof l?l:f?l.mobile:l.desktop,n="number"==typeof r?0:r.x,o="number"==typeof r?r:r.y,m=function(e,t,n){const i=16*e;return{rows:Math.floor(t/i),cols:Math.floor(n/i)}}(t,d-e-o,Math.min(u,a)-n);let x=m.rows-1;const h=m.cols-1;return f&&(x+=c),{rows:Math.max(i,x),cols:Math.max(i,h)}},[l,d,u,f,s,r,a,i,c]),{rows:g,cols:b}=e.useMemo(()=>{if(null===m)return p;const e=f?Math.max(0,c+1):0;return{rows:Math.min(m+e,p.rows),cols:Math.min(m,p.cols)}},[m,p,f,c]);return{rows:g,cols:b,dynamicSize:p,handlePlus:()=>{const e=Math.min(g,b);null!==m&&e<Math.min(p.rows,p.cols)&&e<o&&x(e+1)},handleMinus:()=>{const e=Math.min(g,b);if(null===m){const e=Math.min(p.rows,p.cols);p.rows===p.cols?x(Math.max(i,e-1)):x(e)}else e>i&&x(e-1)},desiredSize:m,setDesiredSize:x,mobile:f,width:u,height:d,minSize:i,maxSize:o}}function he({storageKey:t,grid:n={},board:i={},logic:o}){const s=G(t),{defaultSize:r=null,minSize:a,maxSize:l,headerOffset:c,gridPadding:d,widthLimit:u,cellSizeReference:f,mobileRowOffset:m}=n,{boardPadding:x,boardMaxWidth:h,boardSizeFactor:p,maxCellSize:g,remBase:b,rowOffset:S,colOffset:w}=i,{reducer:y,getInitialState:z,isSolved:v,winAnimationDelay:j=_.timing.winAnimationDelay,persistence:C,manualResize:I=!1,onNext:O}=o,D={...U,defaultSize:r,minSize:a??U.minSize,maxSize:l??U.maxSize,headerOffset:c??U.headerOffset,paddingOffset:d??U.paddingOffset,widthLimit:u??U.widthLimit,cellSizeReference:f??U.cellSizeReference,mobileRowOffset:m??U.mobileRowOffset},M=e.useMemo(()=>({...K,paddingOffset:x??K.paddingOffset,boardMaxWidth:h??K.boardMaxWidth,boardSizeFactor:p??K.boardSizeFactor,maxCellSize:g??K.maxCellSize,remBase:b??K.remBase,rowOffset:S,colOffset:w}),[x,h,p,g,b,S,w]),{rows:R,cols:k,dynamicSize:E,handlePlus:P,handleMinus:T,mobile:A,width:L,height:$,minSize:W,maxSize:B}=xe({storageKey:s.SIZE,...D}),N=e.useRef(null);null===N.current&&(N.current=z(R,k));const[H,F]=e.useReducer(y,N.current),J=e.useMemo(()=>v(H),[H,v]),X=e.useCallback(()=>{F({type:"new"})},[F]),Y=O??X;me({storageKey:s.STATE,rows:R,cols:k,state:H,onRestore:e=>{F({type:"hydrate",state:e})},...C}),function(t,n,i=2e3){const o=V(n);e.useEffect(()=>{if(t){const e=setTimeout(()=>{o()},i);return()=>{clearTimeout(e)}}},[t,i,o])}(J,Y,j),e.useEffect(()=>{I||F({type:"resize",rows:R,cols:k,newRows:R,newCols:k})},[R,k,F,I]);const Z=fe({rows:R,cols:k,width:L,height:$,mobile:A,headerOffset:D.headerOffset,boardConfig:M});return{rows:R,cols:k,state:H,dispatch:F,size:Z,mobile:A,solved:J,handleNext:Y,controlsProps:{rows:R,cols:k,dynamicSize:E,minSize:W,maxSize:B,handlePlus:P,handleMinus:T,onRefresh:Y}}}export{F as B,$ as C,de as G,H as T,q as a,W as b,Y as c,he as d,Z as e,Q as f,X as g,_ as h,J as i,N as j,G as k,ae as l,me as m,ue as u};
