import{r}from"./vendor_react-DdkxgTu-.js";function e(e,t={}){const[s,o]=r.useState(null),[n,u]=r.useState(!1),[c,a]=r.useState(null),l=r.useRef(null),i=r.useCallback(()=>{l.current&&(l.current.terminate(),l.current=null)},[]),d=r.useCallback(r=>{i(),u(!0),a(null);try{const s=e();l.current=s,s.onmessage=r=>{const e={setResult:o,setError:a,setLoading:u};if(t.onMessage)return void t.onMessage(r,e);const s=r.data;if(s.success&&void 0!==s.result)o(s.result),t.onSuccess?.(s.result),u(!1);else{const r=s.error??"An unknown error occurred.";a(r),t.onError?.(r),u(!1)}},s.onerror=r=>{const e="An error occurred in the background worker.";a(e),t.onError?.(e),u(!1)},s.postMessage(r)}catch(s){const r="Failed to start calculation worker.";a(r),t.onError?.(r),u(!1)}},[e,t,i]);return r.useEffect(()=>()=>{i()},[i]),{result:s,loading:n,error:c,run:d,terminate:i,setResult:o,setError:a,setLoading:u}}export{e as u};
