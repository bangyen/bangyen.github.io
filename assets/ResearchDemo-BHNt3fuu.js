import{j as e}from"./vendor_react-DdkxgTu-.js";import{G as r,P as t}from"./PageLayout-BHB3gY3L.js";import{d as o,B as i,e as a,G as n,o as s,p as l,u as d}from"./vendor_mui_core-CQ3K-gFd.js";import{R as c,L as x,C as m,X as h,Y as g,T as u,a as b}from"./vendor_recharts-Bod-2OPO.js";import{T as p,C as f,S as y,c as v,A as S,E as A,a as R}from"./index-DIQF3bpX.js";import{R as T,k as j}from"./vendor_mui_icons-BOQsY4SM.js";const k={GLASS:{VERY_SUBTLE:"var(--glass-very-subtle)",SUBTLE:"var(--glass-subtle)",TRANSPARENT:"var(--glass-transparent)",SLIGHT:"var(--glass-slight)",MEDIUM:"var(--glass-medium)",DARK:"var(--glass-dark)"},CYAN:{BG_SUBTLE:"var(--research-cyan-bg)",BORDER_SUBTLE:"var(--research-cyan-border)"},GREEN:{BG_SUBTLE:"var(--research-green-bg)",BORDER_SUBTLE:"var(--research-green-border)",HOVER:"hsl(141, 64%, 39%)"},AMBER:{HOVER:"hsl(34, 95%, 48%)"},BORDER:{VERY_SUBTLE:"var(--research-border-very-subtle)",SUBTLE:"var(--research-border-subtle)"},LAYOUT:{BUTTON_HEIGHT:"36.5px",CONTROLS_SPACING:2.5,RESULT_CARD_HEIGHT:480,INNER_PADDING:"1rem",INNER_PADDING_SM:"0.6rem 0.8rem",FONT_SIZE_XS:"0.75rem",FONT_SIZE_SM:"0.85rem",FONT_SIZE_MD:"0.95rem",CARD_RADIUS:"6px"},ANIMATIONS:{SPIN:{animation:"spin 1s linear infinite","@keyframes spin":{"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}}}}},E={oligopoly:{defaultFirms:3,defaultElasticity:2,defaultBasePrice:40,maxRounds:15,simulation:{fallbackPrice:20,fallbackHHI:.3,collusionStart:6,collusionEnd:10,priceAmplitude:5,hhiAmplitude:.1,priceFrequency:.3,hhiFrequency:.1},options:{firms:[{value:2,label:"2"},{value:3,label:"3"},{value:4,label:"4"},{value:5,label:"5"}],elasticity:[{value:1.5,label:"1.5"},{value:2,label:"2.0"},{value:2.5,label:"2.5"}],price:[{value:30,label:"$30"},{value:40,label:"$40"},{value:50,label:"$50"}]}},zsharp:{baseAccuracy:.65,maxAccuracy:.75,baseLoss:2,minLoss:.8,improvement:.05,lossReduction:.1,maxEpochs:20,yAxisPadding:.05,lossPadding:.1,gapPadding:.005,convergencePadding:.005},lightsOut:{yAxisMax:70},modelTypes:{cournot:"cournot"}},C=300,I=4,L=3,_={strokeDashArray:"3 3",defaultStrokeWidth:2},w={multiplier:100,divisor:100};function N({currentData:t,currentChartConfig:a,loading:n,loadingMessage:s,chartTitle:l,isMobile:d}){return e.jsxs(r,{sx:{marginBottom:3,width:"100%",boxSizing:"border-box",overflow:"hidden"},children:[e.jsx(o,{variant:"subtitle1",sx:{color:f.text.secondary,marginBottom:2,textAlign:"center",fontWeight:p.fontWeight.medium,fontSize:p.fontSize.subheading},children:l}),e.jsx(i,{sx:{height:C,width:"100%",position:"relative"},children:n?e.jsx(i,{sx:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:f.text.secondary},children:e.jsx(o,{children:s})}):e.jsx(c,{width:"100%",height:C,minWidth:0,minHeight:0,debounce:1,children:e.jsxs(x,{data:t,children:[e.jsx(m,{strokeDasharray:_.strokeDashArray,stroke:f.border.subtle,vertical:!1}),e.jsx(h,{dataKey:a.xAxisKey,stroke:f.text.secondary,tick:{fill:f.text.secondary,fontSize:10},axisLine:{stroke:f.border.subtle},tickLine:!1}),e.jsx(g,{yAxisId:"left",hide:d,stroke:f.text.secondary,tick:{fill:f.text.secondary,fontSize:10},axisLine:!1,tickLine:!1,tickFormatter:a.yAxisFormatter,domain:a.yAxisDomain}),a.dualYAxis&&e.jsx(g,{yAxisId:"right",orientation:"right",hide:d,stroke:f.text.secondary,tick:{fill:f.text.secondary,fontSize:10},axisLine:!1,tickLine:!1,tickFormatter:a.rightYAxisFormatter,domain:a.rightYAxisDomain}),e.jsx(u,{contentStyle:{backgroundColor:f.surface.glass,backdropFilter:"blur(8px) saturate(180%)",border:`1px solid ${f.border.subtle}`,borderRadius:y.borderRadius.md,color:f.text.primary,boxShadow:"none"},itemStyle:{fontSize:"12px",padding:"2px 0"},labelStyle:{fontWeight:"bold",marginBottom:"4px",color:f.text.primary},labelFormatter:a.tooltipLabelFormatter,formatter:(e,r)=>{if(void 0===e)throw new Error("Value is undefined");if(void 0===r)throw new Error("Name is undefined");return a.tooltipFormatter(e,r)}}),a.lines.map(r=>e.jsx(b,{yAxisId:r.yAxisId??"left",type:"monotone",dataKey:r.dataKey,stroke:r.color,strokeWidth:L,name:r.name,dot:{fill:r.color,strokeWidth:_.defaultStrokeWidth,r:I}},r.dataKey))]})})})]})}const D=({controls:r,onReset:t,resetLabel:d="Reset"})=>0===r.length?null:e.jsxs(i,{sx:{marginBottom:0,width:"100%",boxSizing:"border-box",paddingBottom:y.padding.md},children:[t&&e.jsx(i,{sx:{display:"flex",justifyContent:"flex-end",alignItems:"center",mb:k.LAYOUT.CONTROLS_SPACING},children:e.jsx(a,{variant:"outlined",size:"small",startIcon:e.jsx(T,{}),onClick:t,sx:{color:f.text.secondary,borderColor:f.border.subtle,borderRadius:y.borderRadius.lg,px:2,py:.5,fontSize:k.LAYOUT.FONT_SIZE_MD,fontWeight:p.fontWeight.medium,transition:S.transitions.standard,"&:hover":{borderColor:f.primary.main,backgroundColor:f.interactive.hover,transform:"translateY(-1px)",boxShadow:v.sm}},children:d})}),e.jsx(n,{container:!0,spacing:k.LAYOUT.CONTROLS_SPACING,children:r.map((r,t)=>e.jsx(n,{size:{xs:12,md:4},children:e.jsxs(i,{sx:{marginBottom:0,padding:k.LAYOUT.INNER_PADDING,backgroundColor:f.interactive.disabled,borderRadius:y.borderRadius.lg,border:`1px solid ${f.border.subtle}`},children:[e.jsxs(i,{sx:{display:"flex",alignItems:"center",gap:1,mb:2},children:[r.icon&&e.jsx(r.icon,{sx:{color:r.color??f.primary.light,fontSize:"1.1rem"}}),e.jsx(o,{variant:"body2",sx:{color:f.text.secondary,fontWeight:p.fontWeight.medium},children:r.label})]}),e.jsx(s,{value:r.value,exclusive:!0,onChange:(e,t)=>{null!==t&&r.onChange(t)},size:"small",sx:{width:"100%",borderRadius:y.borderRadius.lg,overflow:"hidden",border:`1px solid ${f.border.subtle}`,"& .MuiToggleButtonGroup-grouped":{margin:0,border:0,borderRadius:0,"&:not(:first-of-type)":{borderLeft:`1px solid ${f.border.subtle}`}},"& .MuiToggleButton-root":{color:f.text.secondary,borderColor:f.border.subtle,padding:k.LAYOUT.INNER_PADDING_SM,flex:1,fontSize:k.LAYOUT.FONT_SIZE_MD,fontWeight:p.fontWeight.medium,borderRadius:0,transition:S.transitions.standard,"&.Mui-selected":{backgroundColor:r.color??f.primary.main,color:f.text.primary,borderColor:r.color??f.primary.main,"&:hover":{backgroundColor:r.hoverColor??(r.color===f.primary.main?f.primary.dark:r.color===f.data.green?k.GREEN.HOVER:r.color===f.data.amber?k.AMBER.HOVER:r.color??f.primary.dark),borderColor:r.hoverColor??(r.color===f.primary.main?f.primary.dark:r.color===f.data.green?k.GREEN.HOVER:r.color===f.data.amber?k.AMBER.HOVER:r.color??f.primary.dark),transform:"translateY(-1px)",boxShadow:v.sm}}},"&:hover":{backgroundColor:f.interactive.hover,transform:"translateY(-1px)"}},children:r.options.map(r=>e.jsx(l,{value:r.value,children:r.label},r.value))})]})},r.label||t))})]}),B=({children:t})=>e.jsx(A,{FallbackComponent:({error:t,resetErrorBoundary:n})=>e.jsx(i,{sx:{display:"flex",justifyContent:"center",alignItems:"center",p:4,minHeight:"300px"},children:e.jsxs(r,{sx:{p:4,maxWidth:"500px",textAlign:"center"},children:[e.jsx(o,{variant:"h5",sx:{mb:2,color:f.text.primary,fontWeight:"bold"},children:"Research Tool Error"}),e.jsx(o,{sx:{mb:3,color:f.text.secondary,fontFamily:"monospace",fontSize:"0.9rem"},children:t?.message??"An unexpected error occurred."}),e.jsx(a,{variant:"contained",onClick:n,sx:{borderRadius:y.borderRadius.md,textTransform:"none"},children:"Reset Component"})]})}),children:t});function O({title:r,subtitle:t,backUrl:n,isMobile:s}){const l=r=>e.jsx(a,{component:"a",href:`#${n??""}`,startIcon:e.jsx(j,{}),size:"small",sx:{color:f.text.secondary,padding:0,minWidth:0,"&:hover":{backgroundColor:"transparent",color:f.primary.main},marginBottom:r,alignSelf:{xs:"center",sm:"flex-end"},textTransform:"none",fontSize:"0.8rem"},children:"Back to Simulation"});let d;return d=n&&s?l(0):e.jsx(o,{variant:"h5",sx:{color:f.text.secondary,fontSize:p.fontSize.subheading,textAlign:{xs:"center",md:"right"},whiteSpace:{xs:"normal",md:"nowrap"},display:{xs:"none",sm:"block"}},children:t}),e.jsxs(i,{sx:{display:"flex",flexDirection:"column",alignItems:{xs:"center",md:"flex-start"},gap:2,marginBottom:{xs:3,md:4},width:"100%"},children:[n&&!s&&l(-2),e.jsxs(i,{sx:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:{xs:"center",md:"baseline"},width:"100%"},children:[e.jsx(o,{variant:"h1",sx:{color:f.text.primary,fontWeight:p.fontWeight.bold,fontSize:p.fontSize.h2,textAlign:{xs:"center",md:"left"}},children:r}),d]})]})}const z=({viewTypes:r,currentViewType:t,onViewTypeChange:o})=>r.length<=1?null:e.jsx(i,{sx:{marginBottom:3,width:"100%",boxSizing:"border-box"},children:e.jsx(i,{sx:{display:"grid",gridTemplateColumns:{xs:"repeat(2, minmax(0, 1fr))",md:`repeat(${Math.min(r.length,4).toString()}, 1fr)`},gap:1.5,width:"100%",margin:0},children:r.map(r=>{const i=r.icon;return e.jsx(a,{variant:"outlined",size:"small",startIcon:e.jsx(i,{}),onClick:()=>{o(r.key)},sx:{width:"100%",color:t===r.key?"inherit":f.text.secondary,backgroundColor:t===r.key?f.primary.main:f.surface.elevated,"&.MuiButton-root":{color:t===r.key?f.text.primary:f.text.secondary},borderColor:f.border.subtle,borderWidth:"1px",borderStyle:"solid",borderRadius:y.borderRadius.lg,minHeight:k.LAYOUT.BUTTON_HEIGHT,padding:k.LAYOUT.INNER_PADDING_SM,fontSize:k.LAYOUT.FONT_SIZE_SM,fontWeight:p.fontWeight.medium,transition:S.transitions.standard,"&:hover":{backgroundColor:t===r.key?f.primary.dark:f.interactive.hover,transform:"translateY(-1px)",boxShadow:v.sm}},children:r.label},r.key)})})}),M=({title:r,subtitle:o,githubUrl:a,chartData:s=[],chartConfig:l={type:"line",lines:[],xAxisKey:"x",yAxisFormatter:e=>e.toFixed(2),yAxisDomain:["dataMin - 0.05","dataMax + 0.05"],dualYAxis:!1,rightYAxisFormatter:e=>e.toFixed(2),rightYAxisDomain:["dataMin - 0.05","dataMax + 0.05"],tooltipLabelFormatter:e=>`Round ${String(e)}`,tooltipFormatter:(e,r)=>[e.toFixed(2),r]},viewTypes:c=[],currentViewType:x="default",onViewTypeChange:m=()=>{},controls:h=[],loading:g=!1,loadingMessage:u="Loading data...",onReset:b,resetLabel:p="Reset",chartTitle:f=null,children:v,backUrl:S})=>{const A=(()=>{if(0===s.length)return[];if(!c.length)return s;const e=c.find(e=>e.key===x);return e?.dataProcessor?e.dataProcessor(s):s})(),T=c.find(e=>e.key===x)?.chartConfig??l,j=d("(max-width:600px)"),k=f??(c.length>0?c.find(e=>e.key===x)?.chartTitle??"Data Visualization":"Data Visualization");return e.jsx(B,{children:e.jsx(t,{githubUrl:a,children:e.jsx(n,{container:!0,flex:1,flexDirection:"column",sx:{position:"relative",padding:y.padding.md,paddingTop:y.padding.xl,paddingBottom:{xs:y.padding.md,md:0},boxSizing:"border-box",width:"100%",maxWidth:"100vw",overflowX:"hidden"},children:e.jsx(n,{size:{xs:12},flex:1,sx:{...R.flexCenter,flexDirection:"column",zIndex:1,padding:0,minHeight:0},children:e.jsxs(i,{sx:{textAlign:"center",maxWidth:y.maxWidth.md,width:"100%",padding:{xs:"0 0.5rem",md:"0 2rem"},boxSizing:"border-box",overflow:"hidden"},children:[e.jsx(O,{title:r,subtitle:o,backUrl:S,isMobile:j}),e.jsx(N,{currentData:A,currentChartConfig:T,loading:g,loadingMessage:u,chartTitle:k,isMobile:j}),e.jsx(z,{viewTypes:c,currentViewType:x,onViewTypeChange:m}),e.jsx(D,{controls:h,onReset:b,resetLabel:p}),v]})})})})})};export{w as P,M as R,E as a,k as b};
