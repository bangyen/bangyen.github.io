import{r as e,j as t}from"./vendor_react-WaSaIrII.js";import{S as r,L as o,g as n,a as s,A as i,d as c,e as l}from"./index-CgC1DzFw.js";import{u as a,C as u,c as d}from"./CustomGrid-DXN5wnfO.js";import{B as f,G as g}from"./vendor_mui_core-D4-4kcvK.js";import{Y as p,Z as h,l as m,r as w,s as v,h as x}from"./vendor_mui_icons-urSXftat.js";import{G as S}from"./GlobalHeader-B_Ys6Bfk.js";import{u as b}from"./useWindow-BCvkQ8_7.js";const y="32px",E="48px",$=2e3,C=500,j=300,I=500,N="130%",k="6px",M="24px",R={MOBILE:64,DESKTOP:80},L=100,A=1e3,z=1200,D=.95,B=240,O=100,T=16,_="slant-size",H="slant-state",G="slant-ghost-moves",P=.35,Y=3,W=10,q=5,J=30,U={WHITE:"#fff"},V={LINE:"0 2px 4px rgba(0,0,0,0.2)",HINT:"0 4px 8px rgba(0,0,0,0.1)"},F={BORDER:"rgba(255, 255, 255, 0.1)",BG_SUBTLE:"rgba(255, 255, 255, 0.02)",BG_HOVER:"rgba(255, 255, 255, 0.1)",DASHED_BORDER:"rgba(255, 255, 255, 0.2)",HINT_BG:"hsl(217, 50%, 8%)",HINT_BORDER:"rgba(255, 255, 255, 0.3)",OVERLAY_LABEL:"rgba(255, 255, 255, 0.5)",OVERLAY_BG:"rgba(0, 0, 0, 0.3)"},K=1,X=2;class Z{constructor(e){this.parent=Array.from({length:e},(e,t)=>t)}find(e){const t=this.parent[e];if(void 0===t)throw new Error("Index out of bounds");t!==e&&(this.parent[e]=this.find(t));const r=this.parent[e];if(void 0===r)throw new Error("Root not found");return r}union(e,t){const r=this.find(e),o=this.find(t);return r!==o&&(this.parent[r]=o,!0)}}function Q(e,t,r){return e*(r+1)+t}function ee(e,t,r){const o=new Map,n=new Set;for(let a=0;a<t;a++)for(let t=0;t<r;t++){const n=e[a]?.[t];if(!n||0===n)continue;const s=Q(a,n===K?t+1:t,r),i=Q(a+1,n===K?t:t+1,r);o.has(s)||o.set(s,[]),o.has(i)||o.set(i,[]),o.get(s)?.push({node:i,r:a,c:t}),o.get(i)?.push({node:s,r:a,c:t})}const s=new Set,i=new Set,c=[],l=(e,t)=>{s.add(e),i.add(e);const r=o.get(e)??[];for(const{node:o,r:a,c:u}of r)if(o!==t)if(i.has(o)){n.add(`${String(a)},${String(u)}`);for(let e=c.length-1;e>=0;e--){const t=c[e];if(!t)break;if(n.add(`${String(t.r)},${String(t.c)}`),t.u===o||t.v===o)break}}else s.has(o)||(c.push({r:a,c:u,u:e,v:o}),l(o,e),c.pop());i.delete(e)};for(const a of o.keys())s.has(a)||l(a,-1);return n}function te(e,t,r){const o=new Z((t+1)*(r+1));for(let n=0;n<t;n++){const t=e[n];if(t)for(let e=0;e<r;e++){const s=t[e];if(void 0===s||0===s)continue;const i=Q(n,s===K?e+1:e,r),c=Q(n+1,s===K?e:e+1,r);if(!o.union(i,c))return!0}}return!1}function re(e,t,r){const o=Array.from({length:t+1},()=>Array(r+1).fill(0));for(let n=0;n<t;n++){const t=e[n];if(t)for(let e=0;e<r;e++){const r=t[e];if(r===K){const t=o[n];if(t){const r=t[e+1];void 0!==r&&(t[e+1]=r+1)}const r=o[n+1];if(r){const t=r[e];void 0!==t&&(r[e]=t+1)}}else if(r===X){const t=o[n];if(t){const r=t[e];void 0!==r&&(t[e]=r+1)}const r=o[n+1];if(r){const t=r[e+1];void 0!==t&&(r[e+1]=t+1)}}}}return o}function oe(e,t,r){const o=Array.from({length:t},()=>Array(r).fill(0));let n=!0;for(;n;){n=!1;for(let s=0;s<=t;s++)for(let i=0;i<=r;i++){const c=e[s]?.[i];if(null==c)continue;const l=[{gr:s-1,gc:i-1,pt:X},{gr:s-1,gc:i,pt:K},{gr:s,gc:i-1,pt:K},{gr:s,gc:i,pt:X}].filter(({gr:e,gc:o})=>e>=0&&e<t&&o>=0&&o<r);let a=0;const u=[];for(const e of l){const t=o[e.gr]?.[e.gc];0===t?u.push(e):t===e.pt&&a++}if(a===c&&u.length>0)for(const{gr:e,gc:t,pt:r}of u){const s=o[e];s&&(s[t]=r===K?X:K,n=!0)}else if(a+u.length===c&&u.length>0)for(const{gr:e,gc:t,pt:r}of u){const s=o[e];s&&(s[t]=r,n=!0)}}if(!n)for(let e=0;e<t;e++)for(let s=0;s<r;s++){const i=o[e];if(0===i?.[s])if(i[s]=K,te(o,t,r)){if(i[s]=X,n=!0,te(o,t,r))return!1}else if(i[s]=X,te(o,t,r)){if(i[s]=K,n=!0,te(o,t,r))return!1}else i[s]=0}}if(!o.every(e=>e.every(e=>0!==e)))return!1;const s=re(o,t,r);for(let i=0;i<=t;i++)for(let t=0;t<=r;t++){const r=e[i]?.[t];if(null!=r&&s[i]?.[t]!==r)return!1}return!te(o,t,r)}function ne(e,t){const r=Array.from({length:e},()=>Array(t).fill(K)),o=e*t*J;for(let l=0;l<o;l++){const o=Math.floor(Math.random()*e),n=Math.floor(Math.random()*t),s=r[o];if(!s)continue;const i=s[n];void 0!==i&&(s[n]=i===K?X:K,te(r,e,t)&&(s[n]=i))}const n=re(r,e,t).map(e=>[...e]),s=[];for(let l=0;l<=e;l++)for(let e=0;e<=t;e++)s.push({r:l,c:e});for(let l=s.length-1;l>0;l--){const e=Math.floor(Math.random()*(l+1)),t=s[l],r=s[e];t&&r&&(s[l]=r,s[e]=t)}const i=Math.floor((e+1)*(t+1)*P);let c=(e+1)*(t+1);for(const{r:l,c:a}of s){if(c<=i)continue;const r=n[l];if(!r)continue;const o=r[a];null!=o&&(r[a]=null,oe(n,e,t)?c--:r[a]=o)}return{numbers:n,solution:r}}function se(e,t){switch(t.type){case"toggle":{if(e.solved)return e;const{row:r,col:o}=t,n=e.grid.map(e=>[...e]),s=n[r];if(!s)return e;const i=s[o];if(void 0===i)return e;t.reverse?s[o]=0===i?X:i===X?K:0:s[o]=0===i?K:i===K?X:0;let c=!1;if(n.every(e=>e.every(e=>0!==e))){const t=re(n,e.rows,e.cols);e.numbers.every((e,r)=>e.every((e,o)=>null===e||e===t[r]?.[o]))&&!te(n,e.rows,e.cols)&&(c=!0)}const l=function(e,t,r,o){const n=new Set,s=re(e,r,o);for(let i=0;i<=r;i++)for(let c=0;c<=o;c++){const l=t[i]?.[c];if(null==l)continue;const a=s[i]?.[c]??0;a>l?n.add(`${String(i)},${String(c)}`):a+[{gr:i-1,gc:c-1},{gr:i-1,gc:c},{gr:i,gc:c-1},{gr:i,gc:c}].filter(({gr:t,gc:n})=>t>=0&&t<r&&n>=0&&n<o&&0===e[t]?.[n]).length<l&&n.add(`${String(i)},${String(c)}`)}return n}(n,e.numbers,e.rows,e.cols),a=ee(n,e.rows,e.cols),u=function(e,t,r,o){const n=new Set,s=re(e,r,o);for(let i=0;i<=r;i++)for(let e=0;e<=o;e++){const r=t[i]?.[e];null!=r&&((s[i]?.[e]??0)===r&&n.add(`${String(i)},${String(e)}`))}return n}(n,e.numbers,e.rows,e.cols);return{...e,grid:n,solved:c,auto:!c&&e.auto,errorNodes:l,cycleCells:a,satisfiedNodes:u}}case"auto":return{...e,auto:!e.auto};case"nextLogical":{const t=function(e){const{grid:t,numbers:r,rows:o,cols:n}=e;for(let s=0;s<=o;s++)for(let e=0;e<=n;e++){const i=r[s]?.[e];if(null==i)continue;const c=[{gr:s-1,gc:e-1,pt:X},{gr:s-1,gc:e,pt:K},{gr:s,gc:e-1,pt:K},{gr:s,gc:e,pt:X}].filter(({gr:e,gc:t})=>e>=0&&e<o&&t>=0&&t<n);let l=0;const a=[];for(const e of c){const r=t[e.gr]?.[e.gc];0===r?a.push(e):r===e.pt&&l++}if(a.length>0)if(l===i){const e=a[0];if(e)return{row:e.gr,col:e.gc,reverse:e.pt===K}}else if(l+a.length===i){const e=a[0];if(e)return{row:e.gr,col:e.gc,reverse:e.pt===X}}}for(let s=0;s<o;s++)for(let e=0;e<n;e++){if(0!==t[s]?.[e])continue;const r=t.map(e=>[...e]),i=r[s];if(i){if(i[e]=K,te(r,o,n))return{row:s,col:e,reverse:!0};if(i[e]=X,te(r,o,n))return{row:s,col:e,reverse:!1}}}for(let s=0;s<o;s++)for(let r=0;r<n;r++){const o=t[s]?.[r],n=e.solution[s]?.[r];if(0!==o&&o!==n&&void 0!==n)return{row:s,col:r,reverse:n===X}}return null}(e);return t?se(e,{type:"toggle",...t}):{...e,auto:!1}}case"hydrate":return{...t.state,auto:!1};case"resize":{if(t.rows<Y||t.cols<Y)return e;const{numbers:r,solution:o}=ne(t.rows,t.cols);return{grid:Array.from({length:t.rows},()=>Array(t.cols).fill(0)),numbers:r,solution:o,rows:t.rows,cols:t.cols,solved:!1,auto:!1,errorNodes:new Set,cycleCells:new Set,satisfiedNodes:new Set}}case"new":{const{numbers:t,solution:r}=ne(e.rows,e.cols);return{...e,grid:Array.from({length:e.rows},()=>Array(e.cols).fill(0)),numbers:t,solution:r,solved:!1,auto:!1,errorNodes:new Set,cycleCells:new Set,satisfiedNodes:new Set}}default:return e}}const ie=({rows:c,cols:l,numbers:d,size:g,initialMoves:m,onMove:w,onCopy:v,onClear:x})=>{const S=a("sm"),b=m,[$,C]=e.useState(null),j=e.useRef(void 0),R=e.useRef(new Set),L=e.useRef(0),A=e.useCallback(e=>{R.current.add(e)},[]);e.useEffect(()=>{const e=()=>{C(null),R.current.clear(),j.current=void 0},t=e=>{if(null===$)return;const t=e.touches[0];if(!t)return;const r=document.elementFromPoint(t.clientX,t.clientY);if(!r)return;const o=r.closest("[data-pos]");if(o){const e=o.getAttribute("data-pos");e&&!R.current.has(e)&&(w(e,j.current),A(e))}};return window.addEventListener("mouseup",e),window.addEventListener("touchend",e),window.addEventListener("touchcancel",e),window.addEventListener("touchmove",t,{passive:!1}),()=>{window.removeEventListener("mouseup",e),window.removeEventListener("touchend",e),window.removeEventListener("touchcancel",e),window.removeEventListener("touchmove",t)}},[$,A,w]);const[z,D]=e.useState(new Map),[B,O]=e.useState([]),[T,_]=e.useState(new Set);e.useEffect(()=>{const e=new Map,t=[],r=[];b.forEach((r,o)=>{e.set(o,{state:r,source:"user"});const[n,s]=o.split(",").map(Number);void 0!==n&&void 0!==s&&t.push({r:n,c:s})});const o=(t,r)=>{if(t<0||t>=c||r<0||r>=l)return 0;const o=`${String(t)},${String(r)}`;return e.get(o)?.state??0},n=(o,n,s,i)=>{const c=`${String(o)},${String(n)}`,l=e.get(c);l?l.state!==s&&r.push({type:"cell",r:o,c:n}):(e.set(c,{state:s,source:i}),t.push({r:o,c:n}))},s=(e,t)=>[{r:e-1,c:t-1,required:X},{r:e-1,c:t,required:K},{r:e,c:t-1,required:K},{r:e,c:t,required:X}].filter(e=>e.r>=0&&e.r<c&&e.c>=0&&e.c<l);let i=0;for(;i<t.length;){const c=t[i++];if(!c)break;const{r:l,c:a}=c,u=[{r:l,c:a},{r:l,c:a+1},{r:l+1,c:a},{r:l+1,c:a+1}];for(const t of u){const i=d[t.r]?.[t.c];if(null==i)continue;const c=s(t.r,t.c);let u=0;const f=[];for(const e of c){const t=o(e.r,e.c);0===t?f.push(e):t===e.required&&u++}if(u>i)r.push({type:"node",r:t.r,c:t.c});else if(u+f.length<i)r.push({type:"node",r:t.r,c:t.c});else if("user"===e.get(`${String(l)},${String(a)}`)?.source)if(u===i&&f.length>0)for(const e of f){const t=e.required===K?X:K;n(e.r,e.c,t,"propagated")}else if(u+f.length===i&&f.length>0)for(const e of f)n(e.r,e.c,e.required,"propagated")}}const a=Array.from({length:c},()=>Array(l).fill(0));e.forEach((e,t)=>{const[r,o]=t.split(",").map(Number);void 0!==r&&void 0!==o&&a[r]&&(a[r][o]=e.state)});const u=ee(a,c,l);D(e),O(r),_(u)},[b,d,c,l]);const H=.4*g,G=g-H,P=e.useMemo(()=>new Set(B.filter(e=>"cell"===e.type).map(e=>`${String(e.r)},${String(e.c)}`)),[B]),Y=e.useMemo(()=>new Set(B.filter(e=>"node"===e.type).map(e=>`${String(e.r)},${String(e.c)}`)),[B]);return t.jsxs(f,{sx:{position:"relative",userSelect:"none"},children:[t.jsx(f,{sx:{position:"absolute",top:-40,left:0,right:0,display:"flex",justifyContent:"center",pointerEvents:"none"},children:t.jsx(f,{sx:{color:F.OVERLAY_LABEL,fontSize:"0.8rem",fontWeight:"bold",letterSpacing:"0.2rem",border:`1px solid ${F.HINT_BORDER}`,padding:"4px 12px",borderRadius:r.borderRadius.sm,background:F.OVERLAY_BG,backdropFilter:"blur(4px)"},children:"CALCULATOR"})}),t.jsxs(f,{sx:{position:"relative",padding:S?y:E,border:`2px dashed ${F.DASHED_BORDER}`,borderRadius:M},children:[t.jsx(f,{sx:{position:"relative",zIndex:o.zIndex.base+1},children:t.jsx(u,{size:g,rows:c,cols:l,cellProps:(e,o)=>{const n=`${String(e)},${String(o)}`,c=z.get(n),l=c?.state??0,a=c?.source,u=P.has(n),d=T.has(n);let g=s.text.primary;return u?g=s.data.red:d?g="user"===a?s.data.red:"#ff9800":"user"===a?g=s.primary.main:"propagated"===a&&(g=s.data.green),{onContextMenu:e=>{e.preventDefault()},onMouseDown:e=>{if(0!==e.button&&2!==e.button)return;if(Date.now()-L.current<I)return;e.preventDefault();const t=b.get(n);let r;r=2===e.button?t===X?K:t===K?void 0:X:t===K?X:t===X?void 0:K,j.current=r,C(e.button),w(n,r),A(n)},onMouseEnter:()=>{null===$||R.current.has(n)||(w(n,j.current),A(n))},onTouchStart:e=>{e.cancelable&&e.preventDefault(),L.current=Date.now();const t=b.get(n),r=t===K?X:t===X?void 0:K;j.current=r,C(0),w(n,r),A(n)},"data-pos":n,"data-type":"cell",sx:{cursor:"pointer",border:`1px solid ${F.BORDER}`,position:"relative",transition:"all 0.2s",touchAction:"none",backgroundColor:F.BG_SUBTLE,"&:hover":{backgroundColor:F.BG_HOVER}},children:t.jsxs(f,{sx:{width:"100%",height:"100%",position:"relative"},children:[l===K&&t.jsx(f,{sx:{position:"absolute",width:N,height:k,backgroundColor:g,borderRadius:r.borderRadius.full,top:"50%",left:"50%",transform:"translate(-50%, -50%) rotate(-45deg)",boxShadow:V.LINE,transition:i.transition,pointerEvents:"none"}}),l===X&&t.jsx(f,{sx:{position:"absolute",width:N,height:k,backgroundColor:g,borderRadius:r.borderRadius.full,top:"50%",left:"50%",transform:"translate(-50%, -50%) rotate(45deg)",boxShadow:V.LINE,transition:i.transition,pointerEvents:"none"}})]})}},space:0,sx:{width:"fit-content"}})}),t.jsx(f,{sx:{position:"absolute",top:S?y:E,left:S?y:E,transform:`translate(-${String(H/2)}rem, -${String(H/2)}rem)`,zIndex:o.zIndex.base+2,pointerEvents:"none"},children:t.jsx(u,{size:H,rows:c+1,cols:l+1,cellProps:(e,r)=>{const o=d[e]?.[r],n=Y.has(`${String(e)},${String(r)}`);return{"data-pos":`${String(e)},${String(r)}`,"data-type":"hint",children:t.jsx(f,{children:o??""}),sx:{borderRadius:"50%",backgroundColor:n?s.data.red:F.HINT_BG,border:null!==o?`2px solid ${n?s.data.red:F.HINT_BORDER}`:"none",fontSize:`${String(.5*H)}rem`,fontWeight:"800",color:U.WHITE,zIndex:5,opacity:null!==o?1:0,display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",userSelect:"none",WebkitUserSelect:"none",transform:n?"scale(1.1)":"scale(1)",position:"relative",pointerEvents:"none"}}},space:G,sx:{width:"fit-content"}})})]}),t.jsxs(f,{sx:{display:"flex",justifyContent:"center",gap:2,marginTop:3,marginBottom:4,pointerEvents:"auto"},children:[t.jsx(n,{title:"Copy Logic from Board",Icon:p,onClick:v,sx:{backgroundColor:s.interactive.selected,color:s.primary.main,"&:hover":{backgroundColor:s.interactive.focus}}}),t.jsx(n,{title:"Clear Calculator",Icon:h,onClick:x,sx:{backgroundColor:"rgba(255, 68, 68, 0.1)",color:s.data.red,"&:hover":{backgroundColor:"rgba(255, 68, 68, 0.2)"}}})]})]})};function ce(){const{height:r,width:o}=b(),p=a("sm"),[h,y]=e.useState(!1),[E,N]=e.useState(()=>{const e=localStorage.getItem(_);return e&&"null"!==e?parseInt(e,10):q}),k=e.useMemo(()=>{const e=p?R.MOBILE:R.DESKTOP,t=d(4,r-e-L,Math.min(o,A));let n=t.rows-1;const s=t.cols-1;return p&&(n-=2),{rows:Math.max(Y,n),cols:Math.max(Y,s)}},[r,o,p]),{rows:M,cols:P}=e.useMemo(()=>{const e=E??q;return{rows:Math.min(e,k.rows),cols:Math.min(e,k.cols)}},[E,k]),J=e.useMemo(()=>{const e=Math.min(o,z)*D/(P+1),t=(r-B)*D/(M+1);return Math.min(e,t,O)/T},[o,r,M,P]),[F,Z]=e.useReducer(se,{rows:M,cols:P},e=>{const t=localStorage.getItem(H);if(t)try{const r=JSON.parse(t);if(r.rows===e.rows&&r.cols===e.cols)return{...r,errorNodes:new Set(r.errorNodes),cycleCells:new Set(r.cycleCells),satisfiedNodes:new Set(r.satisfiedNodes)}}catch(r){}return function(e,t){const{numbers:r,solution:o}=ne(e,t);return{grid:Array.from({length:e},()=>Array(t).fill(0)),numbers:r,solution:o,rows:e,cols:t,solved:!1,auto:!1,errorNodes:new Set,cycleCells:new Set,satisfiedNodes:new Set}}(e.rows,e.cols)});e.useEffect(()=>{localStorage.setItem(_,String(E))},[E]),e.useEffect(()=>{if(F.rows!==M||F.cols!==P){const t=`${H}-${String(M)}x${String(P)}`,r=localStorage.getItem(t);if(r)try{const e=JSON.parse(r);return void Z({type:"hydrate",state:{...e,errorNodes:new Set(e.errorNodes),cycleCells:new Set(e.cycleCells),satisfiedNodes:new Set(e.satisfiedNodes)}})}catch(e){}Z({type:"resize",rows:M,cols:P})}},[M,P,F.rows,F.cols]);const[Q,ee]=e.useState(new Map);e.useEffect(()=>{const e=`${G}-${String(F.rows)}x${String(F.cols)}`,t=localStorage.getItem(e);if(t)try{ee(new Map(JSON.parse(t)))}catch(r){ee(new Map)}else ee(new Map)},[F.numbers,F.rows,F.cols]),e.useEffect(()=>{const e=`${H}-${String(F.rows)}x${String(F.cols)}`,t=`${G}-${String(F.rows)}x${String(F.cols)}`,r=F.grid.some(e=>e.some(e=>0!==e)),o=Q.size>0;if(!r&&!o)return localStorage.removeItem(e),void localStorage.removeItem(t);const n={...F,errorNodes:Array.from(F.errorNodes),cycleCells:Array.from(F.cycleCells),satisfiedNodes:Array.from(F.satisfiedNodes)};localStorage.setItem(e,JSON.stringify(n)),o?localStorage.setItem(t,JSON.stringify(Array.from(Q.entries()))):localStorage.removeItem(t)},[F,Q]);const te=e.useRef("");e.useEffect(()=>{const e=JSON.stringify(F.numbers);te.current&&te.current!==e&&ee(new Map),te.current=e},[F.numbers,F.rows,F.cols]),e.useEffect(()=>{document.title=c.slant},[]);const re=e.useCallback(()=>{Z({type:"new"})},[Z]);e.useEffect(()=>{if(F.solved){const e=setTimeout(()=>{re()},$);return()=>{clearTimeout(e)}}},[F.solved,re]);const[oe,ce]=e.useState(!1);e.useEffect(()=>{if(F.solved){const e=setTimeout(()=>{ce(!0)},C);return()=>{clearTimeout(e)}}ce(!1)},[F.solved]);const[le,ae]=e.useState(null),ue=e.useRef(new Set),de=e.useRef(0),fe=e.useCallback(e=>{ue.current.add(e)},[]);e.useEffect(()=>{const e=()=>{ae(null),ue.current.clear()},t=e=>{if(null===le)return;const t=e.touches[0];if(!t)return;const r=document.elementFromPoint(t.clientX,t.clientY);if(!r)return;const o=r.closest("[data-pos]");if(o){const e=o.getAttribute("data-pos");if(e&&!ue.current.has(e)){const[t,r]=e.split(",").map(Number);void 0!==t&&void 0!==r&&(Z({type:"toggle",row:t,col:r,reverse:2===le}),fe(e))}}};return window.addEventListener("mouseup",e),window.addEventListener("touchend",e),window.addEventListener("touchcancel",e),window.addEventListener("touchmove",t,{passive:!1}),()=>{window.removeEventListener("mouseup",e),window.removeEventListener("touchend",e),window.removeEventListener("touchcancel",e),window.removeEventListener("touchmove",t)}},[le,fe]);const ge=.4*J,pe=J-ge;return e.useEffect(()=>{if(!F.auto||F.solved)return;const e=setTimeout(()=>{Z({type:"nextLogical"})},j);return()=>{clearTimeout(e)}},[F.auto,F.solved,F.grid]),t.jsxs(g,{container:!0,minHeight:"100vh",flexDirection:"column",sx:{background:`radial-gradient(circle at 50% 50%, ${s.surface.elevated} 0%, ${s.surface.background} 100%)`,position:"relative",overflow:"hidden",height:"100vh",transition:"background 0.5s ease-in-out"},children:[t.jsx(S,{showHome:!0,infoUrl:"https://en.wikipedia.org/wiki/Gokigen_Naname"}),t.jsx(f,{onClick:()=>{h&&y(!1)},sx:{flex:1,position:"relative",width:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",padding:`${String(J)}rem`,overflowY:h?"auto":"visible",maxHeight:h?"calc(100vh - 100px)":"none",marginBottom:h?"0":"128px"},children:t.jsx(f,{onClick:e=>{e.stopPropagation()},children:h?t.jsx(ie,{rows:M,cols:P,numbers:F.numbers,size:J,initialMoves:Q,onMove:(e,t)=>{ee(r=>{const o=new Map(r);return void 0===t?o.delete(e):o.set(e,t),o})},onCopy:()=>{const e=new Map;F.grid.forEach((t,r)=>{t.forEach((t,o)=>{0!==t&&e.set(`${String(r)},${String(o)}`,t)})}),ee(e)},onClear:()=>{ee(new Map)}}):t.jsxs(t.Fragment,{children:[t.jsxs(f,{sx:{position:"relative",userSelect:"none"},children:[t.jsx(f,{sx:{position:"relative",zIndex:1},children:t.jsx(u,{size:J,rows:M,cols:P,cellProps:(e,r)=>{const o=F.grid[e]?.[r],n=`${String(e)},${String(r)}`,c=F.cycleCells.has(n);return{onMouseDown:t=>{F.solved||0!==t.button&&2!==t.button||Date.now()-de.current<I||(t.preventDefault(),ae(t.button),Z({type:"toggle",row:e,col:r,reverse:2===t.button}),fe(n))},onMouseEnter:()=>{null===le||ue.current.has(n)||F.solved||(Z({type:"toggle",row:e,col:r,reverse:2===le}),fe(n))},onContextMenu:e=>{e.preventDefault()},onTouchStart:t=>{F.solved||(t.cancelable&&t.preventDefault(),de.current=Date.now(),ae(0),Z({type:"toggle",row:e,col:r}),fe(n))},"data-pos":n,sx:{cursor:"pointer",border:`1px solid ${s.border.subtle}`,position:"relative",transition:"all 0.2s",touchAction:"none","&:hover":{backgroundColor:s.interactive.hover}},children:t.jsxs(f,{sx:{width:"100%",height:"100%",position:"relative"},children:[o===K&&t.jsx(f,{sx:{position:"absolute",width:"130%",height:"6px",backgroundColor:c?s.data.red:s.text.primary,borderRadius:"99px",top:"50%",left:"50%",transform:"translate(-50%, -50%) rotate(-45deg)",boxShadow:V.LINE,transition:i.transition,pointerEvents:"none"}}),o===X&&t.jsx(f,{sx:{position:"absolute",width:"130%",height:"6px",backgroundColor:c?s.data.red:s.text.primary,borderRadius:"99px",top:"50%",left:"50%",transform:"translate(-50%, -50%) rotate(45deg)",boxShadow:V.LINE,transition:i.transition,pointerEvents:"none"}})]})}},space:0,sx:{width:"fit-content"}})}),t.jsx(f,{sx:{position:"absolute",top:0,left:0,transform:`translate(-${String(ge/2)}rem, -${String(ge/2)}rem)`,zIndex:10,pointerEvents:"none"},children:t.jsx(u,{size:ge,rows:M+1,cols:P+1,cellProps:(e,r)=>{const o=F.numbers[e]?.[r],n=F.errorNodes.has(`${String(e)},${String(r)}`),i=F.satisfiedNodes.has(`${String(e)},${String(r)}`);return{children:t.jsx(f,{sx:{opacity:i&&!n?.2:1,transition:"opacity 0.3s"},children:o??""}),sx:{borderRadius:"50%",backgroundColor:n?s.data.red:s.surface.background,border:null!==o?`2px solid ${n?s.data.red:i?"transparent":s.border.subtle}`:"none",fontSize:`${String(.5*ge)}rem`,fontWeight:"800",color:n?U.WHITE:s.text.primary,boxShadow:i&&!n?"none":V.HINT,zIndex:5,opacity:null!==o?1:0,display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",userSelect:"none",WebkitUserSelect:"none",transform:n?"scale(1.1)":"scale(1)",position:"relative",pointerEvents:"none"}}},space:pe,sx:{width:"fit-content"}})})]}),t.jsx(f,{onClick:re,sx:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",opacity:F.solved?1:0,transform:F.solved?"scale(1)":"scale(0.5)",visibility:F.solved?"visible":"hidden",transition:"all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1)",zIndex:20,backgroundColor:"transparent",pointerEvents:oe?"auto":"none",cursor:oe?"pointer":"default",backdropFilter:"blur(2px)"},children:t.jsx(m,{sx:{fontSize:`${String(J)}rem`,color:s.primary.main,filter:`drop-shadow(0 0 30px ${s.primary.main}88)`,animation:F.solved?"float 3s ease-in-out infinite":"none","@keyframes float":{"0%, 100%":{transform:"translateY(0)"},"50%":{transform:"translateY(-10px)"}}}})})]})})}),t.jsxs(l,{handler:()=>()=>{},onAutoPlay:()=>{Z({type:"auto"})},autoPlayEnabled:F.auto,children:[t.jsx(n,{title:"Decrease Size",Icon:w,onClick:()=>{N(e=>e&&e>Y?e-1:Y)},disabled:M<=3||h}),t.jsx(n,{title:"Increase Size",Icon:v,onClick:()=>{N(e=>e?e+1:q-1)},disabled:M>=W||M>=k.rows&&P>=k.cols||h}),t.jsx(n,{title:h?"Close Calculator":"Open Calculator",Icon:x,onClick:()=>{y(!h)},sx:{color:h?s.primary.main:"inherit",backgroundColor:h?s.interactive.selected:"transparent"}})]})]})}export{ce as default};
