import{r as e,j as t}from"./vendor_react-WaSaIrII.js";import{L as o,g as r,a as n,A as s,S as i,d as c,e as l}from"./index-Cw6Ip_Yg.js";import{u as a,C as u,c as d}from"./CustomGrid-Chvy4iSa.js";import{B as f,G as g}from"./vendor_mui_core-D4-4kcvK.js";import{Y as p,Z as h,C as m,l as w,r as v,s as x,h as S}from"./vendor_mui_icons-urSXftat.js";import{G as b}from"./GlobalHeader-vTmNyFOK.js";import{u as y}from"./useWindow-BCvkQ8_7.js";const E="32px",$="48px",C=2e3,j=500,I=300,k=500,N="130%",M="6px",R="24px",L={MOBILE:64,DESKTOP:80},z=100,A=1e3,D=1200,T=.95,B=240,O=100,H=16,_="slant-size",G="slant-state",P="slant-ghost-moves",W=.35,q=3,J=10,U=5,Y=30,F={WHITE:"#fff"},K={LINE:"0 2px 4px rgba(0,0,0,0.2)",HINT:"0 4px 8px rgba(0,0,0,0.1)"},V={BORDER:"rgba(255, 255, 255, 0.1)",BG_SUBTLE:"rgba(255, 255, 255, 0.02)",BG_HOVER:"rgba(255, 255, 255, 0.1)",DASHED_BORDER:"rgba(255, 255, 255, 0.2)",HINT_BG:"hsl(217, 50%, 8%)",HINT_BORDER:"rgba(255, 255, 255, 0.3)"},X=1,Z=2;class Q{constructor(e){this.parent=Array.from({length:e},(e,t)=>t)}find(e){const t=this.parent[e];if(void 0===t)throw new Error("Index out of bounds");t!==e&&(this.parent[e]=this.find(t));const o=this.parent[e];if(void 0===o)throw new Error("Root not found");return o}union(e,t){const o=this.find(e),r=this.find(t);return o!==r&&(this.parent[o]=r,!0)}}function ee(e,t,o){return e*(o+1)+t}function te(e,t,o){const r=new Map,n=new Set;for(let a=0;a<t;a++)for(let t=0;t<o;t++){const n=e[a]?.[t];if(!n||0===n)continue;const s=ee(a,n===X?t+1:t,o),i=ee(a+1,n===X?t:t+1,o);r.has(s)||r.set(s,[]),r.has(i)||r.set(i,[]),r.get(s)?.push({node:i,r:a,c:t}),r.get(i)?.push({node:s,r:a,c:t})}const s=new Set,i=new Set,c=[],l=(e,t)=>{s.add(e),i.add(e);const o=r.get(e)??[];for(const{node:r,r:a,c:u}of o)if(r!==t)if(i.has(r)){n.add(`${String(a)},${String(u)}`);for(let e=c.length-1;e>=0;e--){const t=c[e];if(!t)break;if(n.add(`${String(t.r)},${String(t.c)}`),t.u===r||t.v===r)break}}else s.has(r)||(c.push({r:a,c:u,u:e,v:r}),l(r,e),c.pop());i.delete(e)};for(const a of r.keys())s.has(a)||l(a,-1);return n}function oe(e,t,o){const r=new Q((t+1)*(o+1));for(let n=0;n<t;n++){const t=e[n];if(t)for(let e=0;e<o;e++){const s=t[e];if(void 0===s||0===s)continue;const i=ee(n,s===X?e+1:e,o),c=ee(n+1,s===X?e:e+1,o);if(!r.union(i,c))return!0}}return!1}function re(e,t,o){const r=Array.from({length:t+1},()=>Array(o+1).fill(0));for(let n=0;n<t;n++){const t=e[n];if(t)for(let e=0;e<o;e++){const o=t[e];if(o===X){const t=r[n];if(t){const o=t[e+1];void 0!==o&&(t[e+1]=o+1)}const o=r[n+1];if(o){const t=o[e];void 0!==t&&(o[e]=t+1)}}else if(o===Z){const t=r[n];if(t){const o=t[e];void 0!==o&&(t[e]=o+1)}const o=r[n+1];if(o){const t=o[e+1];void 0!==t&&(o[e+1]=t+1)}}}}return r}function ne(e,t,o){const r=Array.from({length:t},()=>Array(o).fill(0));let n=!0;for(;n;){n=!1;for(let s=0;s<=t;s++)for(let i=0;i<=o;i++){const c=e[s]?.[i];if(null==c)continue;const l=[{gr:s-1,gc:i-1,pt:Z},{gr:s-1,gc:i,pt:X},{gr:s,gc:i-1,pt:X},{gr:s,gc:i,pt:Z}].filter(({gr:e,gc:r})=>e>=0&&e<t&&r>=0&&r<o);let a=0;const u=[];for(const e of l){const t=r[e.gr]?.[e.gc];0===t?u.push(e):t===e.pt&&a++}if(a===c&&u.length>0)for(const{gr:e,gc:t,pt:o}of u){const s=r[e];s&&(s[t]=o===X?Z:X,n=!0)}else if(a+u.length===c&&u.length>0)for(const{gr:e,gc:t,pt:o}of u){const s=r[e];s&&(s[t]=o,n=!0)}}if(!n)for(let e=0;e<t;e++)for(let s=0;s<o;s++){const i=r[e];if(0===i?.[s])if(i[s]=X,oe(r,t,o)){if(i[s]=Z,n=!0,oe(r,t,o))return!1}else if(i[s]=Z,oe(r,t,o)){if(i[s]=X,n=!0,oe(r,t,o))return!1}else i[s]=0}}if(!r.every(e=>e.every(e=>0!==e)))return!1;const s=re(r,t,o);for(let i=0;i<=t;i++)for(let t=0;t<=o;t++){const o=e[i]?.[t];if(null!=o&&s[i]?.[t]!==o)return!1}return!oe(r,t,o)}function se(e,t){const o=Array.from({length:e},()=>Array(t).fill(X)),r=e*t*Y;for(let l=0;l<r;l++){const r=Math.floor(Math.random()*e),n=Math.floor(Math.random()*t),s=o[r];if(!s)continue;const i=s[n];void 0!==i&&(s[n]=i===X?Z:X,oe(o,e,t)&&(s[n]=i))}const n=re(o,e,t).map(e=>[...e]),s=[];for(let l=0;l<=e;l++)for(let e=0;e<=t;e++)s.push({r:l,c:e});for(let l=s.length-1;l>0;l--){const e=Math.floor(Math.random()*(l+1)),t=s[l],o=s[e];t&&o&&(s[l]=o,s[e]=t)}const i=Math.floor((e+1)*(t+1)*W);let c=(e+1)*(t+1);for(const{r:l,c:a}of s){if(c<=i)continue;const o=n[l];if(!o)continue;const r=o[a];null!=r&&(o[a]=null,ne(n,e,t)?c--:o[a]=r)}return{numbers:n,solution:o}}function ie(e,t){switch(t.type){case"toggle":{if(e.solved)return e;const{row:o,col:r}=t,n=e.grid.map(e=>[...e]),s=n[o];if(!s)return e;const i=s[r];if(void 0===i)return e;t.reverse?s[r]=0===i?Z:i===Z?X:0:s[r]=0===i?X:i===X?Z:0;let c=!1;if(n.every(e=>e.every(e=>0!==e))){const t=re(n,e.rows,e.cols);e.numbers.every((e,o)=>e.every((e,r)=>null===e||e===t[o]?.[r]))&&!oe(n,e.rows,e.cols)&&(c=!0)}const l=function(e,t,o,r){const n=new Set,s=re(e,o,r);for(let i=0;i<=o;i++)for(let c=0;c<=r;c++){const l=t[i]?.[c];if(null==l)continue;const a=s[i]?.[c]??0;a>l?n.add(`${String(i)},${String(c)}`):a+[{gr:i-1,gc:c-1},{gr:i-1,gc:c},{gr:i,gc:c-1},{gr:i,gc:c}].filter(({gr:t,gc:n})=>t>=0&&t<o&&n>=0&&n<r&&0===e[t]?.[n]).length<l&&n.add(`${String(i)},${String(c)}`)}return n}(n,e.numbers,e.rows,e.cols),a=te(n,e.rows,e.cols),u=function(e,t,o,r){const n=new Set,s=re(e,o,r);for(let i=0;i<=o;i++)for(let e=0;e<=r;e++){const o=t[i]?.[e];null!=o&&((s[i]?.[e]??0)===o&&n.add(`${String(i)},${String(e)}`))}return n}(n,e.numbers,e.rows,e.cols);return{...e,grid:n,solved:c,auto:!c&&e.auto,errorNodes:l,cycleCells:a,satisfiedNodes:u}}case"auto":return{...e,auto:!e.auto};case"nextLogical":{const t=function(e){const{grid:t,numbers:o,rows:r,cols:n}=e;for(let s=0;s<=r;s++)for(let e=0;e<=n;e++){const i=o[s]?.[e];if(null==i)continue;const c=[{gr:s-1,gc:e-1,pt:Z},{gr:s-1,gc:e,pt:X},{gr:s,gc:e-1,pt:X},{gr:s,gc:e,pt:Z}].filter(({gr:e,gc:t})=>e>=0&&e<r&&t>=0&&t<n);let l=0;const a=[];for(const e of c){const o=t[e.gr]?.[e.gc];0===o?a.push(e):o===e.pt&&l++}if(a.length>0)if(l===i){const e=a[0];if(e)return{row:e.gr,col:e.gc,reverse:e.pt===X}}else if(l+a.length===i){const e=a[0];if(e)return{row:e.gr,col:e.gc,reverse:e.pt===Z}}}for(let s=0;s<r;s++)for(let e=0;e<n;e++){if(0!==t[s]?.[e])continue;const o=t.map(e=>[...e]),i=o[s];if(i){if(i[e]=X,oe(o,r,n))return{row:s,col:e,reverse:!0};if(i[e]=Z,oe(o,r,n))return{row:s,col:e,reverse:!1}}}for(let s=0;s<r;s++)for(let o=0;o<n;o++){const r=t[s]?.[o],n=e.solution[s]?.[o];if(0!==r&&r!==n&&void 0!==n)return{row:s,col:o,reverse:n===Z}}return null}(e);return t?ie(e,{type:"toggle",...t}):{...e,auto:!1}}case"hydrate":return{...t.state,auto:!1};case"resize":{if(t.rows<q||t.cols<q)return e;const{numbers:o,solution:r}=se(t.rows,t.cols);return{grid:Array.from({length:t.rows},()=>Array(t.cols).fill(0)),numbers:o,solution:r,rows:t.rows,cols:t.cols,solved:!1,auto:!1,errorNodes:new Set,cycleCells:new Set,satisfiedNodes:new Set}}case"new":{const{numbers:t,solution:o}=se(e.rows,e.cols);return{...e,grid:Array.from({length:e.rows},()=>Array(e.cols).fill(0)),numbers:t,solution:o,solved:!1,auto:!1,errorNodes:new Set,cycleCells:new Set,satisfiedNodes:new Set}}default:return e}}const ce=({rows:c,cols:l,numbers:d,size:g,initialMoves:w,onMove:v,onCopy:x,onClear:S,onClose:b})=>{const y=a("sm"),C=w,[j,I]=e.useState(null),L=e.useRef(void 0),z=e.useRef(new Set),A=e.useRef(0),D=e.useCallback(e=>{z.current.add(e)},[]);e.useEffect(()=>{const e=()=>{I(null),z.current.clear(),L.current=void 0},t=e=>{if(null===j)return;const t=e.touches[0];if(!t)return;const o=document.elementFromPoint(t.clientX,t.clientY);if(!o)return;const r=o.closest("[data-pos]");if(r){const e=r.getAttribute("data-pos");e&&!z.current.has(e)&&(v(e,L.current),D(e))}};return window.addEventListener("mouseup",e),window.addEventListener("touchend",e),window.addEventListener("touchcancel",e),window.addEventListener("touchmove",t,{passive:!1}),()=>{window.removeEventListener("mouseup",e),window.removeEventListener("touchend",e),window.removeEventListener("touchcancel",e),window.removeEventListener("touchmove",t)}},[j,D,v]);const[T,B]=e.useState(new Map),[O,H]=e.useState([]),[_,G]=e.useState(new Set);e.useEffect(()=>{const e=new Map,t=[],o=[];C.forEach((o,r)=>{e.set(r,{state:o,source:"user"});const[n,s]=r.split(",").map(Number);void 0!==n&&void 0!==s&&t.push({r:n,c:s})});const r=(t,o)=>{if(t<0||t>=c||o<0||o>=l)return 0;const r=`${String(t)},${String(o)}`;return e.get(r)?.state??0},n=(r,n,s,i)=>{const c=`${String(r)},${String(n)}`,l=e.get(c);l?l.state!==s&&o.push({type:"cell",r:r,c:n}):(e.set(c,{state:s,source:i}),t.push({r:r,c:n}))},s=(e,t)=>[{r:e-1,c:t-1,required:Z},{r:e-1,c:t,required:X},{r:e,c:t-1,required:X},{r:e,c:t,required:Z}].filter(e=>e.r>=0&&e.r<c&&e.c>=0&&e.c<l);let i=0;for(;i<t.length;){const c=t[i++];if(!c)break;const{r:l,c:a}=c,u=[{r:l,c:a},{r:l,c:a+1},{r:l+1,c:a},{r:l+1,c:a+1}];for(const t of u){const i=d[t.r]?.[t.c];if(null==i)continue;const c=s(t.r,t.c);let u=0;const f=[];for(const e of c){const t=r(e.r,e.c);0===t?f.push(e):t===e.required&&u++}if(u>i)o.push({type:"node",r:t.r,c:t.c});else if(u+f.length<i)o.push({type:"node",r:t.r,c:t.c});else if("user"===e.get(`${String(l)},${String(a)}`)?.source)if(u===i&&f.length>0)for(const e of f){const t=e.required===X?Z:X;n(e.r,e.c,t,"propagated")}else if(u+f.length===i&&f.length>0)for(const e of f)n(e.r,e.c,e.required,"propagated")}}const a=Array.from({length:c},()=>Array(l).fill(0));e.forEach((e,t)=>{const[o,r]=t.split(",").map(Number);void 0!==o&&void 0!==r&&a[o]&&(a[o][r]=e.state)});const u=te(a,c,l);B(e),H(o),G(u)},[C,d,c,l]);const P=.4*g,W=g-P,q=e.useMemo(()=>new Set(O.filter(e=>"cell"===e.type).map(e=>`${String(e.r)},${String(e.c)}`)),[O]),J=e.useMemo(()=>new Set(O.filter(e=>"node"===e.type).map(e=>`${String(e.r)},${String(e.c)}`)),[O]);return t.jsxs(f,{sx:{position:"relative",userSelect:"none"},children:[t.jsxs(f,{sx:{position:"relative",padding:y?E:$,border:`2px dashed ${V.DASHED_BORDER}`,borderRadius:R},children:[t.jsx(f,{sx:{position:"relative",zIndex:o.zIndex.base+1},children:t.jsx(u,{size:g,rows:c,cols:l,cellProps:(e,o)=>{const r=`${String(e)},${String(o)}`,c=T.get(r),l=c?.state??0,a=c?.source,u=q.has(r),d=_.has(r);let g=n.text.primary;return u?g=n.data.red:d?g="user"===a?n.data.red:"#ff9800":"user"===a?g=n.primary.main:"propagated"===a&&(g=n.data.green),{onContextMenu:e=>{e.preventDefault()},onMouseDown:e=>{if(0!==e.button&&2!==e.button)return;if(Date.now()-A.current<k)return;e.preventDefault();const t=C.get(r);let o;o=2===e.button?t===Z?X:t===X?void 0:Z:t===X?Z:t===Z?void 0:X,L.current=o,I(e.button),v(r,o),D(r)},onMouseEnter:()=>{null===j||z.current.has(r)||(v(r,L.current),D(r))},onTouchStart:e=>{e.cancelable&&e.preventDefault(),A.current=Date.now();const t=C.get(r),o=t===X?Z:t===Z?void 0:X;L.current=o,I(0),v(r,o),D(r)},"data-pos":r,"data-type":"cell",sx:{cursor:"pointer",border:`1px solid ${V.BORDER}`,position:"relative",transition:"all 0.2s",touchAction:"none",backgroundColor:V.BG_SUBTLE,"&:hover":{backgroundColor:V.BG_HOVER}},children:t.jsxs(f,{sx:{width:"100%",height:"100%",position:"relative"},children:[l===X&&t.jsx(f,{sx:{position:"absolute",width:N,height:M,backgroundColor:g,borderRadius:i.borderRadius.full,top:"50%",left:"50%",transform:"translate(-50%, -50%) rotate(-45deg)",boxShadow:K.LINE,transition:s.transition,pointerEvents:"none"}}),l===Z&&t.jsx(f,{sx:{position:"absolute",width:N,height:M,backgroundColor:g,borderRadius:i.borderRadius.full,top:"50%",left:"50%",transform:"translate(-50%, -50%) rotate(45deg)",boxShadow:K.LINE,transition:s.transition,pointerEvents:"none"}})]})}},space:0,sx:{width:"fit-content"}})}),t.jsx(f,{sx:{position:"absolute",top:y?E:$,left:y?E:$,transform:`translate(-${String(P/2)}rem, -${String(P/2)}rem)`,zIndex:o.zIndex.base+2,pointerEvents:"none"},children:t.jsx(u,{size:P,rows:c+1,cols:l+1,cellProps:(e,o)=>{const r=d[e]?.[o],s=J.has(`${String(e)},${String(o)}`);return{"data-pos":`${String(e)},${String(o)}`,"data-type":"hint",children:t.jsx(f,{children:r??""}),sx:{borderRadius:"50%",backgroundColor:s?n.data.red:V.HINT_BG,border:null!==r?`2px solid ${s?n.data.red:V.HINT_BORDER}`:"none",fontSize:`${String(.5*P)}rem`,fontWeight:"800",color:F.WHITE,zIndex:5,opacity:null!==r?1:0,display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",userSelect:"none",WebkitUserSelect:"none",transform:s?"scale(1.1)":"scale(1)",position:"relative",pointerEvents:"none"}}},space:W,sx:{width:"fit-content"}})})]}),t.jsxs(f,{sx:{display:"flex",justifyContent:"center",gap:2,marginTop:3,marginBottom:4,pointerEvents:"auto"},children:[t.jsx(r,{title:"Copy Board",Icon:p,onClick:x,sx:{backgroundColor:n.interactive.selected,color:n.primary.main,"&:hover":{backgroundColor:n.interactive.focus}}}),t.jsx(r,{title:"Clear Calculator",Icon:h,onClick:S,sx:{backgroundColor:"rgba(255, 68, 68, 0.1)",color:n.data.red,"&:hover":{backgroundColor:"rgba(255, 68, 68, 0.2)"}}}),t.jsx(r,{title:"Close Calculator",Icon:m,onClick:b,sx:{backgroundColor:"rgba(255, 193, 7, 0.1)",color:n.data.amber,"&:hover":{backgroundColor:"rgba(255, 193, 7, 0.2)"}}})]})]})};function le(){const{height:o,width:i}=y(),p=a("sm"),[h,m]=e.useState(!1),[E,$]=e.useState(()=>{const e=localStorage.getItem(_);return e&&"null"!==e?parseInt(e,10):U}),N=e.useMemo(()=>{const e=p?L.MOBILE:L.DESKTOP,t=d(4,o-e-z,Math.min(i,A));let r=t.rows-1;const n=t.cols-1;return p&&(r-=2),{rows:Math.max(q,r),cols:Math.max(q,n)}},[o,i,p]),{rows:M,cols:R}=e.useMemo(()=>{const e=E??U;return{rows:Math.min(e,N.rows),cols:Math.min(e,N.cols)}},[E,N]),W=e.useMemo(()=>{const e=Math.min(i,D)*T/(R+1),t=(o-B)*T/(M+1);return Math.min(e,t,O)/H},[i,o,M,R]),[Y,V]=e.useReducer(ie,{rows:M,cols:R},e=>{const t=localStorage.getItem(G);if(t)try{const o=JSON.parse(t);if(o.rows===e.rows&&o.cols===e.cols)return{...o,errorNodes:new Set(o.errorNodes),cycleCells:new Set(o.cycleCells),satisfiedNodes:new Set(o.satisfiedNodes)}}catch(o){}return function(e,t){const{numbers:o,solution:r}=se(e,t);return{grid:Array.from({length:e},()=>Array(t).fill(0)),numbers:o,solution:r,rows:e,cols:t,solved:!1,auto:!1,errorNodes:new Set,cycleCells:new Set,satisfiedNodes:new Set}}(e.rows,e.cols)});e.useEffect(()=>{localStorage.setItem(_,String(E))},[E]),e.useEffect(()=>{if(Y.rows!==M||Y.cols!==R){const t=`${G}-${String(M)}x${String(R)}`,o=localStorage.getItem(t);if(o)try{const e=JSON.parse(o);return void V({type:"hydrate",state:{...e,errorNodes:new Set(e.errorNodes),cycleCells:new Set(e.cycleCells),satisfiedNodes:new Set(e.satisfiedNodes)}})}catch(e){}V({type:"resize",rows:M,cols:R})}},[M,R,Y.rows,Y.cols]);const[Q,ee]=e.useState(new Map);e.useEffect(()=>{const e=`${P}-${String(Y.rows)}x${String(Y.cols)}`,t=localStorage.getItem(e);if(t)try{ee(new Map(JSON.parse(t)))}catch(o){ee(new Map)}else ee(new Map)},[Y.numbers,Y.rows,Y.cols]),e.useEffect(()=>{const e=`${G}-${String(Y.rows)}x${String(Y.cols)}`,t=`${P}-${String(Y.rows)}x${String(Y.cols)}`,o=Y.grid.some(e=>e.some(e=>0!==e)),r=Q.size>0;if(!o&&!r)return localStorage.removeItem(e),void localStorage.removeItem(t);const n={...Y,errorNodes:Array.from(Y.errorNodes),cycleCells:Array.from(Y.cycleCells),satisfiedNodes:Array.from(Y.satisfiedNodes)};localStorage.setItem(e,JSON.stringify(n)),r?localStorage.setItem(t,JSON.stringify(Array.from(Q.entries()))):localStorage.removeItem(t)},[Y,Q]);const te=e.useRef("");e.useEffect(()=>{const e=JSON.stringify(Y.numbers);te.current&&te.current!==e&&ee(new Map),te.current=e},[Y.numbers,Y.rows,Y.cols]),e.useEffect(()=>{document.title=c.slant},[]);const oe=e.useCallback(()=>{V({type:"new"})},[V]);e.useEffect(()=>{if(Y.solved){const e=setTimeout(()=>{oe()},C);return()=>{clearTimeout(e)}}},[Y.solved,oe]);const[re,ne]=e.useState(!1);e.useEffect(()=>{if(Y.solved){const e=setTimeout(()=>{ne(!0)},j);return()=>{clearTimeout(e)}}ne(!1)},[Y.solved]);const[le,ae]=e.useState(null),ue=e.useRef(new Set),de=e.useRef(0),fe=e.useCallback(e=>{ue.current.add(e)},[]);e.useEffect(()=>{const e=()=>{ae(null),ue.current.clear()},t=e=>{if(null===le)return;const t=e.touches[0];if(!t)return;const o=document.elementFromPoint(t.clientX,t.clientY);if(!o)return;const r=o.closest("[data-pos]");if(r){const e=r.getAttribute("data-pos");if(e&&!ue.current.has(e)){const[t,o]=e.split(",").map(Number);void 0!==t&&void 0!==o&&(V({type:"toggle",row:t,col:o,reverse:2===le}),fe(e))}}};return window.addEventListener("mouseup",e),window.addEventListener("touchend",e),window.addEventListener("touchcancel",e),window.addEventListener("touchmove",t,{passive:!1}),()=>{window.removeEventListener("mouseup",e),window.removeEventListener("touchend",e),window.removeEventListener("touchcancel",e),window.removeEventListener("touchmove",t)}},[le,fe]);const ge=.4*W,pe=W-ge;return e.useEffect(()=>{if(!Y.auto||Y.solved)return;const e=setTimeout(()=>{V({type:"nextLogical"})},I);return()=>{clearTimeout(e)}},[Y.auto,Y.solved,Y.grid]),t.jsxs(g,{container:!0,minHeight:"100vh",flexDirection:"column",sx:{background:`radial-gradient(circle at 50% 50%, ${n.surface.elevated} 0%, ${n.surface.background} 100%)`,position:"relative",overflow:"hidden",height:"100vh",transition:"background 0.5s ease-in-out"},children:[t.jsx(b,{showHome:!0,infoUrl:"https://en.wikipedia.org/wiki/Gokigen_Naname"}),t.jsx(f,{onClick:()=>{h&&m(!1)},sx:{flex:1,position:"relative",width:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",padding:`${String(W)}rem`,maxHeight:h?"calc(100vh - 100px)":"none",marginBottom:h?"0":p?"152px":"128px",overflow:"hidden"},children:t.jsx(f,{onClick:e=>{e.stopPropagation()},children:h?t.jsx(ce,{rows:M,cols:R,numbers:Y.numbers,size:W,initialMoves:Q,onMove:(e,t)=>{ee(o=>{const r=new Map(o);return void 0===t?r.delete(e):r.set(e,t),r})},onCopy:()=>{const e=new Map;Y.grid.forEach((t,o)=>{t.forEach((t,r)=>{0!==t&&e.set(`${String(o)},${String(r)}`,t)})}),ee(e)},onClear:()=>{ee(new Map)},onClose:()=>{m(!1)}}):t.jsxs(t.Fragment,{children:[t.jsxs(f,{sx:{position:"relative",userSelect:"none"},children:[t.jsx(f,{sx:{position:"relative",zIndex:1},children:t.jsx(u,{size:W,rows:M,cols:R,cellProps:(e,o)=>{const r=Y.grid[e]?.[o],i=`${String(e)},${String(o)}`,c=Y.cycleCells.has(i);return{onMouseDown:t=>{Y.solved||0!==t.button&&2!==t.button||Date.now()-de.current<k||(t.preventDefault(),ae(t.button),V({type:"toggle",row:e,col:o,reverse:2===t.button}),fe(i))},onMouseEnter:()=>{null===le||ue.current.has(i)||Y.solved||(V({type:"toggle",row:e,col:o,reverse:2===le}),fe(i))},onContextMenu:e=>{e.preventDefault()},onTouchStart:t=>{Y.solved||(t.cancelable&&t.preventDefault(),de.current=Date.now(),ae(0),V({type:"toggle",row:e,col:o}),fe(i))},"data-pos":i,sx:{cursor:"pointer",border:`1px solid ${n.border.subtle}`,position:"relative",transition:"all 0.2s",touchAction:"none","&:hover":{backgroundColor:n.interactive.hover}},children:t.jsxs(f,{sx:{width:"100%",height:"100%",position:"relative"},children:[r===X&&t.jsx(f,{sx:{position:"absolute",width:"130%",height:"6px",backgroundColor:c?n.data.red:n.text.primary,borderRadius:"99px",top:"50%",left:"50%",transform:"translate(-50%, -50%) rotate(-45deg)",boxShadow:K.LINE,transition:s.transition,pointerEvents:"none"}}),r===Z&&t.jsx(f,{sx:{position:"absolute",width:"130%",height:"6px",backgroundColor:c?n.data.red:n.text.primary,borderRadius:"99px",top:"50%",left:"50%",transform:"translate(-50%, -50%) rotate(45deg)",boxShadow:K.LINE,transition:s.transition,pointerEvents:"none"}})]})}},space:0,sx:{width:"fit-content"}})}),t.jsx(f,{sx:{position:"absolute",top:0,left:0,transform:`translate(-${String(ge/2)}rem, -${String(ge/2)}rem)`,zIndex:10,pointerEvents:"none"},children:t.jsx(u,{size:ge,rows:M+1,cols:R+1,cellProps:(e,o)=>{const r=Y.numbers[e]?.[o],s=Y.errorNodes.has(`${String(e)},${String(o)}`),i=Y.satisfiedNodes.has(`${String(e)},${String(o)}`);return{children:t.jsx(f,{sx:{opacity:i&&!s?.2:1,transition:"opacity 0.3s"},children:r??""}),sx:{borderRadius:"50%",backgroundColor:s?n.data.red:n.surface.background,border:null!==r?`2px solid ${s?n.data.red:i?"transparent":n.border.subtle}`:"none",fontSize:`${String(.5*ge)}rem`,fontWeight:"800",color:s?F.WHITE:n.text.primary,boxShadow:i&&!s?"none":K.HINT,zIndex:5,opacity:null!==r?1:0,display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",userSelect:"none",WebkitUserSelect:"none",transform:s?"scale(1.1)":"scale(1)",position:"relative",pointerEvents:"none"}}},space:pe,sx:{width:"fit-content"}})})]}),t.jsx(f,{onClick:oe,sx:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",opacity:Y.solved?1:0,transform:Y.solved?"scale(1)":"scale(0.5)",visibility:Y.solved?"visible":"hidden",transition:"all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1)",zIndex:20,backgroundColor:"transparent",pointerEvents:re?"auto":"none",cursor:re?"pointer":"default",backdropFilter:"blur(2px)"},children:t.jsx(w,{sx:{fontSize:`${String(W)}rem`,color:n.primary.main,filter:`drop-shadow(0 0 30px ${n.primary.main}88)`,animation:Y.solved?"float 3s ease-in-out infinite":"none","@keyframes float":{"0%, 100%":{transform:"translateY(0)"},"50%":{transform:"translateY(-10px)"}}}})})]})})}),!h&&t.jsxs(l,{handler:()=>()=>{},onAutoPlay:()=>{V({type:"auto"})},autoPlayEnabled:Y.auto,children:[t.jsx(r,{title:"Decrease Size",Icon:v,onClick:()=>{$(e=>e&&e>q?e-1:q)},disabled:M<=3}),t.jsx(r,{title:"Increase Size",Icon:x,onClick:()=>{$(e=>e?e+1:U-1)},disabled:M>=J||M>=N.rows&&R>=N.cols}),t.jsx(r,{title:"Open Calculator",Icon:S,onClick:()=>{m(!h)}})]})]})}export{le as default};
