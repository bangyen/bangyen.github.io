import{r as z,j as i}from"./vendor_react-CiGj4Onb.js";import{a as y,T as F,R as $t,d as ot,e as At,L as rt}from"./index-aPQk9d5W.js";import{g as st,c as Pt,a as it,B as at,u as Bt,b as Rt,d as Dt,e as Tt,G as Ot,f as Mt,h as Et,i as H,j as ct}from"./GameErrorBoundary-De5KTNZ0.js";import{G as Ft}from"./GlassCard-Dg-JYzyH.js";import{b as lt,K as Wt,c as Lt,d as Ut,E as Nt,R as Ht,N as Kt,e as Gt,f as Yt,g as dt,M as qt}from"./vendor_mui_icons-88WVDz42.js";import{d as T,B as h,G as K,e as G,M as Xt,h as Zt,I as ut}from"./vendor_mui_core-Cb6gYFA4.js";import{C as Y,u as Jt}from"./layout-Bo_09a4v.js";import"./GlobalHeader-CLOzPJK4.js";function ft(t,e){const o=z.useCallback((s,a)=>{const l=t(s,a);return{front:l?e.primary:e.secondary,back:l?e.secondary:e.primary}},[t,e]),n=z.useCallback((s,a)=>(function(l,u,d){const c=d(l,u),f={},p=c===d(l-1,u),x=c===d(l+1,u),m=c===d(l,u-1),j=c===d(l,u+1);return(p||m)&&(f.borderTopLeftRadius=0),(p||j)&&(f.borderTopRightRadius=0),(x||m)&&(f.borderBottomLeftRadius=0),(x||j)&&(f.borderBottomRightRadius=0),f})(s,a,t),[t]),r=z.useCallback((s,a)=>(function(u,d,c){const f=c(u,d),p=c(u,d+1),x=c(u+1,d),m=c(u+1,d+1);let j=!0;return f&&m||!(f+p+x+m<3)||(j=!1),j})(s,a,t)?e.primary:e.secondary,[t,e]);return z.useMemo(()=>({getColor:o,getBorder:n,getFiller:r}),[o,n,r])}function pt(t,e){const{grid:o,rows:n,cols:r}=t;return ft(z.useCallback((s,a)=>{if(s<0||a<0||s>=n||a>=r)return-1;const l=o[s];return l===void 0?0:l>>a&1},[o,n,r]),e)}function xt(t){const e=Array(t).fill(1n);for(let o=0;o<t;o++){const n=e[o];n!==void 0&&(e[o]=n<<BigInt(t-o-1))}return e}function Qt(t,e){const o=t.length,n=[];for(let r=0;r<o;r++){const s=t[r],a=e[r];s!==void 0&&a!==void 0&&n.push(s^a)}return n}function mt(t,e){const o=t.length,n=[];for(let r=0;r<o;r++){const s=t[r];let a=0n;if(s!==void 0){for(let l=0;l<o;l++)if(s&1n<<BigInt(o-1-l)){const u=e[l];u!==void 0&&(a^=u)}}n.push(a)}return n}function Vt(t,e,o){let n=xt(t.length),r=[...t],s=e;for(;s>0;)s%2==1&&(n=mt(n,r)),r=mt(r,r),s=Math.floor(s/2);return n}function te(t,e){const o=t.length,n=[...Array(o).keys()].sort((r,s)=>{const a=t[s],l=t[r];return a===void 0||l===void 0?0:a>l?1:a<l?-1:0});return[n.map(r=>t[r]??0n),n.map(r=>e[r]??0n)]}function gt(t){const e=t.length;let o=t,n=xt(e);for(let r=0;r<e;r++){const s=1n<<BigInt(e-r-1);[o,n]=te(o,n);for(let a=0;a<e;a++){const l=o[a];if(l!==void 0&&a!==r&&l&s){const u=o[r],d=n[r];if(u!==void 0){const c=o[a];c!==void 0&&(o[a]=c^u)}if(d!==void 0){const c=n[a];c!==void 0&&(n[a]=c^d)}}}}return n}function ee(t,e){const o=(function(u,d){const c=d(8*u.length,8)>>>0;return ht().set(u,c/8),yt=u.length,c})(t,I.__wbindgen_malloc),n=yt,r=I.invert_matrix(o,n,e);if(r[3])throw(function(u){const d=I.__wbindgen_externrefs.get(u);return I.__externref_table_dealloc(u),d})(r[2]);var s,a,l=(s=r[0],a=r[1],s>>>=0,ht().subarray(s/8,s/8+a)).slice();return I.__wbindgen_free(r[0],8*r[1],8),l}function ne(){return{__proto__:null,"./lights_out_wasm_bg.js":{__proto__:null,__wbindgen_cast_0000000000000001:function(t,e){var o;return o=t,(function(n,r){return J+=r,J>=oe&&(q=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}),q.decode(),J=r),q.decode((L!==null&&L.byteLength!==0||(L=new Uint8Array(I.memory.buffer)),L).subarray(n,n+r))})(o>>>=0,e)},__wbindgen_init_externref_table:function(){const t=I.__wbindgen_externrefs,e=t.grow(4);t.set(0,void 0),t.set(e+0,void 0),t.set(e+1,null),t.set(e+2,!0),t.set(e+3,!1)}}}}let W=null;function ht(){return W!==null&&W.byteLength!==0||(W=new BigUint64Array(I.memory.buffer)),W}let L=null,q=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});q.decode();const oe=2146435072;let J=0,I,yt=0;(async function(t){if(I!==void 0)return I;t!==void 0&&Object.getPrototypeOf(t)===Object.prototype&&({module_or_path:t}=t),t===void 0&&(t=new URL("/assets/lights_out_wasm_bg-v4oeX7rw.wasm",import.meta.url));const e=ne();(typeof t=="string"||typeof Request=="function"&&t instanceof Request||typeof URL=="function"&&t instanceof URL)&&(t=fetch(t));const{instance:o}=await(async function(n,r){if(typeof Response=="function"&&n instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(n,r)}catch(a){if(!n.ok||!(function(l){switch(l){case"basic":case"cors":case"default":return!0}return!1})(n.type)||n.headers.get("Content-Type")==="application/wasm")throw a}const s=await n.arrayBuffer();return await WebAssembly.instantiate(s,r)}{const s=await WebAssembly.instantiate(n,r);return s instanceof WebAssembly.Instance?{instance:s,module:n}:s}})(await t,e);return(function(n){return I=n.exports,W=null,L=null,I.__wbindgen_start(),I})(o)})().catch(t=>{});const U={};function bt(t,e,o){const n=st(e,o);if(!U[n]){const l=(function(d){if(d===1)return[1n];const c=[7n<<BigInt(d-2)];for(let p=1;p<d;p++){const x=c[p-1];if(x!==void 0){const m=x>>1n;c.push(m)}}const f=c[0];return f!==void 0&&(c[0]=f-(1n<<BigInt(d))),c})(o),u=(function(d,c){const f=d.length;let p=Array(f).fill(0n),x=0,m=c;for(;m>0n;)1n&m&&(p=Qt(p,Vt(d,x))),m>>=1n,x++;return p})(l,(function(d){const c=[0n,1n];for(let f=1;f<d;f++){const p=c[f],x=c[f-1];if(p!==void 0&&x!==void 0){const m=p<<1n;c.push(m^x)}}return c[d]??0n})(e+1));if(o<=64)try{const d=ee(new BigUint64Array(u.map(c=>BigInt.asUintN(64,c))),u.length);U[n]=Array.from(d)}catch{U[n]=gt(u)}else U[n]=gt(u)}const r=U[n],s=t.join(""),a=s?BigInt("0b"+s):0n;if(r===void 0)throw new Error("Inverse matrix not found in cache");return r.map(l=>1&(function(u){let d=0,c=u;if(c<0n)throw new Error("countBits called on negative bigint");for(;c>0n;)c&=c-1n,d++;return d})(l&a))}function Q(t,e){return Array.from({length:t},()=>0)}function N(t,e,o,n,r){const s=[...o];let a=1<<e;if(e>0&&(a|=1<<e-1),e<r-1&&(a|=1<<e+1),s[t]!==void 0&&(s[t]^=a),t>0){const l=s[t-1];l!==void 0&&(s[t-1]=l^1<<e)}if(t<n-1){const l=s[t+1];l!==void 0&&(s[t+1]=l^1<<e)}return s}function jt(t,e,o,n,r){let s=1<<e;if(e>0&&(s|=1<<e-1),e<r-1&&(s|=1<<e+1),o[t]!==void 0&&(o[t]^=s),t>0){const a=o[t-1];a!==void 0&&(o[t-1]=a^1<<e)}if(t<n-1){const a=o[t+1];a!==void 0&&(o[t+1]=a^1<<e)}}function V(t,e){const o=Q(t);for(let n=0;n<t;n++)for(let r=0;r<e;r++)Math.random()>.5&&jt(n,r,o,t,e);return o}function X(t,e){return{grid:Q(t),score:0,rows:it(t),cols:it(e),initialized:!1}}const re=Pt({getInitialState:X,customHandler:(t,e)=>{const{rows:o,cols:n}=t;switch(e.type){case"adjacent":return{...t,grid:N(e.row,e.col,t.grid,o,n)};case"multi_adjacent":{const r=[...t.grid];return e.moves.forEach(({row:s,col:a})=>{jt(s,a,r,o,n)}),{...t,grid:r}}case"random":case"randomize":return{...t,grid:V(o,n),initialized:!0};case"resize":{const r=e.newRows??e.rows??t.rows,s=e.newCols??e.cols??t.cols;return{...X(r,s),grid:V(r,s),initialized:!0}}case"new":case"next":return{...X(o,n),grid:V(o,n),score:t.score+1,initialized:!0}}return t}}),tt={FAST:"background-color 100ms ease-in-out, color 100ms ease-in-out, opacity 100ms ease-in-out, border-radius 100ms ease-in-out",DEFAULT:"background-color 200ms ease, color 200ms ease, opacity 200ms ease, border-radius 200ms ease"},wt={DROP:"drop-shadow(0 2px 4px rgba(0,0,0,0.2))"},se=1.25,St={MOBILE:-28,DESKTOP:-40},ie="lights-out-size",ae="lights-out-state";function et({getColor:t,getBorder:e}){return(o,n)=>{const{front:r}=t(o,n);return{backgroundColor:r,color:r,children:i.jsx(lt,{}),style:e(o,n),sx:{transition:tt.DEFAULT}}}}function Z(t,e,o){return ft(z.useCallback((n,r)=>n!==0||r<0||r>=e?-1:t[r]??0,[t,e]),o)}const ce=({children:t})=>i.jsx(T,{variant:"h5",sx:{color:y.text.primary,fontWeight:F.fontWeight.bold,textAlign:"left",fontSize:F.fontSize.h2},children:t}),nt=({Icon:t,title:e,text:o})=>i.jsxs(h,{sx:{px:2},children:[i.jsxs(T,{variant:"h6",sx:{color:y.text.primary,fontWeight:F.fontWeight.semibold,display:"flex",alignItems:"center",mb:1.5,fontSize:F.fontSize.subheading},children:[i.jsx(t,{sx:{mr:2,color:y.primary.main,fontSize:"1.75rem"}}),e]}),i.jsx(T,{variant:"body1",sx:{color:y.text.secondary,lineHeight:1.6,fontSize:F.fontSize.body,ml:6},children:o})]}),le=["Chasing Lights","How It Works","Calculator"];function de(){return i.jsx(h,{sx:{animation:"fadeIn 0.3s ease",flex:1,display:"flex",flexDirection:"column"},children:i.jsxs(h,{sx:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center",gap:4},children:[i.jsx(nt,{Icon:Wt,title:"Chase to Bottom",text:"Turn off rows from top to bottom by clicking lights in each row to push them down."}),i.jsx(nt,{Icon:Lt,title:"Use Calulator",text:"Enter the remaining lights pattern from the bottom row into the calculator on the last page."}),i.jsx(nt,{Icon:Ut,title:"Chase Again",text:"Apply the solution pattern to the top row, then chase them down again to solve the puzzle."})]})})}function vt(t,e){const o=[...t];let n=t.at(-1);if(!n)return o;for(let r=1;r<e;r++){const s=n[r-1];if(s!==void 0)for(let a=0;a<e;a++){if(!(s>>a&1))continue;const l=N(r,a,n,e,e);o.push(l),n=l}}return o}function zt(t,e){const o=t.at(-1);if(!o)return t;const n=[...t];for(;n.length<e;)n.push([...o]);return n}function ue(t,e){let o=Q(e);for(const w of t)o=N(Math.floor(w/e),w%e,o,e,e);const n=vt([o],e),r=n.at(-1);if(!r)return{boardStates:[],inputStates:[],outputStates:[]};const s=r.at(-1)??0,a=Array.from({length:e},(w,k)=>s>>k&1),{input:l,output:u}=(function(w,k){const b=Array(k).fill(0),_=[b],O=[b],B=[...b];for(let $=0;$<k;$++){if(!w[$])continue;B[$]=1;const R=[...B],g=bt(R,k,k);_.push(R),O.push(g)}return{input:_,output:O}})(a,e),d=n.length+l.length-1,c=u.at(-1);if(!c)return{boardStates:[],inputStates:[],outputStates:[]};let f=[...r];for(;n.length<d;)n.push([...r]);const p=l[0];for(;l.length<d;)p&&l.unshift([...p]);const x=u[0];for(;u.length<d;)x&&u.unshift([...x]);for(let w=0;w<e;w++)c[w]&&(f=N(0,w,f,e,e),n.push([...f]));const m=vt(n,e),j=m.length;return{boardStates:m,inputStates:zt(l,j),outputStates:zt(u,j)}}function kt(t,e,o,n,r,s=1){const a=t.length,l={},u=100/a;for(let d=0;d<a;d++){const c=d*u,f=(d+1)*u;let p=r.secondary,x=!1,m="";const j=t[d],w=d+1<a?t[d+1]:null;if(j&&w){const k=N(e,o,j,n,n);x=!0;for(let b=0;b<n;b++)if(k[b]!==w[b]){x=!1;break}if(x){const b=j[e];b!==void 0&&(p=b>>o&1?r.secondary:r.primary,m=`"${String(d+1)}"`)}}x?(l[`${String(c)}%`]={opacity:0,content:m,color:p,transform:"scale(0.5)"},l[`${String(c+u*(.1/s))}%`]={opacity:1,content:m,color:p,transform:"scale(1.2)"},l[`${String(c+u*(.2/s))}%`]={opacity:1,content:m,color:p,transform:"scale(1)"},l[`${String(f-u*(.1/s))}%`]={opacity:1,content:m,color:p,transform:"scale(1)"},l[`${String(f)}%`]={opacity:0,content:m,color:p,transform:"scale(0.5)"}):(l[`${String(c)}%`]={opacity:0,content:'""',color:p,transform:"scale(0.5)"},l[`${String(f)}%`]={opacity:0,content:'""',color:p,transform:"scale(0.5)"})}return l}function Ct(t,e,o){const n=t.length,r={},s=100/n;for(let a=0;a<n;a++){const l=a*s,u=(a+1)*s;let d=o.secondary,c=!1,f="";const p=t[a],x=a+1<n?t[a+1]:null;p&&x&&p[e]!==x[e]&&(c=!0,d=p[e]===1?o.secondary:o.primary,f=`"${String(a+1)}"`),c?(r[`${String(l)}%`]={opacity:0,content:f,color:d,transform:"scale(0.5)"},r[`${String(l+.05*s)}%`]={opacity:1,content:f,color:d,transform:"scale(1.2)"},r[`${String(l+.1*s)}%`]={opacity:1,content:f,color:d,transform:"scale(1)"},r[`${String(u-.05*s)}%`]={opacity:1,content:f,color:d,transform:"scale(1)"},r[`${String(u)}%`]={opacity:0,content:f,color:d,transform:"scale(0.5)"}):(r[`${String(l)}%`]={opacity:0,content:'""',color:d,transform:"scale(0.5)"},r[`${String(u)}%`]={opacity:0,content:'""',color:d,transform:"scale(0.5)"})}return r}function fe({boardStates:t,inputStates:e,dims:o,id:n,palette:r,children:s}){const a=z.useMemo(()=>[...t.flatMap((l,u)=>Array.from({length:o},(d,c)=>({name:`${n}-board-icon-${String(u)}-${String(c)}`,frames:kt(t,u,c,o,r)}))),...e.flatMap((l,u)=>({name:`${n}-input-icon-0-${String(u)}`,frames:Ct(e,u,r)}))],[t,e,o,n,r]);return i.jsxs(i.Fragment,{children:[i.jsx("style",{children:a.map(l=>`
                @keyframes ${l.name} {
                    ${Object.entries(l.frames).map(([u,d])=>`
                        ${u} {
                            ${Object.entries(d).map(([c,f])=>`${c.replace(/[A-Z]/g,p=>`-${p.toLowerCase()}`)}: ${f};`).join(" ")}
                        }
                    `).join("")}
                }
            `).join("")}),s]})}function pe({start:t=[],dims:e=3,size:o,palette:n,getFrontProps:r,getBackProps:s}){const[a,l]=z.useState(0);z.useEffect(()=>{const g=setInterval(()=>{l(S=>S+1)},2e3);return()=>{clearInterval(g)}},[]);const u=ue(t,e),d=o,{boardStates:c,inputStates:f,outputStates:p}=u,x=a%f.length,m=x===f.length-1,j=pt({grid:c[x]??c[0]??[],rows:e,cols:e},n),w=r(j),k=s(j),b=(function(g,S,v,C){return(D,A)=>{const M=kt(g,D,A,S,C),E=g.length,P=`${v}-board-icon-${String(D)}-${String(A)}`;return{icon:i.jsx(h,{sx:{width:"100%",height:"100%",position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",zIndex:2,"&::after":{content:'""',fontSize:{xs:"0.8rem",sm:"1.2rem"},fontWeight:"bold",filter:wt.DROP,paddingTop:{xs:"0.08rem",sm:"0.15rem"},animation:`${P} ${String(2*E)}s linear infinite`}}}),keyframes:M,keyframeName:P}}})(c,e,"example",n),_=Z(f[x]??[],e,n),O=Z(p[x]??[],e,n),B=et(_),$=et(O),R=(function(g,S,v,C){return(D,A)=>{const M=Ct(g,A,C),E=g.length,P=`${v}-input-icon-${String(D)}-${String(A)}`;return{icon:i.jsx(h,{sx:{width:"100%",height:"100%",position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",zIndex:2,"&::after":{content:'""',fontSize:{xs:"0.8rem",sm:"1.2rem"},fontWeight:"bold",filter:wt.DROP,paddingTop:{xs:"0.08rem",sm:"0.15rem"},animation:`${P} ${String(2*E)}s linear infinite`}}}),keyframes:M,keyframeName:P}}})(f,0,"example",n);return i.jsx(fe,{boardStates:c,inputStates:f,dims:e,id:"example",palette:n,children:i.jsx(K,{container:!0,size:12,spacing:2,sx:{height:"100%"},children:i.jsxs(K,{container:!0,size:12,wrap:"nowrap",sx:{justifyContent:"center",alignItems:"center",flex:1,height:"100%",overflow:"hidden"},children:[i.jsx(K,{size:6,sx:{display:"flex",justifyContent:"center",alignItems:"center",overflow:"hidden"},children:i.jsxs(h,{sx:{position:"relative",display:"inline-flex"},children:[i.jsx(at,{size:d,rows:e,cols:e,frontProps:(g,S)=>{const v=w(g,S),C=b(g,S);return{...v,children:i.jsxs(i.Fragment,{children:[v.children,C.icon]}),sx:{...v.sx??{},position:"relative"}}},backProps:k}),i.jsx(h,{sx:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",opacity:m?1:0,transform:m?"scale(1)":"scale(0.5)",visibility:m?"visible":"hidden",transition:"all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1)",pointerEvents:"none",zIndex:10},children:(()=>{const g=c[f.length-1],S=g==null?void 0:g.every(v=>v===(1<<e)-1);return i.jsx(Nt,{sx:{fontSize:{xs:"2.5rem",sm:"4rem"},color:S?n.secondary:n.primary}})})()})]})}),i.jsxs(K,{container:!0,size:6,spacing:2,sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[i.jsxs(h,{sx:{mb:2,textAlign:"center"},children:[i.jsx(T,{variant:"subtitle2",sx:{mb:1,color:y.text.secondary},children:"Input"}),i.jsx(Y,{rows:1,cols:e,size:d,cellProps:(g,S)=>{const v=B(g,S),C=R(g,S);return{...v,children:i.jsxs(i.Fragment,{children:[v.children,C.icon]}),sx:{...v.sx,position:"relative"}}},space:0})]}),i.jsxs(h,{sx:{textAlign:"center"},children:[i.jsx(Y,{rows:1,cols:e,size:d,cellProps:$,space:0}),i.jsx(T,{variant:"subtitle2",sx:{mt:1,color:y.text.secondary},children:"Result"})]})]})]})})})}function xe({size:t,palette:e,getFrontProps:o,getBackProps:n}){return i.jsx(h,{sx:{flex:1,display:"flex",flexDirection:"column",animation:"fadeIn 0.3s ease"},children:i.jsx(h,{sx:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center"},children:i.jsx(pe,{dims:3,size:.7*t,start:[1,3,8],palette:e,getFrontProps:o,getBackProps:n})})})}function me({cols:t,size:e,isMobile:o,inputProps:n,outputProps:r,onReset:s}){return i.jsx(h,{sx:{animation:"fadeIn 0.3s ease",textAlign:"center",flex:1,display:"flex",flexDirection:"column"},children:i.jsxs(h,{sx:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center",gap:3},children:[i.jsxs(h,{children:[i.jsxs(T,{variant:"subtitle2",sx:{mb:1,color:y.text.primary,fontWeight:"bold"},children:["Input"," ",i.jsx(h,{component:"span",sx:{color:y.text.secondary,fontWeight:"normal"},children:"(Bottom Row)"})]}),i.jsx(Y,{space:0,rows:1,cols:t,size:e*(o?.9:.8),cellProps:n})]}),i.jsxs(h,{children:[i.jsxs(T,{variant:"subtitle2",sx:{mb:1,color:y.text.primary,fontWeight:"bold"},children:["Solution"," ",i.jsx(h,{component:"span",sx:{color:y.text.secondary,fontWeight:"normal"},children:"(Top Row)"})]}),i.jsx(Y,{space:0,rows:1,cols:t,size:e*(o?.9:.8),cellProps:r})]}),i.jsx(h,{sx:{display:"flex",justifyContent:"center"},children:i.jsx(G,{variant:"outlined",size:"small",startIcon:i.jsx(Ht,{}),onClick:s,sx:{borderColor:y.border.subtle,color:y.text.secondary},children:"Clear Pattern"})})]})})}function ge({step:t,totalSteps:e,onBack:o,onNext:n}){return i.jsxs(h,{sx:{p:2.5,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx(G,{onClick:o,disabled:t===0,startIcon:i.jsx(Kt,{}),sx:{visibility:t===0?"hidden":"visible",color:y.text.primary},children:"Back"}),i.jsx(h,{sx:{display:"flex",gap:1},children:Array.from({length:e},(r,s)=>i.jsx(h,{sx:{width:8,height:8,borderRadius:"50%",backgroundColor:t===s?y.primary.main:y.interactive.disabled,transition:"background-color 0.3s"}},s))}),i.jsx(G,{onClick:n,disabled:t===e-1,endIcon:i.jsx(Gt,{}),sx:{visibility:t===e-1?"hidden":"visible",color:y.text.primary},children:"Next"})]})}const he=Ft;function ye(t){const{rows:e,cols:o,size:n,open:r,palette:s,toggleOpen:a,getFrontProps:l,getBackProps:u}=t,d=Jt("md"),[c,f]=z.useState(0),[p,x]=z.useState(Array(o).fill(0));z.useEffect(()=>{x(Array(o).fill(0))},[o,s]);const m=z.useCallback(g=>{const S=parseInt(g,10);x(v=>{const C=[...v];return C[S]!==void 0&&(C[S]^=1),C})},[x]),j=bt(p,e,o),{getDragProps:w}=Bt({onAction:m,checkEnabled:()=>c===2,posAttribute:"data-col"}),k=Z(p,o,s),b=Z(j,o,s),_=(function(g,S){const{getColor:v,getBorder:C}=g;return(D,A)=>{const{front:M,back:E}=v(D,A),P=S(A.toString());return{...P,backgroundColor:M,style:C(D,A),sx:{...P.sx,"&:hover":{cursor:"pointer",color:E}},color:M,children:i.jsx(lt,{})}}})(k,w),O=et(b),B=()=>{a()},$=`#${$t.pages.LightsOutResearch}`;let R;return R=d?i.jsx(ut,{component:"a",href:$,size:"small",sx:{color:y.text.secondary},children:i.jsx(dt,{})}):i.jsx(G,{component:"a",href:$,variant:"outlined",size:"small",startIcon:i.jsx(dt,{}),sx:{borderColor:y.border.subtle,color:y.text.secondary,fontSize:"0.75rem",py:.75,px:1.5,"&:hover":{borderColor:y.primary.main,color:y.primary.main,backgroundColor:y.interactive.hover}},children:"Analysis"}),i.jsx(Xt,{open:r,onClose:B,slots:{backdrop:Zt},slotProps:{backdrop:{sx:{backgroundColor:g=>g.palette.mode==="dark"?"hsla(0, 0%, 3%, 0.85)":"hsla(0, 0%, 98%, 0.85)",backdropFilter:"blur(12px) saturate(180%)",transition:"all 0.3s ease-in-out !important"}}},sx:{zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs(h,{sx:{outline:"none",display:"flex",justifyContent:"center",alignItems:"center",width:"100%"},children:[i.jsxs(he,{onClick:g=>{g.stopPropagation()},sx:{width:"100%",maxWidth:"1000px",height:{xs:"630px",sm:"495px"},minHeight:{xs:"630px",sm:"495px"},display:"flex",flexDirection:"column",p:0,overflow:"hidden",position:"relative",m:2},children:[i.jsxs(h,{sx:{flex:1,overflowY:c===1?"hidden":"auto",p:{xs:2.5,md:3},display:"flex",flexDirection:"column"},children:[i.jsxs(h,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,px:2},children:[i.jsx(ce,{children:le[c]}),i.jsxs(h,{sx:{display:"flex",gap:2,alignItems:"center"},children:[R,i.jsx(ut,{onClick:B,size:"small",sx:{color:y.text.secondary},children:i.jsx(Yt,{})})]})]}),c===0&&i.jsx(de,{}),c===1&&i.jsx(xe,{size:n,palette:s,getFrontProps:l,getBackProps:u}),c===2&&i.jsx(me,{cols:o,size:n,isMobile:d,inputProps:_,outputProps:O,onReset:()=>{x(Array(o).fill(0))}})]}),i.jsx(ge,{step:c,totalSteps:3,onBack:()=>{c>0&&f(c-1)},onNext:()=>{c<2?f(c+1):a()}})]}),i.jsx("style",{children:`
                    @keyframes fadeIn {
                        from { opacity: 0; transform: translateY(10px); }
                        to { opacity: 1; transform: translateY(0); }
                    }
                `})]})})}const be=i.jsx(h,{sx:{width:"45%",height:"45%",borderRadius:"50%",backgroundColor:"currentColor"}});function It(t,e){const{getColor:o,getBorder:n}=e;return(r,s)=>{const a=n(r,s),{front:l,back:u}=o(r,s),d=st(r,s),c=t(d);return{...c,children:be,backgroundColor:l,color:l,style:a,sx:{...c.sx,"&:hover":{cursor:"pointer",color:u}}}}}function _t(t){return(e,o)=>({backgroundColor:t.getFiller(e,o),transition:tt.FAST})}function je(t){const e=It(o=>({onMouseDown:()=>{},onMouseEnter:()=>{},onTouchStart:()=>{},"data-pos":o,sx:{touchAction:"none",transition:"none"}}),t);return(o,n)=>({...e(o,n),onMouseDown:void 0,onMouseEnter:void 0,onTouchStart:void 0,sx:{}})}function we(){const{rows:t,cols:e,state:o,dispatch:n,size:r,mobile:s,solved:a,handleNext:l,controlsProps:u}=Rt({storageKeys:{size:ie,state:ae},pageTitle:ot.lightsOut,gridConfig:{defaultSize:null,minSize:2,maxSize:10,headerOffset:{mobile:rt.headerHeight.xs,desktop:rt.headerHeight.md},paddingOffset:120,cellSizeReference:{mobile:H.gridSizes.mobile,desktop:H.gridSizes.desktop},mobileRowOffset:-2},boardConfig:{paddingOffset:180,boardMaxWidth:1200,boardSizeFactor:.9,maxCellSize:80,remBase:16},reducer:re,getInitialState:X,winAnimationDelay:H.timing.winAnimationDelay,isSolved:b=>b.initialized&&b.grid.every(_=>_===0)}),[d,c]=z.useReducer(b=>!b,!1),f=z.useMemo(()=>({primary:y.primary.main,secondary:y.primary.dark}),[]),{getDragProps:p}=Dt({onToggle:(b,_)=>{n({type:"adjacent",row:ct(b),col:ct(_)})},checkEnabled:()=>!a,touchTimeout:H.timing.interactionDelay,transition:tt.FAST}),x=z.useMemo(()=>o.initialized&&o.grid.every(b=>b===(1<<e)-1),[o.initialized,o.grid,e]),m=pt(o,f),j=Tt(It,p,[m]),w=z.useMemo(()=>_t(m),[m]),k=i.jsx(Et,{...u,children:i.jsx(At,{title:"How to Play",Icon:qt,onClick:c})});return i.jsx(Ot,{children:i.jsxs(Mt,{title:ot.lightsOut,infoUrl:"https://en.wikipedia.org/wiki/Lights_Out_(game)",showTrophy:a,onReset:l,boardSize:r,iconSizeRatio:se,primaryColor:f.primary,secondaryColor:f.secondary,useSecondaryTrophy:x,boardSx:{marginTop:s?`${String(St.MOBILE)}px`:`${String(St.DESKTOP)}px`},controls:k,children:[i.jsx(at,{size:r,rows:t,cols:e,frontProps:j,backProps:w}),d&&i.jsx(ye,{rows:t,cols:e,size:r,open:d,palette:f,toggleOpen:c,getFrontProps:je,getBackProps:_t})]})})}export{we as default};
