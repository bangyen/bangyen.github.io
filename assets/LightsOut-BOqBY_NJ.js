import{r as m,j as u,a as jt}from"./vendor_react-BjoZPjhv.js";import{g as W,c as Pt,v as V,B as It,a as ct,C as L,u as at,b as lt,L as wt,d as Ot,e as kt,G as Rt,f as G,T as At,h as z}from"./useBaseGame-CRpFzYqU.js";import{K as Et,C as zt,a as Tt,b as ut,E as $t,c as Bt,R as Lt}from"./vendor_mui_icons-DjGsc_25.js";import{L as X,C as P,P as Dt}from"./index-BuQIIwSz.js";import{s as _t,d as C,f as $,T as D,B as Y}from"./vendor_mui_core-Bzt2vl7i.js";import{u as K}from"./layout-CZ02KrYv.js";import"./PageLayout-D1Wab0D7.js";function Ft(n){let t=0,e=n;if(e<0n)throw new Error("countBits called on negative bigint");for(;e>0n;)e&=e-1n,t++;return t}function ft(n){const t=new Array(n).fill(1n);for(let e=0;e<n;e++){const o=t[e];o!==void 0&&(t[e]=o<<BigInt(n-e-1))}return t}function Mt(n,t){const e=n.length,o=[];for(let r=0;r<e;r++){const s=n[r],i=t[r];s!==void 0&&i!==void 0&&o.push(s^i)}return o}function Z(n,t){const e=n.length,o=[];for(let r=0;r<e;r++){const s=n[r];let i=0n;if(s!==void 0){for(let c=0;c<e;c++)if(s&1n<<BigInt(e-1-c)){const a=t[c];a!==void 0&&(i^=a)}}o.push(i)}return o}function Gt(n,t,e){const o=n.length;let r=ft(o),s=[...n],i=t;for(;i>0;)i%2===1&&(r=Z(r,s)),s=Z(s,s),i=Math.floor(i/2);return r}function Nt(n,t){const e=n.length,o=[...new Array(e).keys()].sort((i,c)=>{const a=n[c],f=n[i];return a===void 0||f===void 0?0:a>f?1:a<f?-1:0}),r=o.map(i=>n[i]??0n),s=o.map(i=>t[i]??0n);return[r,s]}function Kt(n){const t=n.length,e=ft(t);let o=n,r=e;for(let s=0;s<t;s++){const i=1n<<BigInt(t-s-1);[o,r]=Nt(o,r);for(let c=0;c<t;c++){const a=o[c];if(a!==void 0&&c!==s&&a&i){const f=o[s],l=r[s];if(f!==void 0){const d=o[c];d!==void 0&&(o[c]=d^f)}if(l!==void 0){const d=r[c];d!==void 0&&(r[c]=d^l)}}}}return r}function Ht(n){if(n===1)return[1n];const e=[7n<<BigInt(n-2)];for(let r=1;r<n;r++){const s=e[r-1];if(s!==void 0){const i=s>>1n;e.push(i)}}const o=e[0];return o!==void 0&&(e[0]=o-(1n<<BigInt(n))),e}function Wt(n){const t=[0n,1n];for(let e=1;e<n;e++){const o=t[e],r=t[e-1];if(o!==void 0&&r!==void 0){const s=o<<1n;t.push(s^r)}}return t[n]??0n}function Ut(n,t,e){const o=n.length;let r=new Array(o).fill(0n),s=0,i=t;for(;i>0n;){if(i&1n){const c=Gt(n,s);r=Mt(r,c)}i>>=1n,s++}return r}const N={};function dt(n,t,e){const o=W(t,e);if(!N[o]){const a=Ht(e),f=Wt(t+1),l=Ut(a,f);N[o]=Kt(l)}const r=N[o],s=n.join(""),i=s?BigInt("0b"+s):0n,c=a=>{const f=a&i;return Ft(f)&1};if(r===void 0)throw new Error("Inverse matrix not found in cache");return r.map(c)}function U(n,t){return Array.from({length:n},()=>0)}function T(n,t,e,o,r){const s=[...e];let i=1<<t;if(t>0&&(i|=1<<t-1),t<r-1&&(i|=1<<t+1),s[n]!==void 0&&(s[n]^=i),n>0){const c=s[n-1];c!==void 0&&(s[n-1]=c^1<<t)}if(n<o-1){const c=s[n+1];c!==void 0&&(s[n+1]=c^1<<t)}return s}function pt(n,t,e,o,r){let s=1<<t;if(t>0&&(s|=1<<t-1),t<r-1&&(s|=1<<t+1),e[n]!==void 0&&(e[n]^=s),n>0){const i=e[n-1];i!==void 0&&(e[n-1]=i^1<<t)}if(n<o-1){const i=e[n+1];i!==void 0&&(e[n+1]=i^1<<t)}}function Vt(n){return n.every(t=>t===0)}function B(n,t){const e=U(n);for(let o=0;o<n;o++)for(let r=0;r<t;r++)Math.random()>.5&&pt(o,r,e,n,t);return e}function R(n,t){return V(n),V(t),{grid:U(n),score:0,rows:n,cols:t,initialized:!1}}const Xt=Pt({getInitialState:R,customHandler:(n,t)=>{const{rows:e,cols:o}=n;switch(t.type){case"adjacent":return{...n,grid:T(t.row,t.col,n.grid,e,o)};case"multi_adjacent":{const r=[...n.grid];for(const{row:s,col:i}of t.moves)pt(s,i,r,e,o);return{...n,grid:r}}case"random":case"randomize":return{...n,grid:B(e,o),initialized:!0};case"resize":{const r=t.newRows??t.rows??n.rows,s=t.newCols??t.cols??n.cols;return{...R(r,s),grid:B(r,s),initialized:!0}}case"reset":return{...R(e,o),score:0,initialized:!0};case"new":return{...R(e,o),grid:B(e,o),score:0,initialized:!0};case"next":return{...R(e,o),grid:B(e,o),score:n.score+1,initialized:!0}}return null}});function gt(n,t,e,o,r,s=1){const i=n.length,c={},a=100/i;for(let f=0;f<i;f++){const l=f*a,d=(f+1)*a;let p=r.secondary,h=!1,g="";const x=n[f],S=f+1<i?n[f+1]:null;if(x&&S){const b=T(t,e,x,o,o);h=!0;for(let y=0;y<o;y++)if(b[y]!==S[y]){h=!1;break}if(h){const y=x[t];y!==void 0&&(p=y>>e&1?r.secondary:r.primary,g=`"${String(f+1)}"`)}}h?(c[`${String(l)}%`]={opacity:0,content:g,color:p,transform:"scale(0.5)"},c[`${String(l+a*(.1/s))}%`]={opacity:1,content:g,color:p,transform:"scale(1.2)"},c[`${String(l+a*(.2/s))}%`]={opacity:1,content:g,color:p,transform:"scale(1)"},c[`${String(d-a*(.1/s))}%`]={opacity:1,content:g,color:p,transform:"scale(1)"},c[`${String(d)}%`]={opacity:0,content:g,color:p,transform:"scale(0.5)"}):(c[`${String(l)}%`]={opacity:0,content:'""',color:p,transform:"scale(0.5)"},c[`${String(d)}%`]={opacity:0,content:'""',color:p,transform:"scale(0.5)"})}return c}function ht(n,t,e){const o=n.length,r={},s=100/o,i=2;for(let c=0;c<o;c++){const a=c*s,f=(c+1)*s;let l=e.secondary,d=!1,p="";const h=n[c],g=c+1<o?n[c+1]:null;h&&g&&h[t]!==g[t]&&(d=!0,l=h[t]===1?e.secondary:e.primary,p=`"${String(c+1)}"`),d?(r[`${String(a)}%`]={opacity:0,content:p,color:l,transform:"scale(0.5)"},r[`${String(a+s*(.1/i))}%`]={opacity:1,content:p,color:l,transform:"scale(1.2)"},r[`${String(a+s*(.2/i))}%`]={opacity:1,content:p,color:l,transform:"scale(1)"},r[`${String(f-s*(.1/i))}%`]={opacity:1,content:p,color:l,transform:"scale(1)"},r[`${String(f)}%`]={opacity:0,content:p,color:l,transform:"scale(0.5)"}):(r[`${String(a)}%`]={opacity:0,content:'""',color:l,transform:"scale(0.5)"},r[`${String(f)}%`]={opacity:0,content:'""',color:l,transform:"scale(0.5)"})}return r}function Yt({boardStates:n,inputStates:t,dims:e,id:o,palette:r,children:s}){const i=m.useMemo(()=>{const c=n.flatMap((f,l)=>Array.from({length:e},(d,p)=>{const h=`${o}-board-icon-${String(l)}-${String(p)}`,g=gt(n,l,p,e,r);return{name:h,frames:g}})),a=t.flatMap((f,l)=>{const d=`${o}-input-icon-0-${String(l)}`,p=ht(t,l,r);return{name:d,frames:p}});return[...c,...a]},[n,t,e,o,r]);return u.jsxs(u.Fragment,{children:[u.jsx("style",{children:i.map(c=>`
                @keyframes ${c.name} {
                    ${Object.entries(c.frames).map(([a,f])=>`
                        ${a} {
                            ${Object.entries(f).map(([l,d])=>`${l.replaceAll(/[A-Z]/g,p=>`-${p.toLowerCase()}`)}: ${d};`).join(" ")}
                        }
                    `).join("")}
                }
            `).join("")}),s]})}const F={TRANSITION:{FAST:"background-color 100ms ease-in-out, color 100ms ease-in-out, opacity 100ms ease-in-out, border-radius 100ms ease-in-out",DEFAULT:"background-color 200ms ease, color 200ms ease, opacity 200ms ease, border-radius 200ms ease"},SHADOWS:{DROP:It.DROP_SHADOW}},q={OFFSET:{MOBILE:-28,DESKTOP:-40}},Zt=["Chasing Lights","How It Works","Calculator"],qt=[{Icon:Et,title:"Chase to Bottom",text:"Turn off rows from top to bottom by clicking lights in each row to push them down."},{Icon:zt,title:"Use Calulator",text:"Enter the remaining lights pattern from the bottom row into the calculator on the last page."},{Icon:Tt,title:"Chase Again",text:"Apply the solution pattern to the top row, then chase them down again to solve the puzzle."}],J={MOBILE:3,DESKTOP:4};function Jt(){return{storageKey:"lights-out",grid:{maxSize:10,headerOffset:{mobile:X.headerHeight.xs,desktop:X.headerHeight.md},gridPadding:{x:80,y:60}},board:{boardPadding:n=>({x:n?40:120,y:n?120:160}),maxCellSize:80}}}function Qt(n,t,e){const o=e(n,t),r=e(n-1,t),s=e(n+1,t),i=e(n,t-1),c=e(n,t+1),a={},f=o===r,l=o===s,d=o===i,p=o===c;return(f||d)&&(a.borderTopLeftRadius=0),(f||p)&&(a.borderTopRightRadius=0),(l||d)&&(a.borderBottomLeftRadius=0),(l||p)&&(a.borderBottomRightRadius=0),a}function tn(n,t,e){const o=e(n,t),r=e(n,t+1),s=e(n+1,t),i=e(n+1,t+1);let c=!0;const a=o+r+s+i;return(!o||!i)&&a<3&&(c=!1),c}function nn(n){return m.useMemo(()=>{const t=P.primary.main,e=P.primary.dark;return{primary:t,secondary:e}},[])}function mt(n,t){const e=m.useCallback((s,i)=>{const c=n(s,i),a=c?t.primary:t.secondary,f=c?t.secondary:t.primary;return{front:a,back:f,isLit:c>0}},[n,t]),o=m.useCallback((s,i)=>Qt(s,i,n),[n]),r=m.useCallback((s,i)=>tn(s,i,n)?t.primary:t.secondary,[n,t]);return m.useMemo(()=>({getColor:e,getBorder:o,getFiller:r}),[e,o,r])}function xt(n,t){const{grid:e,rows:o,cols:r}=n,s=m.useCallback((i,c)=>{if(i<0||c<0||i>=o||c>=r)return-1;const a=e[i];return a===void 0?0:a>>c&1},[e,o,r]);return mt(s,t)}const en=_t(C)({width:"35%",height:"35%",borderRadius:"50%",backgroundColor:"currentColor"}),on=u.jsx(en,{}),yt={outline:"none",zIndex:1,"&::after":{content:'""',position:"absolute",inset:0,borderRadius:"var(--cell-radius)",boxShadow:`inset 0 0 0 3px ${P.text.secondary}`,pointerEvents:"none"}};function St(n,t){const{getColor:e,getBorder:o}=n;return(r,s)=>{const i=o(r,s),{front:c,isLit:a}=e(r,s);return{children:on,backgroundColor:c,color:c,style:i,...t?{transition:"none"}:{},"aria-label":`Light at row ${String(r+1)}, column ${String(s+1)}, currently ${a?"lit":"unlit"}`}}}function rn(n,t,e){const o=St(t,e),{getColor:r}=t;return(s,i)=>{const c=o(s,i),{back:a}=r(s,i),f=W(s,i),l=n(f);return{...l,...c,sx:{position:"relative",...l.sx,"&:hover":{cursor:"pointer",color:a},"&:focus-visible":yt}}}}function Q(n,t){return(e,o)=>({backgroundColor:n.getFiller(e,o),transition:t?"none":F.TRANSITION.FAST})}function sn(n,t){const{getColor:e,getBorder:o}=n;return(r,s)=>{const{front:i,back:c}=e(r,s),a=t(W(r,s));return{...a,backgroundColor:i,style:o(r,s),sx:{position:"relative",...a.sx,"&:hover":{cursor:"pointer",color:c},"&:focus-visible":yt},color:i,children:u.jsx(ut,{})}}}function H({getColor:n,getBorder:t}){return(e,o)=>{const{front:r}=n(e,o);return{backgroundColor:r,color:r,children:u.jsx(ut,{}),style:t(e,o),sx:{transition:F.TRANSITION.DEFAULT}}}}function _(n,t,e){const o=m.useCallback((r,s)=>r!==0||s<0||s>=t?-1:n[s]??0,[n,t]);return mt(o,e)}function tt(n,t){const e=[...n];let o=n.at(-1);if(!o)return e;for(let r=1;r<t;r++){const s=o[r-1];if(s!==void 0)for(let i=0;i<t;i++){if(!(s>>i&1))continue;const c=T(r,i,o,t,t);e.push(c),o=c}}return e}function cn(n,t){const e=new Array(t).fill(0),o=[e],r=[e],s=[...e];for(let i=0;i<t;i++){if(!n[i])continue;s[i]=1;const c=[...s],a=dt(c,t,t);o.push(c),r.push(a)}return{input:o,output:r}}function nt(n,t){const e=n.at(-1);if(!e)return n;const o=[...n];for(;o.length<t;)o.push([...e]);return o}function an(n,t){let e=U(t);for(const y of n){const I=Math.floor(y/t),A=y%t;e=T(I,A,e,t,t)}const o=tt([e],t),r=o.at(-1);if(!r)return{boardStates:[],inputStates:[],outputStates:[]};const s=r.at(-1)??0,i=Array.from({length:t},(y,I)=>s>>I&1),{input:c,output:a}=cn(i,t),f=o.length+c.length-1,l=a.at(-1);if(!l)return{boardStates:[],inputStates:[],outputStates:[]};let d=[...r];for(;o.length<f;)o.push([...r]);const p=c[0];for(;c.length<f;)p&&c.unshift([...p]);const h=a[0];for(;a.length<f;)h&&a.unshift([...h]);for(let y=0;y<t;y++)l[y]&&(d=T(0,y,d,t,t),o.push([...d]));const g=tt(o,t),x=g.length,S=nt(c,x),b=nt(a,x);return{boardStates:g,inputStates:S,outputStates:b}}function et(n,t,e){return(o,r)=>{const s=n(o,r),i=`${t}-${String(o)}-${String(r)}`;return{icon:u.jsx(C,{sx:{width:"100%",height:"100%",position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",zIndex:2,"&::after":{content:'""',fontSize:"1.2rem",fontWeight:"bold",filter:F.SHADOWS.DROP,paddingTop:"0.15rem",animation:`${i} ${String(e*2)}s linear infinite`}}}),keyframes:s,keyframeName:i}}}function ot(n,t){return(e,o)=>{const r=n(e,o),{icon:s}=t(e,o);return{...r,children:u.jsxs(u.Fragment,{children:[r.children,s]}),sx:{...r.sx,position:"relative"}}}}function ln({start:n=[],dims:t=3,size:e,palette:o,getFrontProps:r,getBackProps:s}){const[i,c]=m.useState(0);m.useEffect(()=>{const E=setInterval(()=>{c(O=>O+1)},2e3);return()=>{clearInterval(E)}},[]);const a=an(n,t),f=e,{boardStates:l,inputStates:d,outputStates:p}=a,h=i%d.length,g=h===d.length-1,x={grid:l[h]??l[0]??[],rows:t,cols:t},S=xt(x,o),b=r(S),y=s(S),I=et((E,O)=>gt(l,E,O,t,o),"example-board-icon",l.length),A=et((E,O)=>ht(d,O,o),"example-input-icon",d.length),v=ot(b,I),j=_(d[h]??[],t,o),w=_(p[h]??[],t,o),M=H(j),bt=H(w),vt=ot(M,A),k=K("sm");return u.jsx(Yt,{boardStates:l,inputStates:d,dims:t,id:"example",palette:o,children:u.jsx($,{container:!0,size:12,spacing:2,sx:{height:"100%"},children:u.jsxs($,{container:!0,size:12,wrap:k?"wrap":"nowrap",sx:{justifyContent:"center",alignItems:"center",alignContent:"center",flex:1,height:"100%",overflow:"hidden",flexDirection:k?"column":"row"},children:[u.jsx($,{size:k?12:6,sx:{display:"flex",justifyContent:"center",alignItems:"center",overflow:"hidden"},children:u.jsxs(C,{sx:{position:"relative",display:"inline-flex"},children:[u.jsx(ct,{size:f,layers:[{rows:t-1,cols:t-1,cellProps:y,decorative:!0},{rows:t,cols:t,cellProps:v}]}),u.jsx(C,{sx:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",opacity:g?1:0,transform:g?"scale(1)":"scale(0.5)",visibility:g?"visible":"hidden",transition:"all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1)",pointerEvents:"none",zIndex:10},children:(()=>{const O=l[d.length-1]?.every(Ct=>Ct===(1<<t)-1);return u.jsx($t,{sx:{fontSize:{xs:"2.5rem",sm:"4rem"},color:O?o.secondary:o.primary}})})()})]})}),u.jsxs($,{container:!0,size:k?12:6,spacing:k?1:2,sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[u.jsxs(C,{sx:{mb:k?0:2,textAlign:"center"},children:[u.jsx(D,{variant:"subtitle2",sx:{mb:1,color:P.text.secondary},children:"Input"}),u.jsx(L,{rows:1,cols:t,size:f,cellProps:vt,space:0})]}),u.jsxs(C,{sx:{textAlign:"center"},children:[u.jsx(L,{rows:1,cols:t,size:f,cellProps:bt,space:0}),u.jsx(D,{variant:"subtitle2",sx:{mt:1,color:P.text.secondary},children:"Result"})]})]})]})})})}const un={animation:"fadeIn 0.3s ease",textAlign:"center",flex:1,display:"flex",flexDirection:"column",overflow:"clip"},fn=n=>({flex:1,display:"flex",flexDirection:n?"row":"column",justifyContent:"center",alignItems:"center",gap:3}),rt={mb:1,color:P.text.primary,fontWeight:"bold"},st={color:P.text.secondary,fontWeight:"normal"},dn=(n,t)=>({display:"flex",flexDirection:n||t?"column":"row",gap:1,alignItems:"center"}),it={borderColor:P.border.subtle,color:P.text.secondary},pn=jt.memo(function({cols:t,size:e,isMobile:o,inputProps:r,outputProps:s,onReset:i,onApply:c,hasPattern:a}){const l=Math.min(e*(o?.9:.8),3),d=t*l,p=10,h=3*.5,g=d*2+p+h*2,x=!o&&g<55;return u.jsx(C,{sx:un,children:u.jsxs(C,{sx:fn(x),children:[u.jsxs(C,{sx:{textAlign:"center"},children:[u.jsxs(D,{variant:"subtitle2",sx:rt,children:["Input"," ",u.jsx(C,{component:"span",sx:st,children:"(Bottom Row)"})]}),u.jsx(L,{space:0,rows:1,cols:t,size:l,cellProps:r})]}),u.jsxs(C,{sx:{textAlign:"center"},children:[u.jsxs(D,{variant:"subtitle2",sx:rt,children:["Solution"," ",u.jsx(C,{component:"span",sx:st,children:"(Top Row)"})]}),u.jsx(L,{space:0,rows:1,cols:t,size:l,cellProps:s})]}),u.jsxs(C,{sx:dn(x,o),children:[u.jsx(Y,{variant:"outlined",size:"small",startIcon:u.jsx(Bt,{}),disabled:!a,onClick:c,sx:it,children:"Copy Pattern"}),u.jsx(Y,{variant:"outlined",size:"small",startIcon:u.jsx(Lt,{}),onClick:i,sx:it,children:"Clear Pattern"})]})]})})});function gn({rows:n,cols:t,palette:e}){const[o,r]=m.useState(new Array(t).fill(0));m.useEffect(()=>{r(new Array(t).fill(0))},[t,e]);const s=dt(o,n,t),{handleKeyDown:i}=at({rows:1,cols:t}),{getDragProps:c}=lt({onToggle:(g,x)=>{r(S=>{const b=[...S];return b[x]!==void 0&&(b[x]^=1),b})},checkEnabled:()=>!0}),a=m.useCallback(g=>{const x=c(g);return{...x,onKeyDown:S=>{x.onKeyDown(S),i(S)}}},[c,i]),f=_(o,t,e),l=_(s,t,e),d=sn(f,a),p=H(l),h=m.useCallback(()=>{r(new Array(t).fill(0))},[t]);return{inputProps:d,outputProps:p,handleReset:h,res:s,hasPattern:s.some(g=>g!==0)}}function hn({open:n,toggleOpen:t,board:e,rendering:o,onApply:r}){const{rows:s,cols:i,size:c}=e,{palette:a,getFrontProps:f,getBackProps:l}=o,d=K("md"),p=K("sm"),{inputProps:h,outputProps:g,handleReset:x,res:S,hasPattern:b}=gn({rows:s,cols:i,palette:a}),y=p?J.MOBILE:J.DESKTOP;return u.jsx(wt,{open:n,toggleOpen:t,titles:Zt,instructions:qt,exampleContent:u.jsx(ln,{dims:3,size:y,start:[1,3,8],palette:a,getFrontProps:f,getBackProps:l}),extraSteps:[u.jsx(pn,{cols:i,size:c,isMobile:d,inputProps:h,outputProps:g,onReset:x,onApply:()=>{r(S)},hasPattern:b},"calculator")],persistenceKey:"lights_out_info_step"})}function mn(n){const t=m.useRef(""),e=m.useRef(!1),[,o]=m.useState(0);return n!==t.current&&(e.current=t.current!=="",t.current=n),m.useEffect(()=>{if(!e.current)return;const r=requestAnimationFrame(()=>{e.current=!1,o(s=>s+1)});return()=>{cancelAnimationFrame(r)}},[n]),e.current}function xn({game:{rows:n,cols:t,size:e,mobile:o,scaling:r},info:{open:s,toggleOpen:i,handleApply:c},rendering:{palette:a,getters:f,skipTransition:l},drag:{getDragProps:d,frontPropsFactory:p}}){const h=Ot(p,d,[f,l]),g=m.useMemo(()=>Q(f,l),[f,l]),x=m.useMemo(()=>({size:e,space:0,layers:[{rows:n-1,cols:t-1,cellProps:g},{rows:n,cols:t,cellProps:h,decorative:!0}]}),[e,n,t,g,h]),S=m.useMemo(()=>({boardSx:{marginTop:o?`${String(q.OFFSET.MOBILE)}px`:`${String(q.OFFSET.DESKTOP)}px`}}),[o]),b=m.useMemo(()=>({open:s,toggleOpen:i,board:{rows:n,cols:t,size:e},rendering:{palette:a,getFrontProps:St,getBackProps:Q},onApply:c}),[s,i,n,t,e,a,c]),y=m.useMemo(()=>({scaling:r}),[r]);return m.useMemo(()=>({boardProps:x,layoutProps:S,infoProps:b,trophyProps:y}),[x,S,b,y])}function yn(n){if(typeof n!="object"||n===null)return!1;const t=n;return Array.isArray(t.grid)&&typeof t.score=="number"&&typeof t.rows=="number"&&typeof t.cols=="number"&&typeof t.initialized=="boolean"}function Sn(){const n=kt({...Jt(),logic:{reducer:Xt,getInitialState:R,isSolved:v=>v.initialized&&Vt(v.grid),persistence:{deserialize:v=>{if(!yn(v))throw new Error(`Corrupt Lights Out state in localStorage: expected a valid BoardState object but received ${JSON.stringify(v).slice(0,100)}`);return v}}}}),{state:t,dispatch:e,solved:o,layout:r}=n,{rows:s,cols:i,size:c,mobile:a,scaling:f}=r,{handleKeyDown:l}=at({rows:s,cols:i}),{getDragProps:d}=lt({onToggle:(v,j)=>{e({type:"adjacent",row:v,col:j})},checkEnabled:()=>!o,touchTimeout:Rt.timing.interactionDelay,transition:F.TRANSITION.FAST}),p=m.useCallback(v=>{const j=d(v);return{...j,onKeyDown:w=>{j.onKeyDown(w),l(w)}}},[d,l]),[h,g]=m.useState(!1),x=m.useCallback(()=>{g(v=>!v)},[]),S=nn(),b=xt(t,S),y=`${String(s)},${String(i)},${String(t.score)}`,I=mn(y),A=m.useCallback(v=>{const j=v.map((w,M)=>w?{row:0,col:M}:null).filter(w=>w!==null);j.length>0&&e({type:"multi_adjacent",moves:j}),x()},[e,x]);return{...xn({game:{rows:s,cols:i,size:c,mobile:a,scaling:f},info:{open:h,toggleOpen:x,handleApply:A},rendering:{palette:S,getters:b,skipTransition:I},drag:{getDragProps:p,frontPropsFactory:rn}}),gameState:n}}function On(){const{boardProps:n,layoutProps:t,infoProps:e,gameState:o,trophyProps:r}=Sn();return u.jsxs(u.Fragment,{children:[u.jsxs(G,{title:Dt.lightsOut,infoUrl:"https://en.wikipedia.org/wiki/Lights_Out_(game)",children:[u.jsx(G.Content,{children:u.jsxs(G.BoardContainer,{sx:t.boardSx,children:[u.jsx(ct,{...n}),u.jsx(At,{show:o.solved,...r})]})}),u.jsxs(z,{...o.controlsProps,children:[u.jsx(z.Refresh,{}),u.jsx(z.ResizeMinus,{}),u.jsx(z.ResizePlus,{}),u.jsx(z.Info,{onClick:e.toggleOpen})]})]}),u.jsx(hn,{...e})]})}export{On as LightsOut};
