import{j as S,r as M,a as je}from"./vendor_react-CiGj4Onb.js";import{u as Ie,C as ge}from"./layout-DpyX98We.js";import{d as pe,g as D,i as Q,c as Re,a as be,b as ze,k as Me,e as Ne,G as Ae,f as Te,j as he,h as Oe,B as $e}from"./GameErrorBoundary-Cw3xV-ME.js";import{e as Y,a as E,L as re,A as ee,S as me,d as xe}from"./index-CB166san.js";import{B as H}from"./vendor_mui_core-Cb6gYFA4.js";import{t as Be,u as De,f as He,P as Le}from"./vendor_mui_icons-88WVDz42.js";import"./PageLayout-D4KkK3P1.js";import"./GlassCard-ZVr2Az-J.js";const j=1,T=2,te="18px",ne="24px",we="130%",ye="6px",_e="24px",Ue=100,We=1e3,Pe=1200,Ge=.98,Fe=100,Ve=16,Xe=.8,qe="slant-size",Je="slant-state",Ke="slant-ghost-moves",se=0,Ze=3,Qe=5,ve={WHITE:"#fff"},V={LINE:"0 2px 4px rgba(0,0,0,0.2)",HINT:"0 4px 8px rgba(0,0,0,0.1)"},G={BORDER:"var(--slant-ghost-border)",BG_SUBTLE:"var(--slant-ghost-bg-subtle)",BG_HOVER:"var(--slant-ghost-bg-hover)",DASHED_BORDER:"var(--slant-ghost-dashed-border)",HINT_BG:"var(--slant-ghost-hint-bg)",HINT_BORDER:"var(--slant-ghost-hint-border)",HINT_TEXT:"var(--slant-ghost-hint-text)"},Ye=({onCopy:e,onClear:t,onClose:o})=>S.jsxs(H,{sx:{display:"flex",justifyContent:"center",gap:2,position:"absolute",bottom:-90,left:0,right:0,pointerEvents:"auto",zIndex:re.zIndex.base+5,paddingBottom:2},children:[S.jsx(Y,{title:"Copy Board",Icon:Be,onClick:e,sx:{backgroundColor:E.interactive.selected,color:E.primary.main,"&:hover":{backgroundColor:E.interactive.focus}}}),S.jsx(Y,{title:"Clear Calculator",Icon:De,onClick:t,sx:{backgroundColor:"rgba(255, 68, 68, 0.1)",color:E.data.red,"&:hover":{backgroundColor:"rgba(255, 68, 68, 0.2)"}}}),S.jsx(Y,{title:"Close Calculator",Icon:He,onClick:o,sx:{backgroundColor:"rgba(255, 193, 7, 0.1)",color:E.data.amber,"&:hover":{backgroundColor:"rgba(255, 193, 7, 0.2)"}}})]}),et=({value:e,color:t})=>S.jsxs(H,{sx:{width:"100%",height:"100%",position:"relative"},children:[e===j&&S.jsx(H,{sx:{position:"absolute",width:we,height:ye,backgroundColor:t,borderRadius:me.borderRadius.full,top:"50%",left:"50%",transform:"translate(-50%, -50%) rotate(-45deg)",boxShadow:V.LINE,transition:ee.transition,pointerEvents:"none"}}),e===T&&S.jsx(H,{sx:{position:"absolute",width:we,height:ye,backgroundColor:t,borderRadius:me.borderRadius.full,top:"50%",left:"50%",transform:"translate(-50%, -50%) rotate(45deg)",boxShadow:V.LINE,transition:ee.transition,pointerEvents:"none"}})]}),tt=({value:e,hasConflict:t,numberSize:o})=>S.jsx(H,{sx:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:`${String(.5*o)}rem`,fontWeight:"800",color:t?ve.WHITE:G.HINT_TEXT,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",userSelect:"none",WebkitUserSelect:"none",transform:t?"scale(1.1)":"scale(1)"},children:e??""}),nt=({rows:e,cols:t,numbers:o,size:i,initialMoves:n,onMove:a,onCopy:u,onClear:p,onClose:f})=>{const l=Ie("sm"),c=n,{getDragProps:r}=pe({onToggle:(h,R,s,x,N)=>{const z=D(h,R);if(!N)return void a(z,x);const A=c.get(z);let W;return W=s?A===j?T:A===T?void 0:j:A===T?j:A===j?void 0:T,a(z,W),W},touchTimeout:Q.timing.touchHoldDelay,checkEnabled:()=>!0}),[d,m]=M.useState(new Map),[w,C]=M.useState([]),[y,_]=M.useState(new Set),g=je.useRef(null);M.useEffect(()=>{const h=new Worker(new URL("/assets/solverWorker-D1MM7cjt.js",import.meta.url),{type:"module"});return g.current=h,h.onmessage=R=>{const s=R.data;if(s.type==="RESULT"){const{gridState:x,conflicts:N,cycleCells:z}=s.payload;m(x),C(N),_(z)}},()=>{h.terminate()}},[]),M.useEffect(()=>{g.current&&g.current.postMessage({type:"SOLVE",payload:{rows:e,cols:t,numbers:o,userMoves:c}})},[c,o,e,t]);const b=.4*i,v=i-b,I=M.useMemo(()=>new Set(w.filter(h=>h.type==="cell").map(h=>D(h.r,h.c))),[w]),$=M.useMemo(()=>new Set(w.filter(h=>h.type==="node").map(h=>D(h.r,h.c))),[w]),L=M.useCallback((h,R)=>{const s=D(h,R),x=d.get(s),N=(x==null?void 0:x.state)??0,z=x==null?void 0:x.source,A=I.has(s),W=y.has(s),P=r(s);let U=E.text.primary;return A?U=E.data.red:W?U=z==="user"?E.data.red:"#ff9800":z==="user"?U=E.primary.main:z==="propagated"&&(U=E.data.green),{...P,"data-pos":s,"data-type":"cell",sx:{...P.sx,cursor:"pointer",border:`1px solid ${G.BORDER}`,position:"relative",backgroundColor:G.BG_SUBTLE,"&:hover":{backgroundColor:G.BG_HOVER}},children:S.jsx(et,{value:N,color:U})}},[d,I,y,r]),k=M.useCallback((h,R)=>{var N;const s=(N=o[h])==null?void 0:N[R],x=$.has(D(h,R));return{"data-pos":D(h,R),"data-type":"hint",children:S.jsx(tt,{value:s??null,hasConflict:x,numberSize:b}),sx:{borderRadius:"50%",backgroundColor:x?E.data.red:G.HINT_BG,border:s!=null?`2px solid ${x?E.data.red:G.HINT_BORDER}`:"none",zIndex:5,opacity:s!=null?1:0,position:"relative",pointerEvents:"none"}}},[o,$,b]);return S.jsxs(H,{sx:{position:"relative",userSelect:"none"},children:[S.jsxs(H,{sx:{position:"relative",padding:l?`calc(${te} + 16px)`:`calc(${ne} + 24px)`,border:`2px dashed ${G.DASHED_BORDER}`,borderRadius:_e},children:[S.jsx(H,{sx:{position:"relative",zIndex:re.zIndex.base+1},children:S.jsx(ge,{size:i,rows:e,cols:t,cellProps:L,space:0,sx:{width:"fit-content"}})}),S.jsx(H,{sx:{position:"absolute",top:l?`calc(${te} + 16px)`:`calc(${ne} + 24px)`,left:l?`calc(${te} + 16px)`:`calc(${ne} + 24px)`,transform:`translate(-${String(b/2)}rem, -${String(b/2)}rem)`,zIndex:re.zIndex.base+2,pointerEvents:"none"},children:S.jsx(ge,{size:b,rows:e+1,cols:t+1,cellProps:k,space:v,sx:{width:"fit-content"}})})]}),S.jsx(Ye,{onCopy:u,onClear:p,onClose:f})]})};function X(e,t,o){const i=Array.from({length:t+1},()=>Array(o+1).fill(0));for(let n=0;n<t;n++){const a=e[n];if(a)for(let u=0;u<o;u++){const p=a[u];if(p===j){const f=i[n];if(f){const c=f[u+1];c!==void 0&&(f[u+1]=c+1)}const l=i[n+1];if(l){const c=l[u];c!==void 0&&(l[u]=c+1)}}else if(p===T){const f=i[n];if(f){const c=f[u];c!==void 0&&(f[u]=c+1)}const l=i[n+1];if(l){const c=l[u+1];c!==void 0&&(l[u+1]=c+1)}}}}return i}class ie{constructor(t){this.parent=Array.from({length:t},(o,i)=>i)}find(t){const o=this.parent[t];if(o===void 0)throw new Error(`DSU: Index ${String(t)} out of bounds`);o!==t&&(this.parent[t]=this.find(o));const i=this.parent[t];if(i===void 0)throw new Error(`DSU: Parent of ${String(t)} became undefined`);return i}union(t,o){const i=this.find(t),n=this.find(o);return i!==n&&(this.parent[i]=n,!0)}connected(t,o){return this.find(t)===this.find(o)}}function ot(e,t,o){const i=(function(p,f){const l=f(1*p.length,1)>>>0;return J().set(p,l/1),Z=p.length,l})(e,O.__wbindgen_malloc),n=Z,a=O.find_cycles_wasm(i,n,t,o);var u=(function(p,f){p>>>=0;const l=le(),c=[];for(let r=p;r<p+4*f;r+=4)c.push(O.__wbindgen_externrefs.get(l.getUint32(r,!0)));return O.__externref_drop_slice(p,f),c})(a[0],a[1]).slice();return O.__wbindgen_free(a[0],4*a[1],4),u}function rt(){return{__proto__:null,"./slant_wasm_bg.js":{__proto__:null,__wbg___wbindgen_debug_string_0bc8482c6e3508ae:function(e,t){const o=(function(n,a,u){if(u===void 0){const r=K.encode(n),d=a(r.length,1)>>>0;return J().subarray(d,d+r.length).set(r),Z=r.length,d}let p=n.length,f=a(p,1)>>>0;const l=J();let c=0;for(;c<p;c++){const r=n.charCodeAt(c);if(r>127)break;l[f+c]=r}if(c!==p){c!==0&&(n=n.slice(c)),f=u(f,p,p=c+3*n.length,1)>>>0;const r=J().subarray(f+c,f+p);c+=K.encodeInto(n,r).written,f=u(f,p,c,1)>>>0}return Z=c,f})(ae(t),O.__wbindgen_malloc,O.__wbindgen_realloc),i=Z;le().setInt32(e+4,i,!0),le().setInt32(e+0,o,!0)},__wbg___wbindgen_throw_be289d5034ed271b:function(e,t){throw new Error(Se(e,t))},__wbg_new_361308b2356cecd0:function(){return new Object},__wbg_new_3eb36ae241fe6f44:function(){return new Array},__wbg_set_3f1d0b984ed272ed:function(e,t,o){e[t]=o},__wbg_set_f43e577aea94465b:function(e,t,o){e[t>>>0]=o},__wbindgen_cast_0000000000000001:function(e){return e},__wbindgen_cast_0000000000000002:function(e,t){return Se(e,t)},__wbindgen_init_externref_table:function(){const e=O.__wbindgen_externrefs,t=e.grow(4);e.set(0,void 0),e.set(t+0,void 0),e.set(t+1,null),e.set(t+2,!0),e.set(t+3,!1)}}}}function ae(e){const t=typeof e;if(t=="number"||t=="boolean"||e==null)return`${e}`;if(t=="string")return`"${e}"`;if(t=="symbol"){const n=e.description;return n==null?"Symbol":`Symbol(${n})`}if(t=="function"){const n=e.name;return typeof n=="string"&&n.length>0?`Function(${n})`:"Function"}if(Array.isArray(e)){const n=e.length;let a="[";n>0&&(a+=ae(e[0]));for(let u=1;u<n;u++)a+=", "+ae(e[u]);return a+="]",a}const o=/\[object ([^\]]+)\]/.exec(toString.call(e));let i;if(!(o&&o.length>1))return toString.call(e);if(i=o[1],i=="Object")try{return"Object("+JSON.stringify(e)+")"}catch{return"Object"}return e instanceof Error?`${e.name}: ${e.message}
${e.stack}`:i}let F=null;function le(){return(F===null||F.buffer.detached===!0||F.buffer.detached===void 0&&F.buffer!==O.memory.buffer)&&(F=new DataView(O.memory.buffer)),F}function Se(e,t){return(function(o,i){return ce+=i,ce>=st&&(oe=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}),oe.decode(),ce=i),oe.decode(J().subarray(o,o+i))})(e>>>=0,t)}let q=null;function J(){return q!==null&&q.byteLength!==0||(q=new Uint8Array(O.memory.buffer)),q}let oe=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});oe.decode();const st=2146435072;let ce=0;const K=new TextEncoder;"encodeInto"in K||(K.encodeInto=function(e,t){const o=K.encode(e);return t.set(o),{read:e.length,written:o.length}});let O,Z=0;async function it(e){if(O!==void 0)return O;e!==void 0&&Object.getPrototypeOf(e)===Object.prototype&&({module_or_path:e}=e),e===void 0&&(e=new URL("/assets/slant_wasm_bg-kZzm8ut6.wasm",import.meta.url));const t=rt();(typeof e=="string"||typeof Request=="function"&&e instanceof Request||typeof URL=="function"&&e instanceof URL)&&(e=fetch(e));const{instance:o}=await(async function(i,n){if(typeof Response=="function"&&i instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(i,n)}catch(u){if(!i.ok||!(function(p){switch(p){case"basic":case"cors":case"default":return!0}return!1})(i.type)||i.headers.get("Content-Type")==="application/wasm")throw u}const a=await i.arrayBuffer();return await WebAssembly.instantiate(a,n)}{const a=await WebAssembly.instantiate(i,n);return a instanceof WebAssembly.Instance?{instance:a,module:i}:a}})(await e,t);return(function(i){return O=i.exports,F=null,q=null,O.__wbindgen_start(),O})(o)}let de=!1,ue=null;function Ce(){return de}function B(e,t,o){return e*(o+1)+t}function at(e,t,o){var p,f,l,c;const i=Array.from({length:t},()=>Array(o).fill(0)),n=new ie((t+1)*(o+1));let a=!0;for(;a;){a=!1;for(let r=0;r<=t;r++)for(let d=0;d<=o;d++){const m=(p=e[r])==null?void 0:p[d];if(m==null)continue;const w=[{gr:r-1,gc:d-1,pt:T},{gr:r-1,gc:d,pt:j},{gr:r,gc:d-1,pt:j},{gr:r,gc:d,pt:T}].filter(({gr:_,gc:g})=>_>=0&&_<t&&g>=0&&g<o);let C=0;const y=[];for(const _ of w){const g=(f=i[_.gr])==null?void 0:f[_.gc];g===0?y.push(_):g===_.pt&&C++}if(C===m&&y.length>0)for(const{gr:_,gc:g,pt:b}of y){const v=i[_];if((v==null?void 0:v[g])===0){const I=b===j?T:j;v[g]=I,a=!0;const $=B(_,I===j?g+1:g,o),L=B(_+1,I===j?g:g+1,o);if(n.connected($,L))return!1;n.union($,L)}}else if(C+y.length===m&&y.length>0)for(const{gr:_,gc:g,pt:b}of y){const v=i[_];if((v==null?void 0:v[g])===0){v[g]=b,a=!0;const I=B(_,b===j?g+1:g,o),$=B(_+1,b===j?g:g+1,o);if(n.connected(I,$))return!1;n.union(I,$)}}}if(!a)for(let r=0;r<t;r++)for(let d=0;d<o;d++){const m=i[r];if((m==null?void 0:m[d])!==0)continue;const w=B(r,d+1,o),C=B(r+1,d,o),y=n.connected(w,C),_=B(r,d,o),g=B(r+1,d+1,o),b=n.connected(_,g);if(y&&b)return!1;y?(m[d]=T,a=!0,n.union(_,g)):b&&(m[d]=j,a=!0,n.union(w,C))}}if(!i.every(r=>r.every(d=>d!==0)))return!1;const u=X(i,t,o);for(let r=0;r<=t;r++)for(let d=0;d<=o;d++){const m=(l=e[r])==null?void 0:l[d];if(m!=null&&((c=u[r])==null?void 0:c[d])!==m)return!1}return!0}function ke(e,t,o,i){var f;const n=e.map(l=>[...l]),a=[];for(let l=0;l<=t;l++)for(let c=0;c<=o;c++)a.push({r:l,c});for(let l=a.length-1;l>0;l--){const c=Math.floor(Math.random()*(l+1)),r=a[l],d=a[c];r&&d&&(a[l]=d,a[c]=r)}const u=Math.floor((t+1)*(o+1)*i);let p=0;for(let l=0;l<=t;l++)for(let c=0;c<=o;c++)((f=n[l])==null?void 0:f[c])!==null&&p++;for(const{r:l,c}of a){if(p<=u)break;const r=n[l];if(!r)continue;const d=r[c];d!=null&&(r[c]=null,at(n,t,o)?p--:r[c]=d)}return n}function lt(e,t){if(Ce())try{const n=BigInt(Math.floor(Math.random()*Number.MAX_SAFE_INTEGER)),a=(function(u,p,f,l){return O.generate_puzzle_wasm(u,p,f,l)})(e,t,n,se);return{numbers:ke(a.numbers,e,t,se),solution:a.solution}}catch{}let o=[],i=!1;for(let n=0;n<50&&!i;n++){o=Array.from({length:e},()=>Array(t).fill(0));const a=new ie((e+1)*(t+1)),u=[];for(let f=0;f<e;f++)for(let l=0;l<t;l++)u.push({r:f,c:l});for(let f=u.length-1;f>0;f--){const l=Math.floor(Math.random()*(f+1)),c=u[f],r=u[l];c&&r&&(u[f]=r,u[l]=c)}let p=!1;for(const{r:f,c:l}of u){const c=B(f,l+1,t),r=B(f+1,l,t),d=a.connected(c,r),m=B(f,l,t),w=B(f+1,l+1,t),C=a.connected(m,w);if(d&&C){p=!0;break}const y=o[f];y&&(d?(y[l]=T,a.union(m,w)):C||Math.random()<.5?(y[l]=j,a.union(c,r)):(y[l]=T,a.union(m,w)))}p||(i=!0)}return i||(o=Array.from({length:e},(n,a)=>Array(t).fill(a%2==0?j:T))),{numbers:ke(X(o,e,t).map(n=>n.map(a=>a)),e,t,se),solution:o}}(async function(){if(!de)return ue??(ue=it().then(()=>{de=!0}).catch(e=>{throw ue=null,e})),ue})().catch(()=>{});const ct=Re({getInitialState:Ee,customHandler:(e,t)=>{if(t.type==="toggle"){if(e.solved)return e;const{row:o,col:i}=t,n=e.grid.map(r=>[...r]),a=n[o];if(!a)return e;const u=a[i];if(u===void 0)return e;t.reverse?a[i]=u===0?j:u===j?T:0:a[i]=u===0?T:u===T?j:0;let p=!1;if(n.every(r=>r.every(d=>d!==0))){const r=X(n,e.rows,e.cols);e.numbers.every((d,m)=>d.every((w,C)=>{var y;return w==null||w===((y=r[m])==null?void 0:y[C])}))&&!(function(d,m,w){const C=new ie((m+1)*(w+1));for(let y=0;y<m;y++){const _=d[y];if(_)for(let g=0;g<w;g++){const b=_[g];if(b===void 0||b===0)continue;const v=B(y,b===j?g+1:g,w),I=B(y+1,b===j?g:g+1,w);if(!C.union(v,I))return!0}}return!1})(n,e.rows,e.cols)&&(p=!0)}const f=(function(r,d,m,w){var _,g;const C=new Set,y=X(r,m,w);for(let b=0;b<=m;b++)for(let v=0;v<=w;v++){const I=(_=d[b])==null?void 0:_[v];if(I==null)continue;const $=((g=y[b])==null?void 0:g[v])??0;$>I?C.add(D(b,v)):$+[{gr:b-1,gc:v-1},{gr:b-1,gc:v},{gr:b,gc:v-1},{gr:b,gc:v}].filter(({gr:L,gc:k})=>{var h;return L>=0&&L<m&&k>=0&&k<w&&((h=r[L])==null?void 0:h[k])===0}).length<I&&C.add(D(b,v))}return C})(n,e.numbers,e.rows,e.cols),l=(function(r,d,m){var v,I,$,L;if(Ce())try{const k=new Uint8Array(d*m);for(let R=0;R<d;R++)for(let s=0;s<m;s++)k[R*m+s]=((v=r[R])==null?void 0:v[s])??0;const h=ot(k,d,m);if(h.length>0)return new Set(h)}catch{}const w=new Map,C=new Set;for(let k=0;k<d;k++)for(let h=0;h<m;h++){const R=(I=r[k])==null?void 0:I[h];if(!R||R===0)continue;const s=B(k,R===j?h+1:h,m),x=B(k+1,R===j?h:h+1,m);w.has(s)||w.set(s,[]),w.has(x)||w.set(x,[]),($=w.get(s))==null||$.push({node:x,r:k,c:h}),(L=w.get(x))==null||L.push({node:s,r:k,c:h})}const y=new Set,_=new Set,g=[],b=(k,h)=>{y.add(k),_.add(k);const R=w.get(k)??[];for(const{node:s,r:x,c:N}of R)if(s!==h)if(_.has(s)){C.add(D(x,N));for(let z=g.length-1;z>=0;z--){const A=g[z];if(!A||(C.add(D(A.r,A.c)),A.u===s||A.v===s))break}}else y.has(s)||(g.push({r:x,c:N,u:k,v:s}),b(s,k),g.pop());_.delete(k)};for(const k of w.keys())y.has(k)||b(k,-1);return C})(n,e.rows,e.cols),c=(function(r,d,m,w){var _,g;const C=new Set,y=X(r,m,w);for(let b=0;b<=m;b++)for(let v=0;v<=w;v++){const I=(_=d[b])==null?void 0:_[v];I!=null&&(((g=y[b])==null?void 0:g[v])??0)===I&&C.add(D(b,v))}return C})(n,e.numbers,e.rows,e.cols);return{...e,grid:n,solved:p,errorNodes:f,cycleCells:l,satisfiedNodes:c}}return e}});function Ee(e,t){const{numbers:o,solution:i}=lt(e,t);return{grid:Array.from({length:e},()=>Array(t).fill(0)),numbers:o,solution:i,rows:be(e),cols:be(t),solved:!1,errorNodes:new Set,cycleCells:new Set,satisfiedNodes:new Set}}const dt=(e,t,o)=>(i,n)=>{var l;const a=(l=t.grid[i])==null?void 0:l[n],u=D(i,n),p=t.cycleCells.has(u),f=e(u);return{...f,sx:{...f.sx,cursor:"pointer",border:`1px solid ${E.border.subtle}`,position:"relative","&:hover":{backgroundColor:E.interactive.hover}},children:S.jsxs(H,{sx:{width:"100%",height:"100%",position:"relative"},children:[a===j&&S.jsx(H,{sx:{position:"absolute",width:"115%",height:`${String(Math.max(2,o))}px`,backgroundColor:p?E.data.red:E.text.primary,borderRadius:"99px",top:"50%",left:"50%",transform:"translate(-50%, -50%) rotate(-45deg)",boxShadow:V.LINE,transition:ee.transition,pointerEvents:"none"}}),a===T&&S.jsx(H,{sx:{position:"absolute",width:"115%",height:`${String(Math.max(2,o))}px`,backgroundColor:p?E.data.red:E.text.primary,borderRadius:"99px",top:"50%",left:"50%",transform:"translate(-50%, -50%) rotate(45deg)",boxShadow:V.LINE,transition:ee.transition,pointerEvents:"none"}})]})}};function ut(){const[e,t]=M.useState(!1),{rows:o,cols:i,state:n,dispatch:a,size:u,mobile:p,handleNext:f,controlsProps:l}=ze({storageKeys:{size:qe,state:Je},pageTitle:xe.slant,gridConfig:{defaultSize:Qe,minSize:Ze,headerOffset:Q.layout.headerHeight,paddingOffset:160,widthLimit:We,cellSizeReference:4,mobileRowOffset:-2},boardConfig:{paddingOffset:s=>({x:s?32:224,y:Ue}),boardMaxWidth:Pe,boardSizeFactor:Ge,maxCellSize:Fe,remBase:Ve,rowOffset:1,colOffset:1},reducer:ct,getInitialState:(s,x)=>Ee(s,x),winAnimationDelay:Q.timing.winAnimationDelay,isSolved:s=>s.solved,persistence:{enabled:!e,serialize:s=>({...s,errorNodes:Array.from(s.errorNodes),cycleCells:Array.from(s.cycleCells),satisfiedNodes:Array.from(s.satisfiedNodes)}),deserialize:s=>{const x=s;return{...x,errorNodes:new Set(x.errorNodes),cycleCells:new Set(x.cycleCells),satisfiedNodes:new Set(x.satisfiedNodes)}}}}),[c,r]=M.useState(new Map);Me({storageKey:Ke,rows:o,cols:i,state:c,onRestore:s=>{r(s)},serialize:s=>Array.from(s.entries()),deserialize:s=>new Map(s)});const d=M.useRef("");M.useEffect(()=>{const s=JSON.stringify(n.numbers);d.current&&d.current!==s&&r(new Map),d.current=s},[n.numbers,n.rows,n.cols]);const m=f,{getDragProps:w}=pe({onToggle:(s,x,N)=>{a({type:"toggle",row:he(s),col:he(x),reverse:N})},checkEnabled:()=>!n.solved,touchTimeout:Q.timing.touchHoldDelay}),C=.4*u,y=Ne(dt,w,[n,u]),_=M.useMemo(()=>((s,x)=>(N,z)=>{var fe;const A=(fe=s.numbers[N])==null?void 0:fe[z],W=D(N,z),P=s.errorNodes.has(W),U=s.satisfiedNodes.has(W);return{sx:{pointerEvents:"none"},children:S.jsx(H,{sx:{borderRadius:"50%",backgroundColor:P?E.data.red:E.surface.background,border:A!=null?`2px solid ${P?E.data.red:U?"transparent":E.border.subtle}`:"none",fontSize:`${String(.5*x)}rem`,fontWeight:"800",color:P?ve.WHITE:U?E.interactive.disabledText:E.text.primary,boxShadow:U&&!P?"none":V.HINT,zIndex:5,opacity:A!=null?1:0,display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",userSelect:"none",WebkitUserSelect:"none",transform:P?"scale(1.1)":"scale(1)",width:`${String(x)}rem`,height:`${String(x)}rem`},children:A??""})}})(n,C),[n,C]),g=M.useCallback((s,x)=>{r(N=>{const z=new Map(N);return x===void 0?z.delete(s):z.set(s,x),z})},[]),b=M.useCallback(()=>{const s=new Map;n.grid.forEach((x,N)=>{x.forEach((z,A)=>{z!==0&&s.set(D(N,A),z)})}),r(s)},[n.grid]),v=M.useCallback(()=>{r(new Map)},[]),I=M.useCallback(()=>{t(!1)},[]),$=M.useCallback(s=>{s.stopPropagation()},[]),L=M.useMemo(()=>({padding:p?"1rem":"2rem"}),[p]),k=M.useMemo(()=>({userSelect:"none",padding:p?te:ne,border:"2px solid transparent",borderRadius:_e}),[p]),h=e?S.jsx(S.Fragment,{}):S.jsx(Oe,{...l,disabled:e,children:S.jsx(Y,{title:"Open Calculator",Icon:Le,onClick:()=>{t(!e)},sx:{color:"default"}})}),R=e?S.jsx(nt,{rows:o,cols:i,numbers:n.numbers,size:u,initialMoves:c,onMove:g,onCopy:b,onClear:v,onClose:I}):S.jsx($e,{size:u,rows:o+1,cols:i+1,frontProps:_,backProps:y,frontLayerSx:{pointerEvents:"none"}});return S.jsx(Ae,{children:S.jsx(Te,{title:xe.slant,infoUrl:"https://en.wikipedia.org/wiki/Gokigen_Naname",paddingBottom:{xs:"180px",md:"150px"},controls:h,contentSx:L,showTrophy:!e&&n.solved,onReset:m,boardSize:u,iconSizeRatio:Xe,primaryColor:E.primary.main,secondaryColor:E.primary.main,boardSx:k,onClick:()=>{e&&t(!1)},children:S.jsx(H,{onClick:$,children:R})})})}export{ut as default};
