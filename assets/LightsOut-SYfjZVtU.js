import{r as z,j as i}from"./vendor_react-D9AZKRQJ.js";import{g as ot,c as $t,a as rt,B as st,u as At,b as Pt,d as Bt,e as Rt,G as Dt,f as Tt,h as Ot,i as H,j as it}from"./types-NoO5evCd.js";import{C as y,T as F,R as Mt,d as at,e as Et,L as ct}from"./index-DuW26yrh.js";import{b as lt,R as Ft,E as Wt,K as Lt,c as Ut,d as Nt,N as Ht,e as Kt,f as Gt,g as dt,M as Yt}from"./vendor_mui_icons-i_Xb35He.js";import{d as T,B as h,e as K,G,M as qt,h as Vt,I as ut}from"./vendor_mui_core-CcNgE9EE.js";import{C as Y,u as Zt}from"./layout-CxuVozs6.js";import{G as Jt}from"./GlassCard-DggpD6sM.js";import"./PageLayout-B434fvh6.js";function ft(t){const n=Array(t).fill(1n);for(let o=0;o<t;o++){const e=n[o];e!==void 0&&(n[o]=e<<BigInt(t-o-1))}return n}function Qt(t,n){const o=t.length,e=[];for(let r=0;r<o;r++){const s=t[r],a=n[r];s!==void 0&&a!==void 0&&e.push(s^a)}return e}function pt(t,n){const o=t.length,e=[];for(let r=0;r<o;r++){const s=t[r];let a=0n;if(s!==void 0){for(let l=0;l<o;l++)if(s&1n<<BigInt(o-1-l)){const u=n[l];u!==void 0&&(a^=u)}}e.push(a)}return e}function Xt(t,n,o){let e=ft(t.length),r=[...t],s=n;for(;s>0;)s%2==1&&(e=pt(e,r)),r=pt(r,r),s=Math.floor(s/2);return e}function tn(t,n){const o=t.length,e=[...Array(o).keys()].sort((r,s)=>{const a=t[s],l=t[r];return a===void 0||l===void 0?0:a>l?1:a<l?-1:0});return[e.map(r=>t[r]??0n),e.map(r=>n[r]??0n)]}function xt(t){const n=t.length;let o=t,e=ft(n);for(let r=0;r<n;r++){const s=1n<<BigInt(n-r-1);[o,e]=tn(o,e);for(let a=0;a<n;a++){const l=o[a];if(l!==void 0&&a!==r&&l&s){const u=o[r],d=e[r];if(u!==void 0){const c=o[a];c!==void 0&&(o[a]=c^u)}if(d!==void 0){const c=e[a];c!==void 0&&(e[a]=c^d)}}}}return e}function nn(t,n){const o=(function(u,d){const c=d(8*u.length,8)>>>0;return gt().set(u,c/8),mt=u.length,c})(t,I.__wbindgen_malloc),e=mt,r=I.invert_matrix(o,e,n);if(r[3])throw(function(u){const d=I.__wbindgen_externrefs.get(u);return I.__externref_table_dealloc(u),d})(r[2]);var s,a,l=(s=r[0],a=r[1],s>>>=0,gt().subarray(s/8,s/8+a)).slice();return I.__wbindgen_free(r[0],8*r[1],8),l}function en(){return{__proto__:null,"./lights_out_wasm_bg.js":{__proto__:null,__wbindgen_cast_0000000000000001:function(t,n){var o;return o=t,(function(e,r){return J+=r,J>=on&&(q=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}),q.decode(),J=r),q.decode((L!==null&&L.byteLength!==0||(L=new Uint8Array(I.memory.buffer)),L).subarray(e,e+r))})(o>>>=0,n)},__wbindgen_init_externref_table:function(){const t=I.__wbindgen_externrefs,n=t.grow(4);t.set(0,void 0),t.set(n+0,void 0),t.set(n+1,null),t.set(n+2,!0),t.set(n+3,!1)}}}}let W=null;function gt(){return W!==null&&W.byteLength!==0||(W=new BigUint64Array(I.memory.buffer)),W}let L=null,q=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});q.decode();const on=2146435072;let J=0,I,mt=0;(async function(t){if(I!==void 0)return I;t!==void 0&&Object.getPrototypeOf(t)===Object.prototype&&({module_or_path:t}=t),t===void 0&&(t=new URL("/assets/lights_out_wasm_bg-CMVt8Uos.wasm",import.meta.url));const n=en();(typeof t=="string"||typeof Request=="function"&&t instanceof Request||typeof URL=="function"&&t instanceof URL)&&(t=fetch(t));const{instance:o}=await(async function(e,r){if(typeof Response=="function"&&e instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(e,r)}catch(a){if(!e.ok||!(function(l){switch(l){case"basic":case"cors":case"default":return!0}return!1})(e.type)||e.headers.get("Content-Type")==="application/wasm")throw a}const s=await e.arrayBuffer();return await WebAssembly.instantiate(s,r)}{const s=await WebAssembly.instantiate(e,r);return s instanceof WebAssembly.Instance?{instance:s,module:e}:s}})(await t,n);return(function(e){return I=e.exports,W=null,L=null,I.__wbindgen_start(),I})(o)})().catch(t=>{});const U={};function ht(t,n,o){const e=ot(n,o);if(!U[e]){const l=(function(d){if(d===1)return[1n];const c=[7n<<BigInt(d-2)];for(let p=1;p<d;p++){const x=c[p-1];if(x!==void 0){const g=x>>1n;c.push(g)}}const f=c[0];return f!==void 0&&(c[0]=f-(1n<<BigInt(d))),c})(o),u=(function(d,c){const f=d.length;let p=Array(f).fill(0n),x=0,g=c;for(;g>0n;)1n&g&&(p=Qt(p,Xt(d,x))),g>>=1n,x++;return p})(l,(function(d){const c=[0n,1n];for(let f=1;f<d;f++){const p=c[f],x=c[f-1];if(p!==void 0&&x!==void 0){const g=p<<1n;c.push(g^x)}}return c[d]??0n})(n+1));if(o<=64)try{const d=nn(new BigUint64Array(u.map(c=>BigInt.asUintN(64,c))),u.length);U[e]=Array.from(d)}catch{U[e]=xt(u)}else U[e]=xt(u)}const r=U[e],s=t.join(""),a=s?BigInt("0b"+s):0n;if(r===void 0)throw new Error("Inverse matrix not found in cache");return r.map(l=>1&(function(u){let d=0,c=u;if(c<0n)throw new Error("countBits called on negative bigint");for(;c>0n;)c&=c-1n,d++;return d})(l&a))}function yt(t,n){const o=z.useCallback((s,a)=>{const l=t(s,a);return{front:l?n.primary:n.secondary,back:l?n.secondary:n.primary}},[t,n]),e=z.useCallback((s,a)=>(function(l,u,d){const c=d(l,u),f={},p=c===d(l-1,u),x=c===d(l+1,u),g=c===d(l,u-1),j=c===d(l,u+1);return(p||g)&&(f.borderTopLeftRadius=0),(p||j)&&(f.borderTopRightRadius=0),(x||g)&&(f.borderBottomLeftRadius=0),(x||j)&&(f.borderBottomRightRadius=0),f})(s,a,t),[t]),r=z.useCallback((s,a)=>(function(u,d,c){const f=c(u,d),p=c(u,d+1),x=c(u+1,d),g=c(u+1,d+1);let j=!0;return f&&g||!(f+p+x+g<3)||(j=!1),j})(s,a,t)?n.primary:n.secondary,[t,n]);return z.useMemo(()=>({getColor:o,getBorder:e,getFiller:r}),[o,e,r])}function bt(t,n){const{grid:o,rows:e,cols:r}=t;return yt(z.useCallback((s,a)=>{if(s<0||a<0||s>=e||a>=r)return-1;const l=o[s];return l===void 0?0:l>>a&1},[o,e,r]),n)}const Q={FAST:"background-color 100ms ease-in-out, color 100ms ease-in-out, opacity 100ms ease-in-out, border-radius 100ms ease-in-out",DEFAULT:"background-color 200ms ease, color 200ms ease, opacity 200ms ease, border-radius 200ms ease"},jt={DROP:"drop-shadow(0 2px 4px rgba(0,0,0,0.2))"},rn=1.25,wt={MOBILE:-28,DESKTOP:-40},sn="lights-out-size",an="lights-out-state";function X({getColor:t,getBorder:n}){return(o,e)=>{const{front:r}=t(o,e);return{backgroundColor:r,color:r,children:i.jsx(lt,{}),style:n(o,e),sx:{transition:Q.DEFAULT}}}}function V(t,n,o){return yt(z.useCallback((e,r)=>e!==0||r<0||r>=n?-1:t[r]??0,[t,n]),o)}const cn=({children:t})=>i.jsx(T,{variant:"h5",sx:{color:y.text.primary,fontWeight:F.fontWeight.bold,textAlign:"left",fontSize:F.fontSize.h2},children:t}),tt=({Icon:t,title:n,text:o})=>i.jsxs(h,{sx:{px:2},children:[i.jsxs(T,{variant:"h6",sx:{color:y.text.primary,fontWeight:F.fontWeight.semibold,display:"flex",alignItems:"center",mb:1.5,fontSize:F.fontSize.subheading},children:[i.jsx(t,{sx:{mr:2,color:y.primary.main,fontSize:"1.75rem"}}),n]}),i.jsx(T,{variant:"body1",sx:{color:y.text.secondary,lineHeight:1.6,fontSize:F.fontSize.body,ml:6},children:o})]}),ln=["Chasing Lights","How It Works","Calculator"];function dn({cols:t,size:n,isMobile:o,inputProps:e,outputProps:r,onReset:s}){return i.jsx(h,{sx:{animation:"fadeIn 0.3s ease",textAlign:"center",flex:1,display:"flex",flexDirection:"column"},children:i.jsxs(h,{sx:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center",gap:3},children:[i.jsxs(h,{children:[i.jsxs(T,{variant:"subtitle2",sx:{mb:1,color:y.text.primary,fontWeight:"bold"},children:["Input"," ",i.jsx(h,{component:"span",sx:{color:y.text.secondary,fontWeight:"normal"},children:"(Bottom Row)"})]}),i.jsx(Y,{space:0,rows:1,cols:t,size:n*(o?.9:.8),cellProps:e})]}),i.jsxs(h,{children:[i.jsxs(T,{variant:"subtitle2",sx:{mb:1,color:y.text.primary,fontWeight:"bold"},children:["Solution"," ",i.jsx(h,{component:"span",sx:{color:y.text.secondary,fontWeight:"normal"},children:"(Top Row)"})]}),i.jsx(Y,{space:0,rows:1,cols:t,size:n*(o?.9:.8),cellProps:r})]}),i.jsx(h,{sx:{display:"flex",justifyContent:"center"},children:i.jsx(K,{variant:"outlined",size:"small",startIcon:i.jsx(Ft,{}),onClick:s,sx:{borderColor:y.border.subtle,color:y.text.secondary},children:"Clear Pattern"})})]})})}function nt(t,n){return Array.from({length:t},()=>0)}function N(t,n,o,e,r){const s=[...o];let a=1<<n;if(n>0&&(a|=1<<n-1),n<r-1&&(a|=1<<n+1),s[t]!==void 0&&(s[t]^=a),t>0){const l=s[t-1];l!==void 0&&(s[t-1]=l^1<<n)}if(t<e-1){const l=s[t+1];l!==void 0&&(s[t+1]=l^1<<n)}return s}function St(t,n,o,e,r){let s=1<<n;if(n>0&&(s|=1<<n-1),n<r-1&&(s|=1<<n+1),o[t]!==void 0&&(o[t]^=s),t>0){const a=o[t-1];a!==void 0&&(o[t-1]=a^1<<n)}if(t<e-1){const a=o[t+1];a!==void 0&&(o[t+1]=a^1<<n)}}function et(t,n){const o=nt(t);for(let e=0;e<t;e++)for(let r=0;r<n;r++)Math.random()>.5&&St(e,r,o,t,n);return o}function Z(t,n){return{grid:nt(t),score:0,rows:rt(t),cols:rt(n),initialized:!1}}const un=$t({getInitialState:Z,customHandler:(t,n)=>{const{rows:o,cols:e}=t;switch(n.type){case"adjacent":return{...t,grid:N(n.row,n.col,t.grid,o,e)};case"multi_adjacent":{const r=[...t.grid];return n.moves.forEach(({row:s,col:a})=>{St(s,a,r,o,e)}),{...t,grid:r}}case"random":case"randomize":return{...t,grid:et(o,e),initialized:!0};case"resize":{const r=n.newRows??n.rows??t.rows,s=n.newCols??n.cols??t.cols;return{...Z(r,s),grid:et(r,s),initialized:!0}}case"new":case"next":return{...Z(o,e),grid:et(o,e),score:t.score+1,initialized:!0}}return t}});function vt(t,n,o,e,r,s=1){const a=t.length,l={},u=100/a;for(let d=0;d<a;d++){const c=d*u,f=(d+1)*u;let p=r.secondary,x=!1,g="";const j=t[d],w=d+1<a?t[d+1]:null;if(j&&w){const k=N(n,o,j,e,e);x=!0;for(let b=0;b<e;b++)if(k[b]!==w[b]){x=!1;break}if(x){const b=j[n];b!==void 0&&(p=b>>o&1?r.secondary:r.primary,g=`"${String(d+1)}"`)}}x?(l[`${String(c)}%`]={opacity:0,content:g,color:p,transform:"scale(0.5)"},l[`${String(c+u*(.1/s))}%`]={opacity:1,content:g,color:p,transform:"scale(1.2)"},l[`${String(c+u*(.2/s))}%`]={opacity:1,content:g,color:p,transform:"scale(1)"},l[`${String(f-u*(.1/s))}%`]={opacity:1,content:g,color:p,transform:"scale(1)"},l[`${String(f)}%`]={opacity:0,content:g,color:p,transform:"scale(0.5)"}):(l[`${String(c)}%`]={opacity:0,content:'""',color:p,transform:"scale(0.5)"},l[`${String(f)}%`]={opacity:0,content:'""',color:p,transform:"scale(0.5)"})}return l}function zt(t,n,o){const e=t.length,r={},s=100/e;for(let a=0;a<e;a++){const l=a*s,u=(a+1)*s;let d=o.secondary,c=!1,f="";const p=t[a],x=a+1<e?t[a+1]:null;p&&x&&p[n]!==x[n]&&(c=!0,d=p[n]===1?o.secondary:o.primary,f=`"${String(a+1)}"`),c?(r[`${String(l)}%`]={opacity:0,content:f,color:d,transform:"scale(0.5)"},r[`${String(l+.05*s)}%`]={opacity:1,content:f,color:d,transform:"scale(1.2)"},r[`${String(l+.1*s)}%`]={opacity:1,content:f,color:d,transform:"scale(1)"},r[`${String(u-.05*s)}%`]={opacity:1,content:f,color:d,transform:"scale(1)"},r[`${String(u)}%`]={opacity:0,content:f,color:d,transform:"scale(0.5)"}):(r[`${String(l)}%`]={opacity:0,content:'""',color:d,transform:"scale(0.5)"},r[`${String(u)}%`]={opacity:0,content:'""',color:d,transform:"scale(0.5)"})}return r}function fn({boardStates:t,inputStates:n,dims:o,id:e,palette:r,children:s}){const a=z.useMemo(()=>[...t.flatMap((l,u)=>Array.from({length:o},(d,c)=>({name:`${e}-board-icon-${String(u)}-${String(c)}`,frames:vt(t,u,c,o,r)}))),...n.flatMap((l,u)=>({name:`${e}-input-icon-0-${String(u)}`,frames:zt(n,u,r)}))],[t,n,o,e,r]);return i.jsxs(i.Fragment,{children:[i.jsx("style",{children:a.map(l=>`
                @keyframes ${l.name} {
                    ${Object.entries(l.frames).map(([u,d])=>`
                        ${u} {
                            ${Object.entries(d).map(([c,f])=>`${c.replace(/[A-Z]/g,p=>`-${p.toLowerCase()}`)}: ${f};`).join(" ")}
                        }
                    `).join("")}
                }
            `).join("")}),s]})}function kt(t,n){const o=[...t];let e=t.at(-1);if(!e)return o;for(let r=1;r<n;r++){const s=e[r-1];if(s!==void 0)for(let a=0;a<n;a++){if(!(s>>a&1))continue;const l=N(r,a,e,n,n);o.push(l),e=l}}return o}function Ct(t,n){const o=t.at(-1);if(!o)return t;const e=[...t];for(;e.length<n;)e.push([...o]);return e}function pn(t,n){let o=nt(n);for(const w of t)o=N(Math.floor(w/n),w%n,o,n,n);const e=kt([o],n),r=e.at(-1);if(!r)return{boardStates:[],inputStates:[],outputStates:[]};const s=r.at(-1)??0,a=Array.from({length:n},(w,k)=>s>>k&1),{input:l,output:u}=(function(w,k){const b=Array(k).fill(0),_=[b],O=[b],B=[...b];for(let $=0;$<k;$++){if(!w[$])continue;B[$]=1;const R=[...B],m=ht(R,k,k);_.push(R),O.push(m)}return{input:_,output:O}})(a,n),d=e.length+l.length-1,c=u.at(-1);if(!c)return{boardStates:[],inputStates:[],outputStates:[]};let f=[...r];for(;e.length<d;)e.push([...r]);const p=l[0];for(;l.length<d;)p&&l.unshift([...p]);const x=u[0];for(;u.length<d;)x&&u.unshift([...x]);for(let w=0;w<n;w++)c[w]&&(f=N(0,w,f,n,n),e.push([...f]));const g=kt(e,n),j=g.length;return{boardStates:g,inputStates:Ct(l,j),outputStates:Ct(u,j)}}function xn({start:t=[],dims:n=3,size:o,palette:e,getFrontProps:r,getBackProps:s}){const[a,l]=z.useState(0);z.useEffect(()=>{const m=setInterval(()=>{l(S=>S+1)},2e3);return()=>{clearInterval(m)}},[]);const u=pn(t,n),d=o,{boardStates:c,inputStates:f,outputStates:p}=u,x=a%f.length,g=x===f.length-1,j=bt({grid:c[x]??c[0]??[],rows:n,cols:n},e),w=r(j),k=s(j),b=(function(m,S,v,C){return(D,A)=>{const M=vt(m,D,A,S,C),E=m.length,P=`${v}-board-icon-${String(D)}-${String(A)}`;return{icon:i.jsx(h,{sx:{width:"100%",height:"100%",position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",zIndex:2,"&::after":{content:'""',fontSize:{xs:"0.8rem",sm:"1.2rem"},fontWeight:"bold",filter:jt.DROP,paddingTop:{xs:"0.08rem",sm:"0.15rem"},animation:`${P} ${String(2*E)}s linear infinite`}}}),keyframes:M,keyframeName:P}}})(c,n,"example",e),_=V(f[x]??[],n,e),O=V(p[x]??[],n,e),B=X(_),$=X(O),R=(function(m,S,v,C){return(D,A)=>{const M=zt(m,A,C),E=m.length,P=`${v}-input-icon-${String(D)}-${String(A)}`;return{icon:i.jsx(h,{sx:{width:"100%",height:"100%",position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",zIndex:2,"&::after":{content:'""',fontSize:{xs:"0.8rem",sm:"1.2rem"},fontWeight:"bold",filter:jt.DROP,paddingTop:{xs:"0.08rem",sm:"0.15rem"},animation:`${P} ${String(2*E)}s linear infinite`}}}),keyframes:M,keyframeName:P}}})(f,0,"example",e);return i.jsx(fn,{boardStates:c,inputStates:f,dims:n,id:"example",palette:e,children:i.jsx(G,{container:!0,size:12,spacing:2,sx:{height:"100%"},children:i.jsxs(G,{container:!0,size:12,wrap:"nowrap",sx:{justifyContent:"center",alignItems:"center",flex:1,height:"100%",overflow:"hidden"},children:[i.jsx(G,{size:6,sx:{display:"flex",justifyContent:"center",alignItems:"center",overflow:"hidden"},children:i.jsxs(h,{sx:{position:"relative",display:"inline-flex"},children:[i.jsx(st,{size:d,rows:n,cols:n,frontProps:(m,S)=>{const v=w(m,S),C=b(m,S);return{...v,children:i.jsxs(i.Fragment,{children:[v.children,C.icon]}),sx:{...v.sx??{},position:"relative"}}},backProps:k}),i.jsx(h,{sx:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",opacity:g?1:0,transform:g?"scale(1)":"scale(0.5)",visibility:g?"visible":"hidden",transition:"all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1)",pointerEvents:"none",zIndex:10},children:(()=>{const m=c[f.length-1],S=m==null?void 0:m.every(v=>v===(1<<n)-1);return i.jsx(Wt,{sx:{fontSize:{xs:"2.5rem",sm:"4rem"},color:S?e.secondary:e.primary}})})()})]})}),i.jsxs(G,{container:!0,size:6,spacing:2,sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[i.jsxs(h,{sx:{mb:2,textAlign:"center"},children:[i.jsx(T,{variant:"subtitle2",sx:{mb:1,color:y.text.secondary},children:"Input"}),i.jsx(Y,{rows:1,cols:n,size:d,cellProps:(m,S)=>{const v=B(m,S),C=R(m,S);return{...v,children:i.jsxs(i.Fragment,{children:[v.children,C.icon]}),sx:{...v.sx,position:"relative"}}},space:0})]}),i.jsxs(h,{sx:{textAlign:"center"},children:[i.jsx(Y,{rows:1,cols:n,size:d,cellProps:$,space:0}),i.jsx(T,{variant:"subtitle2",sx:{mt:1,color:y.text.secondary},children:"Result"})]})]})]})})})}function gn({size:t,palette:n,getFrontProps:o,getBackProps:e}){return i.jsx(h,{sx:{flex:1,display:"flex",flexDirection:"column",animation:"fadeIn 0.3s ease"},children:i.jsx(h,{sx:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center"},children:i.jsx(xn,{dims:3,size:.7*t,start:[1,3,8],palette:n,getFrontProps:o,getBackProps:e})})})}function mn(){return i.jsx(h,{sx:{animation:"fadeIn 0.3s ease",flex:1,display:"flex",flexDirection:"column"},children:i.jsxs(h,{sx:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center",gap:4},children:[i.jsx(tt,{Icon:Lt,title:"Chase to Bottom",text:"Turn off rows from top to bottom by clicking lights in each row to push them down."}),i.jsx(tt,{Icon:Ut,title:"Use Calulator",text:"Enter the remaining lights pattern from the bottom row into the calculator on the last page."}),i.jsx(tt,{Icon:Nt,title:"Chase Again",text:"Apply the solution pattern to the top row, then chase them down again to solve the puzzle."})]})})}function hn({step:t,totalSteps:n,onBack:o,onNext:e}){return i.jsxs(h,{sx:{p:2.5,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx(K,{onClick:o,disabled:t===0,startIcon:i.jsx(Ht,{}),sx:{visibility:t===0?"hidden":"visible",color:y.text.primary},children:"Back"}),i.jsx(h,{sx:{display:"flex",gap:1},children:Array.from({length:n},(r,s)=>i.jsx(h,{sx:{width:8,height:8,borderRadius:"50%",backgroundColor:t===s?y.primary.main:y.interactive.disabled,transition:"background-color 0.3s"}},s))}),i.jsx(K,{onClick:e,disabled:t===n-1,endIcon:i.jsx(Kt,{}),sx:{visibility:t===n-1?"hidden":"visible",color:y.text.primary},children:"Next"})]})}const yn=Jt;function bn(t){const{rows:n,cols:o,size:e,open:r,palette:s,toggleOpen:a,getFrontProps:l,getBackProps:u}=t,d=Zt("md"),[c,f]=z.useState(0),[p,x]=z.useState(Array(o).fill(0));z.useEffect(()=>{x(Array(o).fill(0))},[o,s]);const g=z.useCallback(m=>{const S=parseInt(m,10);x(v=>{const C=[...v];return C[S]!==void 0&&(C[S]^=1),C})},[x]),j=ht(p,n,o),{getDragProps:w}=At({onAction:g,checkEnabled:()=>c===2,posAttribute:"data-col"}),k=V(p,o,s),b=V(j,o,s),_=(function(m,S){const{getColor:v,getBorder:C}=m;return(D,A)=>{const{front:M,back:E}=v(D,A),P=S(A.toString());return{...P,backgroundColor:M,style:C(D,A),sx:{...P.sx,"&:hover":{cursor:"pointer",color:E}},color:M,children:i.jsx(lt,{})}}})(k,w),O=X(b),B=()=>{a()},$=`#${Mt.pages.LightsOutResearch}`;let R;return R=d?i.jsx(ut,{component:"a",href:$,size:"small",sx:{color:y.text.secondary},children:i.jsx(dt,{})}):i.jsx(K,{component:"a",href:$,variant:"outlined",size:"small",startIcon:i.jsx(dt,{}),sx:{borderColor:y.border.subtle,color:y.text.secondary,fontSize:"0.75rem",py:.75,px:1.5,"&:hover":{borderColor:y.primary.main,color:y.primary.main,backgroundColor:y.interactive.hover}},children:"Analysis"}),i.jsx(qt,{open:r,onClose:B,slots:{backdrop:Vt},slotProps:{backdrop:{sx:{backgroundColor:m=>m.palette.mode==="dark"?"hsla(0, 0%, 3%, 0.85)":"hsla(0, 0%, 98%, 0.85)",backdropFilter:"blur(12px) saturate(180%)",transition:"all 0.3s ease-in-out !important"}}},sx:{zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs(h,{sx:{outline:"none",display:"flex",justifyContent:"center",alignItems:"center",width:"100%"},children:[i.jsxs(yn,{onClick:m=>{m.stopPropagation()},sx:{width:"100%",maxWidth:"1000px",height:{xs:"630px",sm:"495px"},minHeight:{xs:"630px",sm:"495px"},display:"flex",flexDirection:"column",p:0,overflow:"hidden",position:"relative",m:2},children:[i.jsxs(h,{sx:{flex:1,overflowY:c===1?"hidden":"auto",p:{xs:2.5,md:3},display:"flex",flexDirection:"column"},children:[i.jsxs(h,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,px:2},children:[i.jsx(cn,{children:ln[c]}),i.jsxs(h,{sx:{display:"flex",gap:2,alignItems:"center"},children:[R,i.jsx(ut,{onClick:B,size:"small",sx:{color:y.text.secondary},children:i.jsx(Gt,{})})]})]}),c===0&&i.jsx(mn,{}),c===1&&i.jsx(gn,{size:e,palette:s,getFrontProps:l,getBackProps:u}),c===2&&i.jsx(dn,{cols:o,size:e,isMobile:d,inputProps:_,outputProps:O,onReset:()=>{x(Array(o).fill(0))}})]}),i.jsx(hn,{step:c,totalSteps:3,onBack:()=>{c>0&&f(c-1)},onNext:()=>{c<2?f(c+1):a()}})]}),i.jsx("style",{children:`
                    @keyframes fadeIn {
                        from { opacity: 0; transform: translateY(10px); }
                        to { opacity: 1; transform: translateY(0); }
                    }
                `})]})})}const jn=i.jsx(h,{sx:{width:"45%",height:"45%",borderRadius:"50%",backgroundColor:"currentColor"}});function It(t,n){const{getColor:o,getBorder:e}=n;return(r,s)=>{const a=e(r,s),{front:l,back:u}=o(r,s),d=ot(r,s),c=t(d);return{...c,children:jn,backgroundColor:l,color:l,style:a,sx:{...c.sx,"&:hover":{cursor:"pointer",color:u}}}}}function _t(t){return(n,o)=>({backgroundColor:t.getFiller(n,o),transition:Q.FAST})}function wn(t){const n=It(o=>({onMouseDown:()=>{},onMouseEnter:()=>{},onTouchStart:()=>{},"data-pos":o,sx:{touchAction:"none",transition:"none"}}),t);return(o,e)=>({...n(o,e),onMouseDown:void 0,onMouseEnter:void 0,onTouchStart:void 0,sx:{}})}function Sn(){const{rows:t,cols:n,state:o,dispatch:e,size:r,mobile:s,solved:a,handleNext:l,controlsProps:u}=Pt({storageKeys:{size:sn,state:an},pageTitle:at.lightsOut,gridConfig:{defaultSize:null,minSize:2,maxSize:10,headerOffset:{mobile:ct.headerHeight.xs,desktop:ct.headerHeight.md},paddingOffset:120,cellSizeReference:{mobile:H.gridSizes.mobile,desktop:H.gridSizes.desktop},mobileRowOffset:-2},boardConfig:{paddingOffset:180,boardMaxWidth:1200,boardSizeFactor:.9,maxCellSize:80,remBase:16},reducer:un,getInitialState:Z,winAnimationDelay:H.timing.winAnimationDelay,isSolved:b=>b.initialized&&b.grid.every(_=>_===0)}),[d,c]=z.useReducer(b=>!b,!1),f=z.useMemo(()=>({primary:y.primary.main,secondary:y.primary.dark}),[]),{getDragProps:p}=Bt({onToggle:(b,_)=>{e({type:"adjacent",row:it(b),col:it(_)})},checkEnabled:()=>!a,touchTimeout:H.timing.interactionDelay,transition:Q.FAST}),x=z.useMemo(()=>o.initialized&&o.grid.every(b=>b===(1<<n)-1),[o.initialized,o.grid,n]),g=bt(o,f),j=Rt(It,p,[g]),w=z.useMemo(()=>_t(g),[g]),k=i.jsx(Ot,{...u,children:i.jsx(Et,{title:"How to Play",Icon:Yt,onClick:c})});return i.jsx(Dt,{children:i.jsxs(Tt,{title:at.lightsOut,infoUrl:"https://en.wikipedia.org/wiki/Lights_Out_(game)",showTrophy:a,onReset:l,boardSize:r,iconSizeRatio:rn,primaryColor:f.primary,secondaryColor:f.secondary,useSecondaryTrophy:x,boardSx:{marginTop:s?`${String(wt.MOBILE)}px`:`${String(wt.DESKTOP)}px`},controls:k,children:[i.jsx(st,{size:r,rows:t,cols:n,frontProps:j,backProps:w}),d&&i.jsx(bn,{rows:t,cols:n,size:r,open:d,palette:f,toggleOpen:c,getFrontProps:wn,getBackProps:_t})]})})}export{Sn as default};
