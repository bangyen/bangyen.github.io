import{r as l,j as $}from"./vendor_react-D9AZKRQJ.js";import{p as P}from"./pako.esm-D0myxAWH.js";import{a as i,R}from"./ResearchDemo-D76ePART.js";import{h as k,T as D,i as T}from"./vendor_mui_icons-i_Xb35He.js";import{d as B,C as c,U as H}from"./index-Dh9eOJXR.js";import"./GlassCard-CnxQqiCZ.js";import"./vendor_mui_core-CcNgE9EE.js";import"./vendor_recharts-CEnr0VOu.js";import"./PageLayout-CHV4ftwa.js";const b=(r,a,o,u,n,d)=>{if(r.length===0)return S();const p=r.filter(t=>t.num_firms===a&&t.model_type===o&&t.demand_elasticity===u&&t.base_price===n&&t.collusion_enabled===d);return p.length===0?r.filter(t=>t.num_firms===a&&t.model_type===o).sort((t,s)=>t.round-s.round).slice(0,i.oligopoly.maxRounds):p.sort((t,s)=>t.round-s.round).slice(0,15)},S=()=>{const r=[];for(let a=1;a<=i.oligopoly.maxRounds;a++){const o=i.oligopoly.simulation;r.push({round:a,price:o.fallbackPrice+Math.sin(a*o.priceFrequency)*o.priceAmplitude,hhi:o.fallbackHHI+Math.sin(a*o.hhiFrequency)*o.hhiAmplitude,collusion:a>o.collusionStart&&a<o.collusionEnd})}return r},I=()=>{const[r,a]=l.useState(i.oligopoly.defaultFirms),[o,u]=l.useState(i.oligopoly.defaultElasticity),[n,d]=l.useState(i.oligopoly.defaultBasePrice),[p,t]=l.useState([]),[s,M]=l.useState([]),[w,x]=l.useState(!0),m=i.modelTypes.cournot,y=!1;l.useEffect(()=>{document.title=B.oligopoly,(async()=>{x(!0);try{const e=await(async()=>{try{const f=await fetch("/oligopoly_data.json.gz");if(!f.ok)throw new Error(`HTTP error! status: ${f.status.toString()} - Failed to load Oligopoly data`);const F=await f.arrayBuffer(),h=new Uint8Array(F),_=h[0]===31&&h[1]===139?P.ungzip(h,{to:"string"}):new TextDecoder().decode(F),A=JSON.parse(_);if(!Array.isArray(A))throw new Error("Invalid data format: expected array");return A}catch{return[]}})();M(e);const g=b(e,r,m,o,n,y);t(g)}catch{t(S())}finally{x(!1)}})()},[r,o,n,y,m]),l.useEffect(()=>{if(s.length>0){const e=b(s,r,m,o,n,y);t(e)}},[r,o,n,s,m,y]);const E=[{label:"Number of Firms",icon:k,color:c.primary.main,value:r,onChange:a,options:i.oligopoly.options.firms},{label:"Demand Elasticity",icon:D,color:c.data.green,value:o,onChange:u,options:i.oligopoly.options.elasticity},{label:"Base Price",icon:T,color:c.data.amber,value:n,onChange:d,options:i.oligopoly.options.price}],C={type:"line",xAxisKey:"round",yAxisFormatter:e=>`$${e.toFixed(2)}`,yAxisDomain:["dataMin - 5","dataMax + 5"],dualYAxis:!0,rightYAxisFormatter:e=>e.toFixed(2),rightYAxisDomain:[`dataMin - ${String(i.oligopoly.simulation.hhiFrequency)}`,`dataMax + ${String(i.oligopoly.simulation.hhiFrequency)}`],tooltipLabelFormatter:e=>`Round ${e.toString()}`,tooltipFormatter:(e,g)=>[g==="Market Price"?`$${e.toFixed(2)}`:e.toFixed(2),g],lines:[{dataKey:"price",name:"Market Price",color:c.primary.main,yAxisId:"left"},{dataKey:"hhi",name:"HHI Concentration",color:c.data.amber,yAxisId:"right"}]};return $.jsx(R,{title:"Oligopoly",subtitle:"Agent-Based Economic Competition Analysis",githubUrl:H.oligopolyRepo,chartData:p,chartConfig:C,chartTitle:"Market Dynamics",controls:E,loading:w,loadingMessage:"Loading Cournot simulation data...",onReset:()=>{a(i.oligopoly.defaultFirms),u(i.oligopoly.defaultElasticity),d(i.oligopoly.defaultBasePrice)},resetLabel:"Reset"})};export{I as default};
