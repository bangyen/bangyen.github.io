import{r as t,j as e}from"./vendor_react-DdkxgTu-.js";import{g as n,c as o,a as r,B as s,b as i,C as a,u as c,d as l,e as d,f as u,h as f,i as p,j as x,G as m,k as g,l as h}from"./types-D0iS6c8p.js";import{C as y,T as j,d as b,e as S,L as v}from"./index-CMZK3Rmg.js";import{b as w,c as k,R as C,E as I,K as z,d as A,e as $,N as P,f as D,g as T,M as R}from"./vendor_mui_icons-Cj7c5CH-.js";import{d as B,B as O,e as E,G as M,M as F,h as N,I as W}from"./vendor_mui_core-BDo3HO1u.js";import{G as H}from"./PageLayout-ZRBH6WUQ.js";function L(t){const e=new Array(t).fill(1n);for(let n=0;n<t;n++){const o=e[n];void 0!==o&&(e[n]=o<<BigInt(t-n-1))}return e}function _(t,e){const n=t.length,o=[];for(let r=0;r<n;r++){const n=t[r],s=e[r];void 0!==n&&void 0!==s&&o.push(n^s)}return o}function K(t,e){const n=t.length,o=[];for(let r=0;r<n;r++){const s=t[r];let i=0n;if(void 0!==s)for(let t=0;t<n;t++)if(s&1n<<BigInt(n-1-t)){const n=e[t];void 0!==n&&(i^=n)}o.push(i)}return o}function U(t,e,n){let o=L(t.length),r=[...t],s=e;for(;s>0;)s%2==1&&(o=K(o,r)),r=K(r,r),s=Math.floor(s/2);return o}function G(t,e){const n=t.length,o=[...new Array(n).keys()].sort((e,n)=>{const o=t[n],r=t[e];return void 0===o||void 0===r?0:o>r?1:o<r?-1:0});return[o.map(e=>t[e]??0n),o.map(t=>e[t]??0n)]}const Y={};function Z(t,e,o){const r=n(e,o);if(!Y[r]){const t=function(t){if(1===t)return[1n];const e=[7n<<BigInt(t-2)];for(let o=1;o<t;o++){const t=e[o-1];if(void 0!==t){const n=t>>1n;e.push(n)}}const n=e[0];return void 0!==n&&(e[0]=n-(1n<<BigInt(t))),e}(o),n=function(t,e){const n=t.length;let o=new Array(n).fill(0n),r=0,s=e;for(;s>0n;)1n&s&&(o=_(o,U(t,r))),s>>=1n,r++;return o}(t,function(t){const e=[0n,1n];for(let n=1;n<t;n++){const t=e[n],o=e[n-1];if(void 0!==t&&void 0!==o){const n=t<<1n;e.push(n^o)}}return e[t]??0n}(e+1));Y[r]=function(t){const e=t.length;let n=t,o=L(e);for(let r=0;r<e;r++){const t=1n<<BigInt(e-r-1);[n,o]=G(n,o);for(let s=0;s<e;s++){const e=n[s];if(void 0!==e&&s!==r&&e&t){const t=n[r],e=o[r];if(void 0!==t){const e=n[s];void 0!==e&&(n[s]=e^t)}if(void 0!==e){const t=o[s];void 0!==t&&(o[s]=t^e)}}}}return o}(n)}const s=Y[r],i=t.join(""),a=i?BigInt("0b"+i):0n;if(void 0===s)throw new Error("Inverse matrix not found in cache");return s.map(t=>1&function(t){let e=0,n=t;if(n<0n)throw new Error("countBits called on negative bigint");for(;n>0n;)n&=n-1n,e++;return e}(t&a))}function q(t,e){return Array.from({length:t},()=>0)}function J(t,e,n,o,r){const s=[...n];let i=1<<e;if(e>0&&(i|=1<<e-1),e<r-1&&(i|=1<<e+1),void 0!==s[t]&&(s[t]^=i),t>0){const n=s[t-1];void 0!==n&&(s[t-1]=n^1<<e)}if(t<o-1){const n=s[t+1];void 0!==n&&(s[t+1]=n^1<<e)}return s}function Q(t,e,n,o,r){let s=1<<e;if(e>0&&(s|=1<<e-1),e<r-1&&(s|=1<<e+1),void 0!==n[t]&&(n[t]^=s),t>0){const o=n[t-1];void 0!==o&&(n[t-1]=o^1<<e)}if(t<o-1){const o=n[t+1];void 0!==o&&(n[t+1]=o^1<<e)}}function V(t,e){const n=q(t);for(let o=0;o<t;o++)for(let r=0;r<e;r++)Math.random()>.5&&Q(o,r,n,t,e);return n}function X(t,e){return{grid:q(t),score:0,rows:r(t),cols:r(e),initialized:!1}}const tt=o({getInitialState:X,customHandler:(t,e)=>{const{rows:n,cols:o}=t;switch(e.type){case"adjacent":return{...t,grid:J(e.row,e.col,t.grid,n,o)};case"multi_adjacent":{const r=[...t.grid];for(const{row:t,col:s}of e.moves)Q(t,s,r,n,o);return{...t,grid:r}}case"random":case"randomize":return{...t,grid:V(n,o),initialized:!0};case"resize":{const n=e.newRows??e.rows??t.rows,o=e.newCols??e.cols??t.cols;return{...X(n,o),grid:V(n,o),initialized:!0}}case"new":case"next":return{...X(n,o),grid:V(n,o),score:t.score+1,initialized:!0}}return t}});function et(t,e,n,o,r,s=1){const i=t.length,a={},c=100/i;for(let l=0;l<i;l++){const d=l*c,u=(l+1)*c;let f=r.secondary,p=!1,x="";const m=t[l],g=l+1<i?t[l+1]:null;if(m&&g){const t=J(e,n,m,o,o);p=!0;for(let e=0;e<o;e++)if(t[e]!==g[e]){p=!1;break}if(p){const t=m[e];if(void 0!==t){f=t>>n&1?r.secondary:r.primary,x=`"${String(l+1)}"`}}}p?(a[`${String(d)}%`]={opacity:0,content:x,color:f,transform:"scale(0.5)"},a[`${String(d+c*(.1/s))}%`]={opacity:1,content:x,color:f,transform:"scale(1.2)"},a[`${String(d+c*(.2/s))}%`]={opacity:1,content:x,color:f,transform:"scale(1)"},a[`${String(u-c*(.1/s))}%`]={opacity:1,content:x,color:f,transform:"scale(1)"},a[`${String(u)}%`]={opacity:0,content:x,color:f,transform:"scale(0.5)"}):(a[`${String(d)}%`]={opacity:0,content:'""',color:f,transform:"scale(0.5)"},a[`${String(u)}%`]={opacity:0,content:'""',color:f,transform:"scale(0.5)"})}return a}function nt(t,e,n){const o=t.length,r={},s=100/o;for(let i=0;i<o;i++){const a=i*s,c=(i+1)*s;let l=n.secondary,d=!1,u="";const f=t[i],p=i+1<o?t[i+1]:null;if(f&&p&&f[e]!==p[e]){d=!0;l=1===f[e]?n.secondary:n.primary,u=`"${String(i+1)}"`}d?(r[`${String(a)}%`]={opacity:0,content:u,color:l,transform:"scale(0.5)"},r[`${String(a+.05*s)}%`]={opacity:1,content:u,color:l,transform:"scale(1.2)"},r[`${String(a+.1*s)}%`]={opacity:1,content:u,color:l,transform:"scale(1)"},r[`${String(c-.05*s)}%`]={opacity:1,content:u,color:l,transform:"scale(1)"},r[`${String(c)}%`]={opacity:0,content:u,color:l,transform:"scale(0.5)"}):(r[`${String(a)}%`]={opacity:0,content:'""',color:l,transform:"scale(0.5)"},r[`${String(c)}%`]={opacity:0,content:'""',color:l,transform:"scale(0.5)"})}return r}function ot(t,e){const n=[...t];let o=t.at(-1);if(!o)return n;for(let r=1;r<e;r++){const t=o[r-1];if(void 0!==t)for(let s=0;s<e;s++){if(!(t>>s&1))continue;const i=J(r,s,o,e,e);n.push(i),o=i}}return n}function rt(t,e){const n=t.at(-1);if(!n)return t;const o=[...t];for(;o.length<e;)o.push([...n]);return o}function st(t,e){let n=q(e);for(const g of t){n=J(Math.floor(g/e),g%e,n,e,e)}const o=ot([n],e),r=o.at(-1);if(!r)return{boardStates:[],inputStates:[],outputStates:[]};const s=r.at(-1)??0,i=Array.from({length:e},(t,e)=>s>>e&1),{input:a,output:c}=function(t,e){const n=new Array(e).fill(0),o=[n],r=[n],s=[...n];for(let i=0;i<e;i++){if(!t[i])continue;s[i]=1;const n=[...s],a=Z(n,e,e);o.push(n),r.push(a)}return{input:o,output:r}}(i,e),l=o.length+a.length-1,d=c.at(-1);if(!d)return{boardStates:[],inputStates:[],outputStates:[]};let u=[...r];for(;o.length<l;)o.push([...r]);const f=a[0];for(;a.length<l;)f&&a.unshift([...f]);const p=c[0];for(;c.length<l;)p&&c.unshift([...p]);for(let g=0;g<e;g++)d[g]&&(u=J(0,g,u,e,e),o.push([...u]));const x=ot(o,e),m=x.length;return{boardStates:x,inputStates:rt(a,m),outputStates:rt(c,m)}}const it={TRANSITION:{FAST:"background-color 100ms ease-in-out, color 100ms ease-in-out, opacity 100ms ease-in-out, border-radius 100ms ease-in-out",DEFAULT:"background-color 200ms ease, color 200ms ease, opacity 200ms ease, border-radius 200ms ease"},SHADOWS:{DROP:s.DROP_SHADOW}},at=1.25,ct={MOBILE:-28,DESKTOP:-40},lt=i("lights-out");function dt(e,n){const o=t.useCallback((t,o)=>{const r=e(t,o);return{front:r?n.primary:n.secondary,back:r?n.secondary:n.primary}},[e,n]),r=t.useCallback((t,n)=>function(t,e,n){const o=n(t,e),r={},s=o===n(t-1,e),i=o===n(t+1,e),a=o===n(t,e-1),c=o===n(t,e+1);return(s||a)&&(r.borderTopLeftRadius=0),(s||c)&&(r.borderTopRightRadius=0),(i||a)&&(r.borderBottomLeftRadius=0),(i||c)&&(r.borderBottomRightRadius=0),r}(t,n,e),[e]),s=t.useCallback((t,o)=>{const r=function(t,e,n){const o=n(t,e),r=n(t,e+1),s=n(t+1,e),i=n(t+1,e+1);let a=!0;return o&&i||!(o+r+s+i<3)||(a=!1),a}(t,o,e);return r?n.primary:n.secondary},[e,n]);return t.useMemo(()=>({getColor:o,getBorder:r,getFiller:s}),[o,r,s])}function ut(e,n){const{grid:o,rows:r,cols:s}=e;return dt(t.useCallback((t,e)=>{if(t<0||e<0||t>=r||e>=s)return-1;const n=o[t];return void 0===n?0:n>>e&1},[o,r,s]),n)}function ft({getColor:t,getBorder:n}){return(o,r)=>{const{front:s}=t(o,r);return{backgroundColor:s,color:s,children:e.jsx(w,{}),style:n(o,r),sx:{transition:it.TRANSITION.DEFAULT}}}}function pt(e,n,o){return dt(t.useCallback((t,o)=>0!==t||o<0||o>=n?-1:e[o]??0,[e,n]),o)}const xt=({children:t})=>e.jsx(B,{variant:"h5",sx:{color:y.text.primary,fontWeight:j.fontWeight.bold,textAlign:"left",fontSize:j.fontSize.h2},children:t}),mt=({Icon:t,title:n,text:o})=>e.jsxs(O,{sx:{px:2},children:[e.jsxs(B,{variant:"h6",sx:{color:y.text.primary,fontWeight:j.fontWeight.semibold,display:"flex",alignItems:"center",mb:1.5,fontSize:j.fontSize.subheading},children:[e.jsx(t,{sx:{mr:2,color:y.primary.main,fontSize:"1.75rem"}}),n]}),e.jsx(B,{variant:"body1",sx:{color:y.text.secondary,lineHeight:1.6,fontSize:j.fontSize.body,ml:6},children:o})]}),gt=["Chasing Lights","How It Works","Calculator"];function ht({cols:t,size:n,isMobile:o,inputProps:r,outputProps:s,onReset:i,onApply:c,hasPattern:l}){const d=Math.min(n*(o?.9:.8),3),u=!o&&2*(t*d)+10+3<55;return e.jsx(O,{sx:{animation:"fadeIn 0.3s ease",textAlign:"center",flex:1,display:"flex",flexDirection:"column"},children:e.jsxs(O,{sx:{flex:1,display:"flex",flexDirection:u?"row":"column",justifyContent:"center",alignItems:"center",gap:3},children:[e.jsxs(O,{sx:{textAlign:"center"},children:[e.jsxs(B,{variant:"subtitle2",sx:{mb:1,color:y.text.primary,fontWeight:"bold"},children:["Input"," ",e.jsx(O,{component:"span",sx:{color:y.text.secondary,fontWeight:"normal"},children:"(Bottom Row)"})]}),e.jsx(a,{space:0,rows:1,cols:t,size:d,cellProps:r})]}),e.jsxs(O,{sx:{textAlign:"center"},children:[e.jsxs(B,{variant:"subtitle2",sx:{mb:1,color:y.text.primary,fontWeight:"bold"},children:["Solution"," ",e.jsx(O,{component:"span",sx:{color:y.text.secondary,fontWeight:"normal"},children:"(Top Row)"})]}),e.jsx(a,{space:0,rows:1,cols:t,size:d,cellProps:s})]}),e.jsxs(O,{sx:{display:"flex",flexDirection:u||o?"column":"row",gap:1,alignItems:"center"},children:[e.jsx(E,{variant:"outlined",size:"small",startIcon:e.jsx(k,{}),disabled:!l,onClick:c,sx:{borderColor:y.border.subtle,color:y.text.secondary},children:"Copy Pattern"}),e.jsx(E,{variant:"outlined",size:"small",startIcon:e.jsx(C,{}),onClick:i,sx:{borderColor:y.border.subtle,color:y.text.secondary},children:"Clear Pattern"})]})]})})}function yt({boardStates:n,inputStates:o,dims:r,id:s,palette:i,children:a}){const c=t.useMemo(()=>[...n.flatMap((t,e)=>Array.from({length:r},(t,o)=>({name:`${s}-board-icon-${String(e)}-${String(o)}`,frames:et(n,e,o,r,i)}))),...o.flatMap((t,e)=>({name:`${s}-input-icon-0-${String(e)}`,frames:nt(o,e,i)}))],[n,o,r,s,i]);return e.jsxs(e.Fragment,{children:[e.jsx("style",{children:c.map(t=>`\n                @keyframes ${t.name} {\n                    ${Object.entries(t.frames).map(([t,e])=>`\n                        ${t} {\n                            ${Object.entries(e).map(([t,e])=>`${t.replaceAll(/[A-Z]/g,t=>`-${t.toLowerCase()}`)}: ${e};`).join(" ")}\n                        }\n                    `).join("")}\n                }\n            `).join("")}),a]})}function jt({start:n=[],dims:o=3,size:r,palette:s,getFrontProps:i,getBackProps:d}){const[u,f]=t.useState(0);t.useEffect(()=>{const t=setInterval(()=>{f(t=>t+1)},2e3);return()=>{clearInterval(t)}},[]);const p=st(n,o),x=r,{boardStates:m,inputStates:g,outputStates:h}=p,j=u%g.length,b=j===g.length-1,S=ut({grid:m[j]??m[0]??[],rows:o,cols:o},s),v=i(S),w=d(S),k=function(t,n,o,r){return(s,i)=>{const a=et(t,s,i,n,r),c=t.length,l=`${o}-board-icon-${String(s)}-${String(i)}`;return{icon:e.jsx(O,{sx:{width:"100%",height:"100%",position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",zIndex:2,"&::after":{content:'""',fontSize:{xs:"0.8rem",sm:"1.2rem"},fontWeight:"bold",filter:it.SHADOWS.DROP,paddingTop:{xs:"0.08rem",sm:"0.15rem"},animation:`${l} ${String(2*c)}s linear infinite`}}}),keyframes:a,keyframeName:l}}}(m,o,"example",s),C=pt(g[j]??[],o,s),z=pt(h[j]??[],o,s),A=ft(C),$=ft(z),P=function(t,n,o,r){return(n,s)=>{const i=nt(t,s,r),a=t.length,c=`${o}-input-icon-${String(n)}-${String(s)}`;return{icon:e.jsx(O,{sx:{width:"100%",height:"100%",position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",zIndex:2,"&::after":{content:'""',fontSize:{xs:"0.8rem",sm:"1.2rem"},fontWeight:"bold",filter:it.SHADOWS.DROP,paddingTop:{xs:"0.08rem",sm:"0.15rem"},animation:`${c} ${String(2*a)}s linear infinite`}}}),keyframes:i,keyframeName:c}}}(g,0,"example",s),D=c("sm");return e.jsx(yt,{boardStates:m,inputStates:g,dims:o,id:"example",palette:s,children:e.jsx(M,{container:!0,size:12,spacing:2,sx:{height:"100%"},children:e.jsxs(M,{container:!0,size:12,wrap:D?"wrap":"nowrap",sx:{justifyContent:"center",alignItems:"center",flex:1,height:"100%",overflow:"hidden",flexDirection:D?"column":"row"},children:[e.jsx(M,{size:D?12:6,sx:{display:"flex",justifyContent:"center",alignItems:"center",overflow:"hidden"},children:e.jsxs(O,{sx:{position:"relative",display:"inline-flex"},children:[e.jsx(l,{size:x,rows:o,cols:o,frontProps:(t,n)=>{const o=v(t,n),r=k(t,n);return{...o,children:e.jsxs(e.Fragment,{children:[o.children,r.icon]}),sx:{...o.sx,position:"relative"}}},backProps:w}),e.jsx(O,{sx:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",opacity:b?1:0,transform:b?"scale(1)":"scale(0.5)",visibility:b?"visible":"hidden",transition:"all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1)",pointerEvents:"none",zIndex:10},children:(()=>{const t=m[g.length-1],n=t?.every(t=>t===(1<<o)-1);return e.jsx(I,{sx:{fontSize:{xs:"2.5rem",sm:"4rem"},color:n?s.secondary:s.primary}})})()})]})}),e.jsxs(M,{container:!0,size:D?12:6,spacing:D?1:2,sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[e.jsxs(O,{sx:{mb:D?0:2,textAlign:"center"},children:[e.jsx(B,{variant:"subtitle2",sx:{mb:1,color:y.text.secondary},children:"Input"}),e.jsx(a,{rows:1,cols:o,size:x,cellProps:(t,n)=>{const o=A(t,n),r=P(t,n);return{...o,children:e.jsxs(e.Fragment,{children:[o.children,r.icon]}),sx:{...o.sx,position:"relative"}}},space:0})]}),e.jsxs(O,{sx:{textAlign:"center"},children:[e.jsx(a,{rows:1,cols:o,size:x,cellProps:$,space:0}),e.jsx(B,{variant:"subtitle2",sx:{mt:1,color:y.text.secondary},children:"Result"})]})]})]})})})}function bt({size:t,palette:n,getFrontProps:o,getBackProps:r}){const s=c("sm")?2.8:5,i=Math.min(.7*t,s);return e.jsx(O,{sx:{flex:1,display:"flex",flexDirection:"column",animation:"fadeIn 0.3s ease"},children:e.jsx(O,{sx:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center"},children:e.jsx(jt,{dims:3,size:i,start:[1,3,8],palette:n,getFrontProps:o,getBackProps:r})})})}function St(){return e.jsx(O,{sx:{animation:"fadeIn 0.3s ease",flex:1,display:"flex",flexDirection:"column"},children:e.jsxs(O,{sx:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center",gap:4},children:[e.jsx(mt,{Icon:z,title:"Chase to Bottom",text:"Turn off rows from top to bottom by clicking lights in each row to push them down."}),e.jsx(mt,{Icon:A,title:"Use Calulator",text:"Enter the remaining lights pattern from the bottom row into the calculator on the last page."}),e.jsx(mt,{Icon:$,title:"Chase Again",text:"Apply the solution pattern to the top row, then chase them down again to solve the puzzle."})]})})}function vt({step:t,totalSteps:n,onBack:o,onNext:r}){return e.jsxs(O,{sx:{p:2.5,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(E,{onClick:o,disabled:0===t,startIcon:e.jsx(P,{}),sx:{visibility:0===t?"hidden":"visible",color:y.text.primary},children:"Back"}),e.jsx(O,{sx:{display:"flex",gap:1},children:Array.from({length:n},(n,o)=>e.jsx(O,{sx:{width:8,height:8,borderRadius:"50%",backgroundColor:t===o?y.primary.main:y.interactive.disabled,transition:"background-color 0.3s"}},o))}),e.jsx(E,{onClick:r,disabled:t===n-1,endIcon:e.jsx(D,{}),sx:{visibility:t===n-1?"hidden":"visible",color:y.text.primary},children:"Next"})]})}const wt=H;function kt(n){const{rows:o,cols:r,size:s,open:i,palette:a,toggleOpen:l,onApply:u,getFrontProps:f,getBackProps:p}=n,x=c("md"),[m,g]=t.useState(0),[h,j]=t.useState(new Array(r).fill(0));t.useEffect(()=>{j(new Array(r).fill(0))},[r,a]);const b=t.useCallback(t=>{const e=Number.parseInt(t,10);j(t=>{const n=[...t];return void 0!==n[e]&&(n[e]^=1),n})},[j]),S=Z(h,o,r),{getDragProps:v}=d({onAction:b,checkEnabled:()=>2===m,posAttribute:"data-col"}),k=pt(h,r,a),C=pt(S,r,a),I=function(t,n){const{getColor:o,getBorder:r}=t;return(t,s)=>{const{front:i,back:a}=o(t,s),c=n(s.toString());return{...c,backgroundColor:i,style:r(t,s),sx:{...c.sx,"&:hover":{cursor:"pointer",color:a}},color:i,children:e.jsx(w,{})}}}(k,v),z=ft(C),A=()=>{l()};return e.jsx(F,{open:i,onClose:A,slots:{backdrop:N},slotProps:{backdrop:{sx:{backgroundColor:t=>"dark"===t.palette.mode?"hsla(0, 0%, 3%, 0.85)":"hsla(0, 0%, 98%, 0.85)",backdropFilter:"blur(12px) saturate(180%)",transition:"all 0.3s ease-in-out !important"}}},sx:{zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs(O,{sx:{outline:"none",display:"flex",justifyContent:"center",alignItems:"center",width:"100%"},children:[e.jsxs(wt,{onClick:t=>{t.stopPropagation()},sx:{width:"100%",maxWidth:"1000px",height:{xs:"630px",sm:"495px"},minHeight:{xs:"630px",sm:"495px"},display:"flex",flexDirection:"column",p:0,overflow:"hidden",position:"relative",m:2},children:[e.jsxs(O,{sx:{flex:1,overflowY:1===m?"hidden":"auto",p:{xs:2.5,md:3},display:"flex",flexDirection:"column"},children:[e.jsxs(O,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,px:2},children:[e.jsx(xt,{children:gt[m]}),e.jsx(W,{onClick:A,size:"small",sx:{color:y.text.secondary},children:e.jsx(T,{})})]}),e.jsxs(O,{sx:{flex:1,display:"flex",flexDirection:"column",pr:{xs:3,md:0}},children:[0===m&&e.jsx(St,{}),1===m&&e.jsx(bt,{size:s,palette:a,getFrontProps:f,getBackProps:p}),2===m&&e.jsx(ht,{cols:r,size:s,isMobile:x,inputProps:I,outputProps:z,onReset:()=>{j(new Array(r).fill(0))},onApply:()=>{u(S)},hasPattern:S.some(t=>0!==t)})]})]}),e.jsx(vt,{step:m,totalSteps:3,onBack:()=>{m>0&&g(m-1)},onNext:()=>{m<2?g(m+1):l()}})]}),e.jsx("style",{children:"\n                    @keyframes fadeIn {\n                        from { opacity: 0; transform: translateY(10px); }\n                        to { opacity: 1; transform: translateY(0); }\n                    }\n                "})]})})}const Ct=e.jsx(O,{sx:{width:"45%",height:"45%",borderRadius:"50%",backgroundColor:"currentColor"}});function It(t,e,o){const{getColor:r,getBorder:s}=e;return(e,i)=>{const a=s(e,i),{front:c,back:l}=r(e,i),d=n(e,i),u=t(d);return{...u,children:Ct,backgroundColor:c,color:c,style:a,...o?{transition:"none"}:{},"aria-label":`Cell at row ${String(e+1)}, column ${String(i+1)}`,sx:{...u.sx,"&:hover":{cursor:"pointer",color:l}}}}}function zt(t,e){return(n,o)=>({backgroundColor:t.getFiller(n,o),transition:e?"none":it.TRANSITION.FAST})}function At(t){const e=It(t=>({onMouseDown:()=>{},onMouseEnter:()=>{},onTouchStart:()=>{},onKeyDown:()=>{},"data-pos":t,role:"presentation",tabIndex:-1,sx:{touchAction:"none",transition:"none"}}),t);return(t,n)=>({...e(t,n),onMouseDown:void 0,onMouseEnter:void 0,onTouchStart:void 0,sx:{}})}function $t(){const n=c("sm"),{rows:o,cols:r,state:s,dispatch:i,size:a,solved:d,handleNext:j,controlsProps:w}=u({storageKeys:{size:lt.SIZE,state:lt.STATE},pageTitle:b.lightsOut,gridConfig:{defaultSize:null,maxSize:10,headerOffset:{mobile:v.headerHeight.xs,desktop:v.headerHeight.md},paddingOffset:{x:n?60:80,y:60},cellSizeReference:{mobile:h.gridSizes.mobile,desktop:h.gridSizes.desktop}},boardConfig:{paddingOffset:{x:n?40:120,y:n?120:160},maxCellSize:80},reducer:tt,getInitialState:X,winAnimationDelay:h.timing.winAnimationDelay,isSolved:t=>t.initialized&&t.grid.every(t=>0===t)}),[k,C]=t.useReducer(t=>!t,!1),I=t.useMemo(()=>({primary:y.primary.main,secondary:y.primary.dark}),[]),{getDragProps:z}=f({onToggle:(t,e)=>{i({type:"adjacent",row:x(t),col:x(e)})},checkEnabled:()=>!d,touchTimeout:h.timing.interactionDelay,transition:it.TRANSITION.FAST}),A=t.useMemo(()=>s.initialized&&s.grid.every(t=>t===(1<<r)-1),[s.initialized,s.grid,r]),$=ut(s,I),P=t.useRef(""),D=t.useRef(!1),[,T]=t.useState(0),B=`${String(o)},${String(r)},${String(s.score)}`;B!==P.current&&(D.current=""!==P.current,P.current=B),t.useEffect(()=>{if(!D.current)return;const t=requestAnimationFrame(()=>{D.current=!1,T(t=>t+1)});return()=>{cancelAnimationFrame(t)}},[B]);const O=D.current,E=p(It,z,[$,O]),M=t.useMemo(()=>zt($,O),[$,O]),F=t.useCallback(t=>{const e=t.map((t,e)=>t?{row:x(0),col:x(e)}:null).filter(t=>null!==t);e.length>0&&i({type:"multi_adjacent",moves:e}),C()},[i,C]),N=e.jsx(g,{...w,children:e.jsx(S,{title:"How to Play",Icon:R,onClick:C})});return e.jsxs(m,{title:b.lightsOut,infoUrl:"https://en.wikipedia.org/wiki/Lights_Out_(game)",showTrophy:d,onReset:j,boardSize:a,iconSizeRatio:at,primaryColor:I.primary,secondaryColor:I.secondary,useSecondaryTrophy:A,boardSx:{marginTop:n?`${String(ct.MOBILE)}px`:`${String(ct.DESKTOP)}px`},controls:N,children:[e.jsx(l,{size:a,rows:o,cols:r,frontProps:E,backProps:M}),k&&e.jsx(kt,{rows:o,cols:r,size:a,open:k,palette:I,toggleOpen:C,onApply:F,getFrontProps:At,getBackProps:zt})]})}export{$t as default};
