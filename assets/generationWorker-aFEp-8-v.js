const ot={HINT_DENSITY:0},k=0,C=1,O=2;class Q{constructor(r){this.parent=Array.from({length:r},(u,i)=>i)}find(r){const u=this.parent[r];if(u===void 0)throw new Error(`DSU: Index ${String(r)} out of bounds`);u!==r&&(this.parent[r]=this.find(u));const i=this.parent[r];if(i===void 0)throw new Error(`DSU: Parent of ${String(r)} became undefined`);return i}union(r,u){const i=this.find(r),y=this.find(u);return i!==y?(this.parent[i]=y,!0):!1}connected(r,u){return this.find(r)===this.find(u)}}var G={exports:{}},s={};var F;function ut(){if(F)return s;F=1;var l=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),u=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),y=Symbol.for("react.profiler"),E=Symbol.for("react.consumer"),m=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),n=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),_=Symbol.for("react.activity"),A=Symbol.iterator;function v(t){return t===null||typeof t!="object"?null:(t=A&&t[A]||t["@@iterator"],typeof t=="function"?t:null)}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,w={};function I(t,e,a){this.props=t,this.context=e,this.refs=w,this.updater=a||g}I.prototype.isReactComponent={},I.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")},I.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function N(){}N.prototype=I.prototype;function $(t,e,a){this.props=t,this.context=e,this.refs=w,this.updater=a||g}var j=$.prototype=new N;j.constructor=$,S(j,I.prototype),j.isPureReactComponent=!0;var b=Array.isArray;function U(){}var R={H:null,A:null,T:null,S:null},z=Object.prototype.hasOwnProperty;function x(t,e,a){var c=a.ref;return{$$typeof:l,type:t,key:e,ref:c!==void 0?c:null,props:a}}function Z(t,e){return x(t.type,e,t.props)}function L(t){return typeof t=="object"&&t!==null&&t.$$typeof===l}function V(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(a){return e[a]})}var K=/\/+/g;function q(t,e){return typeof t=="object"&&t!==null&&t.key!=null?V(""+t.key):e.toString(36)}function tt(t){switch(t.status){case"fulfilled":return t.value;case"rejected":throw t.reason;default:switch(typeof t.status=="string"?t.then(U,U):(t.status="pending",t.then(function(e){t.status==="pending"&&(t.status="fulfilled",t.value=e)},function(e){t.status==="pending"&&(t.status="rejected",t.reason=e)})),t.status){case"fulfilled":return t.value;case"rejected":throw t.reason}}throw t}function Y(t,e,a,c,d){var h=typeof t;(h==="undefined"||h==="boolean")&&(t=null);var T=!1;if(t===null)T=!0;else switch(h){case"bigint":case"string":case"number":T=!0;break;case"object":switch(t.$$typeof){case l:case r:T=!0;break;case f:return T=t._init,Y(T(t._payload),e,a,c,d)}}if(T)return d=d(t),T=c===""?"."+q(t,0):c,b(d)?(a="",T!=null&&(a=T.replace(K,"$&/")+"/"),Y(d,e,a,"",function(rt){return rt})):d!=null&&(L(d)&&(d=Z(d,a+(d.key==null||t&&t.key===d.key?"":(""+d.key).replace(K,"$&/")+"/")+T)),e.push(d)),1;T=0;var M=c===""?".":c+":";if(b(t))for(var H=0;H<t.length;H++)c=t[H],h=M+q(c,H),T+=Y(c,e,a,h,d);else if(H=v(t),typeof H=="function")for(t=H.call(t),H=0;!(c=t.next()).done;)c=c.value,h=M+q(c,H++),T+=Y(c,e,a,h,d);else if(h==="object"){if(typeof t.then=="function")return Y(tt(t),e,a,c,d);throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.")}return T}function B(t,e,a){if(t==null)return t;var c=[],d=0;return Y(t,c,"","",function(h){return e.call(a,h,d++)}),c}function et(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(a){(t._status===0||t._status===-1)&&(t._status=1,t._result=a)},function(a){(t._status===0||t._status===-1)&&(t._status=2,t._result=a)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var W=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var e=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(e))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)},nt={map:B,forEach:function(t,e,a){B(t,function(){e.apply(this,arguments)},a)},count:function(t){var e=0;return B(t,function(){e++}),e},toArray:function(t){return B(t,function(e){return e})||[]},only:function(t){if(!L(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};return s.Activity=_,s.Children=nt,s.Component=I,s.Fragment=u,s.Profiler=y,s.PureComponent=$,s.StrictMode=i,s.Suspense=n,s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=R,s.__COMPILER_RUNTIME={__proto__:null,c:function(t){return R.H.useMemoCache(t)}},s.cache=function(t){return function(){return t.apply(null,arguments)}},s.cacheSignal=function(){return null},s.cloneElement=function(t,e,a){if(t==null)throw Error("The argument must be a React element, but you passed "+t+".");var c=S({},t.props),d=t.key;if(e!=null)for(h in e.key!==void 0&&(d=""+e.key),e)!z.call(e,h)||h==="key"||h==="__self"||h==="__source"||h==="ref"&&e.ref===void 0||(c[h]=e[h]);var h=arguments.length-2;if(h===1)c.children=a;else if(1<h){for(var T=Array(h),M=0;M<h;M++)T[M]=arguments[M+2];c.children=T}return x(t.type,d,c)},s.createContext=function(t){return t={$$typeof:m,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null},t.Provider=t,t.Consumer={$$typeof:E,_context:t},t},s.createElement=function(t,e,a){var c,d={},h=null;if(e!=null)for(c in e.key!==void 0&&(h=""+e.key),e)z.call(e,c)&&c!=="key"&&c!=="__self"&&c!=="__source"&&(d[c]=e[c]);var T=arguments.length-2;if(T===1)d.children=a;else if(1<T){for(var M=Array(T),H=0;H<T;H++)M[H]=arguments[H+2];d.children=M}if(t&&t.defaultProps)for(c in T=t.defaultProps,T)d[c]===void 0&&(d[c]=T[c]);return x(t,h,d)},s.createRef=function(){return{current:null}},s.forwardRef=function(t){return{$$typeof:o,render:t}},s.isValidElement=L,s.lazy=function(t){return{$$typeof:f,_payload:{_status:-1,_result:t},_init:et}},s.memo=function(t,e){return{$$typeof:p,type:t,compare:e===void 0?null:e}},s.startTransition=function(t){var e=R.T,a={};R.T=a;try{var c=t(),d=R.S;d!==null&&d(a,c),typeof c=="object"&&c!==null&&typeof c.then=="function"&&c.then(U,W)}catch(h){W(h)}finally{e!==null&&a.types!==null&&(e.types=a.types),R.T=e}},s.unstable_useCacheRefresh=function(){return R.H.useCacheRefresh()},s.use=function(t){return R.H.use(t)},s.useActionState=function(t,e,a){return R.H.useActionState(t,e,a)},s.useCallback=function(t,e){return R.H.useCallback(t,e)},s.useContext=function(t){return R.H.useContext(t)},s.useDebugValue=function(){},s.useDeferredValue=function(t,e){return R.H.useDeferredValue(t,e)},s.useEffect=function(t,e){return R.H.useEffect(t,e)},s.useEffectEvent=function(t){return R.H.useEffectEvent(t)},s.useId=function(){return R.H.useId()},s.useImperativeHandle=function(t,e,a){return R.H.useImperativeHandle(t,e,a)},s.useInsertionEffect=function(t,e){return R.H.useInsertionEffect(t,e)},s.useLayoutEffect=function(t,e){return R.H.useLayoutEffect(t,e)},s.useMemo=function(t,e){return R.H.useMemo(t,e)},s.useOptimistic=function(t,e){return R.H.useOptimistic(t,e)},s.useReducer=function(t,e,a){return R.H.useReducer(t,e,a)},s.useRef=function(t){return R.H.useRef(t)},s.useState=function(t){return R.H.useState(t)},s.useSyncExternalStore=function(t,e,a){return R.H.useSyncExternalStore(t,e,a)},s.useTransition=function(){return R.H.useTransition()},s.version="19.2.4",s}var J;function it(){return J||(J=1,G.exports=ut()),G.exports}it();function P(l,r,u){return l*(u+1)+r}function X(l,r,u){const i=Array.from({length:r+1},()=>new Array(u+1).fill(0));for(let y=0;y<r;y++){const E=l[y];if(E)for(let m=0;m<u;m++){const o=E[m];if(o===C){const n=i[y];if(n){const f=n[m+1];f!==void 0&&(n[m+1]=f+1)}const p=i[y+1];if(p){const f=p[m];f!==void 0&&(p[m]=f+1)}}else if(o===O){const n=i[y];if(n){const f=n[m];f!==void 0&&(n[m]=f+1)}const p=i[y+1];if(p){const f=p[m+1];f!==void 0&&(p[m+1]=f+1)}}}}return i}function ft(l,r,u,i){const y=X(l,u,i);for(let E=0;E<=u;E++)for(let m=0;m<=i;m++){const o=r[E]?.[m];if(o!=null&&y[E]?.[m]!==o)return!1}return!0}function D(l,r,u,i,y,E){const m=l[u];if(!m)return!1;m[i]=y;const o=y===C?P(u,i+1,E):P(u,i,E),n=y===C?P(u+1,i,E):P(u+1,i+1,E);return r.connected(o,n)?!1:(r.union(o,n),!0)}function st(l,r,u,i,y){let E=!0;for(;E;){E=!1;for(let o=0;o<=u;o++)for(let n=0;n<=i;n++){const p=r[o]?.[n];if(p==null)continue;const f=[{gr:o-1,gc:n-1,pt:O},{gr:o-1,gc:n,pt:C},{gr:o,gc:n-1,pt:C},{gr:o,gc:n,pt:O}].filter(({gr:v,gc:g})=>v>=0&&v<u&&g>=0&&g<i);let _=0;const A=[];for(const v of f){const g=l[v.gr]?.[v.gc];g===k?A.push(v):g===v.pt&&_++}if(_>p||_+A.length<p)return"contradiction";if(_===p&&A.length>0){for(const{gr:v,gc:g,pt:S}of A)if(l[v]?.[g]===k){if(!D(l,y,v,g,S===C?O:C,i))return"contradiction";E=!0}}else if(_+A.length===p&&A.length>0){for(const{gr:v,gc:g,pt:S}of A)if(l[v]?.[g]===k){if(!D(l,y,v,g,S,i))return"contradiction";E=!0}}}if(!E){for(let o=0;o<u;o++)for(let n=0;n<i;n++){const p=l[o];if(p?.[n]!==k)continue;const f=P(o,n+1,i),_=P(o+1,n,i),A=y.connected(f,_),v=P(o,n,i),g=P(o+1,n+1,i),S=y.connected(v,g);if(A&&S)return"contradiction";A?(p[n]=O,E=!0,y.union(v,g)):S&&(p[n]=C,E=!0,y.union(f,_))}if(!E)for(let o=0;o<u;o++)for(let n=0;n<i;n++){if(l[o]?.[n]!==k)continue;let f=!1,_=!1;const A=[{nr:o,nc:n,touchedBy:O},{nr:o,nc:n+1,touchedBy:C},{nr:o+1,nc:n,touchedBy:C},{nr:o+1,nc:n+1,touchedBy:O}];for(const{nr:v,nc:g,touchedBy:S}of A){const w=r[v]?.[g];if(w==null)continue;const I=[{gr:v-1,gc:g-1,pt:O},{gr:v-1,gc:g,pt:C},{gr:v,gc:g-1,pt:C},{gr:v,gc:g,pt:O}].filter(({gr:j,gc:b})=>j>=0&&j<u&&b>=0&&b<i);let N=0,$=0;for(const j of I){const b=l[j.gr]?.[j.gc];b===k?$++:b===j.pt&&N++}S===C?(N+1>w&&(f=!0),N+($-1)<w&&(_=!0)):(N+1>w&&(_=!0),N+($-1)<w&&(f=!0))}if(f&&_)return"contradiction";if(f){if(!D(l,y,o,n,O,i))return"contradiction";E=!0}else if(_){if(!D(l,y,o,n,C,i))return"contradiction";E=!0}}}}return l.every(o=>o.every(n=>n!==k))?"solved":"stuck"}function ct(l,r,u){const i=Array.from({length:r},()=>new Array(u).fill(k)),y=new Q((r+1)*(u+1)),E=st(i,l,r,u,y);return E==="contradiction"||E!=="solved"?!1:ft(i,l,r,u)}function at(l,r,u,i){const y=l.map(n=>[...n]),E=[];for(let n=0;n<=r;n++)for(let p=0;p<=u;p++)E.push({r:n,c:p});for(let n=E.length-1;n>0;n--){const p=Math.floor(Math.random()*(n+1)),f=E[n],_=E[p];f&&_&&(E[n]=_,E[p]=f)}const m=Math.floor((r+1)*(u+1)*i);let o=0;for(let n=0;n<=r;n++)for(let p=0;p<=u;p++)y[n]?.[p]!==null&&o++;for(const{r:n,c:p}of E){if(o<=m)break;const f=y[n];if(!f)continue;const _=f[p];_!=null&&(f[p]=null,ct(y,r,u)?o--:f[p]=_)}return y}function lt(l,r){let u=[],i=!1;for(let m=0;m<50&&!i;m++){u=Array.from({length:l},()=>new Array(r).fill(k));const o=new Q((l+1)*(r+1)),n=[];for(let f=0;f<l;f++)for(let _=0;_<r;_++)n.push({r:f,c:_});for(let f=n.length-1;f>0;f--){const _=Math.floor(Math.random()*(f+1)),A=n[f],v=n[_];A&&v&&(n[f]=v,n[_]=A)}let p=!1;for(const{r:f,c:_}of n){const A=P(f,_+1,r),v=P(f+1,_,r),g=o.connected(A,v),S=P(f,_,r),w=P(f+1,_+1,r),I=o.connected(S,w);if(g&&I){p=!0;break}const N=u[f];N&&(g?(N[_]=O,o.union(S,w)):I||Math.random()<.5?(N[_]=C,o.union(A,v)):(N[_]=O,o.union(S,w)))}p||(i=!0)}i||(u=Array.from({length:l},(m,o)=>new Array(r).fill(o%2===0?C:O)));const y=X(u,l,r);return{numbers:at(y.map(m=>m.map(o=>o)),l,r,ot.HINT_DENSITY),solution:u}}globalThis.onmessage=l=>{if(l.data.type==="GENERATE")try{const{rows:r,cols:u}=l.data.payload,{numbers:i,solution:y}=lt(r,u);self.postMessage({type:"RESULT",payload:{rows:r,cols:u,numbers:i,solution:y}})}catch(r){const u=r instanceof Error?r.message:"Unknown worker error";self.postMessage({type:"ERROR",payload:{message:u}})}};
