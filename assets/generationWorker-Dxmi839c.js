class t{constructor(t){this.parent=Array.from({length:t},(t,e)=>e)}find(t){const e=this.parent[t];if(void 0===e)throw new Error(`DSU: Index ${String(t)} out of bounds`);e!==t&&(this.parent[t]=this.find(e));const n=this.parent[t];if(void 0===n)throw new Error(`DSU: Parent of ${String(t)} became undefined`);return n}union(t,e){const n=this.find(t),r=this.find(e);return n!==r&&(this.parent[n]=r,!0)}connected(t,e){return this.find(t)===this.find(e)}}var e,n,r={exports:{}},o={};function u(){if(e)return o;e=1;var t=Symbol.for("react.transitional.element"),n=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),u=Symbol.for("react.strict_mode"),c=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),s=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),a=Symbol.for("react.suspense"),l=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),y=Symbol.for("react.activity"),d=Symbol.iterator;var h={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,m={};function v(t,e,n){this.props=t,this.context=e,this.refs=m,this.updater=n||h}function b(){}function _(t,e,n){this.props=t,this.context=e,this.refs=m,this.updater=n||h}v.prototype.isReactComponent={},v.prototype.setState=function(t,e){if("object"!=typeof t&&"function"!=typeof t&&null!=t)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")},v.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},b.prototype=v.prototype;var S=_.prototype=new b;S.constructor=_,g(S,v.prototype),S.isPureReactComponent=!0;var E=Array.isArray;function w(){}var R={H:null,A:null,T:null,S:null},k=Object.prototype.hasOwnProperty;function H(e,n,r){var o=r.ref;return{$$typeof:t,type:e,key:n,ref:void 0!==o?o:null,props:r}}function j(e){return"object"==typeof e&&null!==e&&e.$$typeof===t}var A=/\/+/g;function $(t,e){return"object"==typeof t&&null!==t&&null!=t.key?(n=""+t.key,r={"=":"=0",":":"=2"},"$"+n.replace(/[=:]/g,function(t){return r[t]})):e.toString(36);var n,r}function C(e,r,o,u,c){var i=typeof e;"undefined"!==i&&"boolean"!==i||(e=null);var s,f,a=!1;if(null===e)a=!0;else switch(i){case"bigint":case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case t:case n:a=!0;break;case p:return C((a=e._init)(e._payload),r,o,u,c)}}if(a)return c=c(e),a=""===u?"."+$(e,0):u,E(c)?(o="",null!=a&&(o=a.replace(A,"$&/")+"/"),C(c,r,o,"",function(t){return t})):null!=c&&(j(c)&&(s=c,f=o+(null==c.key||e&&e.key===c.key?"":(""+c.key).replace(A,"$&/")+"/")+a,c=H(s.type,f,s.props)),r.push(c)),1;a=0;var l,y=""===u?".":u+":";if(E(e))for(var h=0;h<e.length;h++)a+=C(u=e[h],r,o,i=y+$(u,h),c);else if("function"==typeof(h=null===(l=e)||"object"!=typeof l?null:"function"==typeof(l=d&&l[d]||l["@@iterator"])?l:null))for(e=h.call(e),h=0;!(u=e.next()).done;)a+=C(u=u.value,r,o,i=y+$(u,h++),c);else if("object"===i){if("function"==typeof e.then)return C(function(t){switch(t.status){case"fulfilled":return t.value;case"rejected":throw t.reason;default:switch("string"==typeof t.status?t.then(w,w):(t.status="pending",t.then(function(e){"pending"===t.status&&(t.status="fulfilled",t.value=e)},function(e){"pending"===t.status&&(t.status="rejected",t.reason=e)})),t.status){case"fulfilled":return t.value;case"rejected":throw t.reason}}throw t}(e),r,o,u,c);throw r=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===r?"object with keys {"+Object.keys(e).join(", ")+"}":r)+"). If you meant to render a collection of children, use an array instead.")}return a}function T(t,e,n){if(null==t)return t;var r=[],o=0;return C(t,r,"","",function(t){return e.call(n,t,o++)}),r}function x(t){if(-1===t._status){var e=t._result;(e=e()).then(function(e){0!==t._status&&-1!==t._status||(t._status=1,t._result=e)},function(e){0!==t._status&&-1!==t._status||(t._status=2,t._result=e)}),-1===t._status&&(t._status=0,t._result=e)}if(1===t._status)return t._result.default;throw t._result}var M="function"==typeof reportError?reportError:function(t){if("object"==typeof window&&"function"==typeof window.ErrorEvent){var e=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"==typeof t&&null!==t&&"string"==typeof t.message?String(t.message):String(t),error:t});if(!window.dispatchEvent(e))return}else if("object"==typeof process&&"function"==typeof process.emit)return void process.emit("uncaughtException",t)},O={map:T,forEach:function(t,e,n){T(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return T(t,function(){e++}),e},toArray:function(t){return T(t,function(t){return t})||[]},only:function(t){if(!j(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};return o.Activity=y,o.Children=O,o.Component=v,o.Fragment=r,o.Profiler=c,o.PureComponent=_,o.StrictMode=u,o.Suspense=a,o.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=R,o.__COMPILER_RUNTIME={__proto__:null,c:function(t){return R.H.useMemoCache(t)}},o.cache=function(t){return function(){return t.apply(null,arguments)}},o.cacheSignal=function(){return null},o.cloneElement=function(t,e,n){if(null==t)throw Error("The argument must be a React element, but you passed "+t+".");var r=g({},t.props),o=t.key;if(null!=e)for(u in void 0!==e.key&&(o=""+e.key),e)!k.call(e,u)||"key"===u||"__self"===u||"__source"===u||"ref"===u&&void 0===e.ref||(r[u]=e[u]);var u=arguments.length-2;if(1===u)r.children=n;else if(1<u){for(var c=Array(u),i=0;i<u;i++)c[i]=arguments[i+2];r.children=c}return H(t.type,o,r)},o.createContext=function(t){return(t={$$typeof:s,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null}).Provider=t,t.Consumer={$$typeof:i,_context:t},t},o.createElement=function(t,e,n){var r,o={},u=null;if(null!=e)for(r in void 0!==e.key&&(u=""+e.key),e)k.call(e,r)&&"key"!==r&&"__self"!==r&&"__source"!==r&&(o[r]=e[r]);var c=arguments.length-2;if(1===c)o.children=n;else if(1<c){for(var i=Array(c),s=0;s<c;s++)i[s]=arguments[s+2];o.children=i}if(t&&t.defaultProps)for(r in c=t.defaultProps)void 0===o[r]&&(o[r]=c[r]);return H(t,u,o)},o.createRef=function(){return{current:null}},o.forwardRef=function(t){return{$$typeof:f,render:t}},o.isValidElement=j,o.lazy=function(t){return{$$typeof:p,_payload:{_status:-1,_result:t},_init:x}},o.memo=function(t,e){return{$$typeof:l,type:t,compare:void 0===e?null:e}},o.startTransition=function(t){var e=R.T,n={};R.T=n;try{var r=t(),o=R.S;null!==o&&o(n,r),"object"==typeof r&&null!==r&&"function"==typeof r.then&&r.then(w,M)}catch(u){M(u)}finally{null!==e&&null!==n.types&&(e.types=n.types),R.T=e}},o.unstable_useCacheRefresh=function(){return R.H.useCacheRefresh()},o.use=function(t){return R.H.use(t)},o.useActionState=function(t,e,n){return R.H.useActionState(t,e,n)},o.useCallback=function(t,e){return R.H.useCallback(t,e)},o.useContext=function(t){return R.H.useContext(t)},o.useDebugValue=function(){},o.useDeferredValue=function(t,e){return R.H.useDeferredValue(t,e)},o.useEffect=function(t,e){return R.H.useEffect(t,e)},o.useEffectEvent=function(t){return R.H.useEffectEvent(t)},o.useId=function(){return R.H.useId()},o.useImperativeHandle=function(t,e,n){return R.H.useImperativeHandle(t,e,n)},o.useInsertionEffect=function(t,e){return R.H.useInsertionEffect(t,e)},o.useLayoutEffect=function(t,e){return R.H.useLayoutEffect(t,e)},o.useMemo=function(t,e){return R.H.useMemo(t,e)},o.useOptimistic=function(t,e){return R.H.useOptimistic(t,e)},o.useReducer=function(t,e,n){return R.H.useReducer(t,e,n)},o.useRef=function(t){return R.H.useRef(t)},o.useState=function(t){return R.H.useState(t)},o.useSyncExternalStore=function(t,e,n){return R.H.useSyncExternalStore(t,e,n)},o.useTransition=function(){return R.H.useTransition()},o.version="19.2.4",o}n||(n=1,r.exports=u()),r.exports;const c=1,i=2;function s(t,e,n){return t*(n+1)+e}const f=0;function a(t,e,n){const r=Array.from({length:e+1},()=>new Array(n+1).fill(0));for(let o=0;o<e;o++){const e=t[o];if(e)for(let t=0;t<n;t++){const n=e[t];if(n===c){const e=r[o];if(e){const n=e[t+1];void 0!==n&&(e[t+1]=n+1)}const n=r[o+1];if(n){const e=n[t];void 0!==e&&(n[t]=e+1)}}else if(n===i){const e=r[o];if(e){const n=e[t];void 0!==n&&(e[t]=n+1)}const n=r[o+1];if(n){const e=n[t+1];void 0!==e&&(n[t+1]=e+1)}}}}return r}function l(t,e,n,r,o,u){const i=t[n];if(!i)return!1;i[r]=o;const f=s(n,o===c?r+1:r,u),a=s(n+1,o===c?r:r+1,u);return!e.connected(f,a)&&(e.union(f,a),!0)}function p(e,n,r){const o=Array.from({length:n},()=>new Array(r).fill(0)),u=new t((n+1)*(r+1)),f=function(t,e,n,r,o){let u=!0;for(;u;){u=!1;for(let s=0;s<=n;s++)for(let f=0;f<=r;f++){const a=e[s]?.[f];if(null==a)continue;const p=[{gr:s-1,gc:f-1,pt:i},{gr:s-1,gc:f,pt:c},{gr:s,gc:f-1,pt:c},{gr:s,gc:f,pt:i}].filter(({gr:t,gc:e})=>t>=0&&t<n&&e>=0&&e<r);let y=0;const d=[];for(const e of p){const n=t[e.gr]?.[e.gc];0===n?d.push(e):n===e.pt&&y++}if(y>a)return"contradiction";if(y+d.length<a)return"contradiction";if(y===a&&d.length>0){for(const{gr:e,gc:n,pt:s}of d)if(0===t[e]?.[n]){if(!l(t,o,e,n,s===c?i:c,r))return"contradiction";u=!0}}else if(y+d.length===a&&d.length>0)for(const{gr:e,gc:n,pt:c}of d)if(0===t[e]?.[n]){if(!l(t,o,e,n,c,r))return"contradiction";u=!0}}if(!u){for(let e=0;e<n;e++)for(let n=0;n<r;n++){const f=t[e];if(0!==f?.[n])continue;const a=s(e,n+1,r),l=s(e+1,n,r),p=o.connected(a,l),y=s(e,n,r),d=s(e+1,n+1,r),h=o.connected(y,d);if(p&&h)return"contradiction";p?(f[n]=i,u=!0,o.union(y,d)):h&&(f[n]=c,u=!0,o.union(a,l))}if(!u)for(let s=0;s<n;s++)for(let f=0;f<r;f++){const a=t[s];if(0!==a?.[f])continue;let p=!1,y=!1;const d=[{nr:s,nc:f,touchedBy:i},{nr:s,nc:f+1,touchedBy:c},{nr:s+1,nc:f,touchedBy:c},{nr:s+1,nc:f+1,touchedBy:i}];for(const{nr:o,nc:u,touchedBy:s}of d){const f=e[o]?.[u];if(null==f)continue;const a=[{gr:o-1,gc:u-1,pt:i},{gr:o-1,gc:u,pt:c},{gr:o,gc:u-1,pt:c},{gr:o,gc:u,pt:i}].filter(({gr:t,gc:e})=>t>=0&&t<n&&e>=0&&e<r);let l=0,d=0;for(const e of a){const n=t[e.gr]?.[e.gc];0===n?d++:n===e.pt&&l++}s===c?(l+1>f&&(p=!0),l+(d-1)<f&&(y=!0)):(l+1>f&&(y=!0),l+(d-1)<f&&(p=!0))}if(p&&y)return"contradiction";if(p){if(!l(t,o,s,f,i,r))return"contradiction";u=!0}else if(y){if(!l(t,o,s,f,c,r))return"contradiction";u=!0}}}}return t.every(t=>t.every(t=>0!==t))?"solved":"stuck"}(o,e,n,r,u);return"contradiction"!==f&&("solved"===f&&function(t,e,n,r){const o=a(t,n,r);for(let u=0;u<=n;u++)for(let t=0;t<=r;t++){const n=e[u]?.[t];if(null!=n&&o[u]?.[t]!==n)return!1}return!0}(o,e,n,r))}function y(e,n){let r=[],o=!1;for(let f=0;f<50&&!o;f++){r=Array.from({length:e},()=>new Array(n).fill(0));const u=new t((e+1)*(n+1)),f=[];for(let t=0;t<e;t++)for(let e=0;e<n;e++)f.push({r:t,c:e});for(let t=f.length-1;t>0;t--){const e=Math.floor(Math.random()*(t+1)),n=f[t],r=f[e];n&&r&&(f[t]=r,f[e]=n)}let a=!1;for(const{r:t,c:e}of f){const o=s(t,e+1,n),f=s(t+1,e,n),l=u.connected(o,f),p=s(t,e,n),y=s(t+1,e+1,n),d=u.connected(p,y);if(l&&d){a=!0;break}const h=r[t];h&&(l?(h[e]=i,u.union(p,y)):d||Math.random()<.5?(h[e]=c,u.union(o,f)):(h[e]=i,u.union(p,y)))}a||(o=!0)}o||(r=Array.from({length:e},(t,e)=>new Array(n).fill(e%2==0?c:i)));const u=function(t,e,n,r){const o=t.map(t=>[...t]),u=[];for(let s=0;s<=e;s++)for(let t=0;t<=n;t++)u.push({r:s,c:t});for(let s=u.length-1;s>0;s--){const t=Math.floor(Math.random()*(s+1)),e=u[s],n=u[t];e&&n&&(u[s]=n,u[t]=e)}const c=Math.floor((e+1)*(n+1)*r);let i=0;for(let s=0;s<=e;s++)for(let t=0;t<=n;t++)null!==o[s]?.[t]&&i++;for(const{r:s,c:f}of u){if(i<=c)break;const t=o[s];if(!t)continue;const r=t[f];null!=r&&(t[f]=null,p(o,e,n)?i--:t[f]=r)}return o}(a(r,e,n).map(t=>t.map(t=>t)),e,n,f);return{numbers:u,solution:r}}globalThis.onmessage=t=>{if("GENERATE"===t.data.type)try{const{rows:e,cols:n}=t.data.payload,{numbers:r,solution:o}=y(e,n);self.postMessage({type:"RESULT",payload:{rows:e,cols:n,numbers:r,solution:o}})}catch(e){const t=e instanceof Error?e.message:"Unknown worker error";self.postMessage({type:"ERROR",payload:{message:t}})}};
