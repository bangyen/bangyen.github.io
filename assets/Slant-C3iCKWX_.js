import{r as e,j as t}from"./vendor_react-WaSaIrII.js";import{S as r,L as o,a as n,A as s,d as i,e as c,g as l}from"./index-2Mg8ft3S.js";import{u as a,C as u,c as d}from"./CustomGrid-D2B2dSLn.js";import{B as f,G as g}from"./vendor_mui_core-D4-4kcvK.js";import{G as p}from"./GlobalHeader-CSMIpn6M.js";import{u as h}from"./useWindow-BCvkQ8_7.js";import{l as m,r as w,s as v,h as x}from"./vendor_mui_icons-kUp0AcNR.js";const S="32px",b="48px",y=2e3,E=500,$=300,j=500,I="130%",C="6px",N="24px",R={MOBILE:64,DESKTOP:80},M=100,L=1e3,k=1200,A=.95,z=160,D=100,O=16,T="slant-size",B="slant-state",_="slant-ghost-moves",H=.35,G=3,P=10,W=5,Y=30,q={WHITE:"#fff"},J={LINE:"0 2px 4px rgba(0,0,0,0.2)",HINT:"0 4px 8px rgba(0,0,0,0.1)"},U={BORDER:"rgba(255, 255, 255, 0.1)",BG_SUBTLE:"rgba(255, 255, 255, 0.02)",BG_HOVER:"rgba(255, 255, 255, 0.1)",DASHED_BORDER:"rgba(255, 255, 255, 0.2)",HINT_BG:"hsl(217, 50%, 8%)",HINT_BORDER:"rgba(255, 255, 255, 0.3)",OVERLAY_LABEL:"rgba(255, 255, 255, 0.5)",OVERLAY_BG:"rgba(0, 0, 0, 0.3)"},V=1,F=2;class K{constructor(e){this.parent=Array.from({length:e},(e,t)=>t)}find(e){const t=this.parent[e];if(void 0===t)throw new Error("Index out of bounds");t!==e&&(this.parent[e]=this.find(t));const r=this.parent[e];if(void 0===r)throw new Error("Root not found");return r}union(e,t){const r=this.find(e),o=this.find(t);return r!==o&&(this.parent[r]=o,!0)}}function X(e,t,r){return e*(r+1)+t}function Q(e,t,r){const o=new K((t+1)*(r+1));for(let n=0;n<t;n++){const t=e[n];if(t)for(let e=0;e<r;e++){const s=t[e];if(void 0===s||0===s)continue;const i=X(n,s===V?e+1:e,r),c=X(n+1,s===V?e:e+1,r);if(!o.union(i,c))return!0}}return!1}function Z(e,t,r){const o=Array.from({length:t+1},()=>Array(r+1).fill(0));for(let n=0;n<t;n++){const t=e[n];if(t)for(let e=0;e<r;e++){const r=t[e];if(r===V){const t=o[n];if(t){const r=t[e+1];void 0!==r&&(t[e+1]=r+1)}const r=o[n+1];if(r){const t=r[e];void 0!==t&&(r[e]=t+1)}}else if(r===F){const t=o[n];if(t){const r=t[e];void 0!==r&&(t[e]=r+1)}const r=o[n+1];if(r){const t=r[e+1];void 0!==t&&(r[e+1]=t+1)}}}}return o}function ee(e,t,r){const o=Array.from({length:t},()=>Array(r).fill(0));let n=!0;for(;n;){n=!1;for(let s=0;s<=t;s++)for(let i=0;i<=r;i++){const c=e[s]?.[i];if(null==c)continue;const l=[{gr:s-1,gc:i-1,pt:F},{gr:s-1,gc:i,pt:V},{gr:s,gc:i-1,pt:V},{gr:s,gc:i,pt:F}].filter(({gr:e,gc:o})=>e>=0&&e<t&&o>=0&&o<r);let a=0;const u=[];for(const e of l){const t=o[e.gr]?.[e.gc];0===t?u.push(e):t===e.pt&&a++}if(a===c&&u.length>0)for(const{gr:e,gc:t,pt:r}of u){const s=o[e];s&&(s[t]=r===V?F:V,n=!0)}else if(a+u.length===c&&u.length>0)for(const{gr:e,gc:t,pt:r}of u){const s=o[e];s&&(s[t]=r,n=!0)}}if(!n)for(let e=0;e<t;e++)for(let s=0;s<r;s++){const i=o[e];if(0===i?.[s])if(i[s]=V,Q(o,t,r)){if(i[s]=F,n=!0,Q(o,t,r))return!1}else if(i[s]=F,Q(o,t,r)){if(i[s]=V,n=!0,Q(o,t,r))return!1}else i[s]=0}}if(!o.every(e=>e.every(e=>0!==e)))return!1;const s=Z(o,t,r);for(let i=0;i<=t;i++)for(let t=0;t<=r;t++){const r=e[i]?.[t];if(null!=r&&s[i]?.[t]!==r)return!1}return!Q(o,t,r)}function te(e,t){const r=Array.from({length:e},()=>Array(t).fill(V)),o=e*t*Y;for(let l=0;l<o;l++){const o=Math.floor(Math.random()*e),n=Math.floor(Math.random()*t),s=r[o];if(!s)continue;const i=s[n];void 0!==i&&(s[n]=i===V?F:V,Q(r,e,t)&&(s[n]=i))}const n=Z(r,e,t).map(e=>[...e]),s=[];for(let l=0;l<=e;l++)for(let e=0;e<=t;e++)s.push({r:l,c:e});for(let l=s.length-1;l>0;l--){const e=Math.floor(Math.random()*(l+1)),t=s[l],r=s[e];t&&r&&(s[l]=r,s[e]=t)}const i=Math.floor((e+1)*(t+1)*H);let c=(e+1)*(t+1);for(const{r:l,c:a}of s){if(c<=i)continue;const r=n[l];if(!r)continue;const o=r[a];null!=o&&(r[a]=null,ee(n,e,t)?c--:r[a]=o)}return{numbers:n,solution:r}}function re(e,t){switch(t.type){case"toggle":{if(e.solved)return e;const{row:r,col:o}=t,n=e.grid.map(e=>[...e]),s=n[r];if(!s)return e;const i=s[o];if(void 0===i)return e;t.reverse?s[o]=0===i?F:i===F?V:0:s[o]=0===i?V:i===V?F:0;let c=!1;if(n.every(e=>e.every(e=>0!==e))){const t=Z(n,e.rows,e.cols);e.numbers.every((e,r)=>e.every((e,o)=>null===e||e===t[r]?.[o]))&&!Q(n,e.rows,e.cols)&&(c=!0)}const l=function(e,t,r,o){const n=new Set,s=Z(e,r,o);for(let i=0;i<=r;i++)for(let c=0;c<=o;c++){const l=t[i]?.[c];if(null==l)continue;const a=s[i]?.[c]??0;a>l?n.add(`${String(i)},${String(c)}`):a+[{gr:i-1,gc:c-1},{gr:i-1,gc:c},{gr:i,gc:c-1},{gr:i,gc:c}].filter(({gr:t,gc:n})=>t>=0&&t<r&&n>=0&&n<o&&0===e[t]?.[n]).length<l&&n.add(`${String(i)},${String(c)}`)}return n}(n,e.numbers,e.rows,e.cols),a=function(e,t,r){const o=new Map,n=new Set;for(let a=0;a<t;a++)for(let t=0;t<r;t++){const n=e[a]?.[t];if(!n||0===n)continue;const s=X(a,n===V?t+1:t,r),i=X(a+1,n===V?t:t+1,r);o.has(s)||o.set(s,[]),o.has(i)||o.set(i,[]),o.get(s)?.push({node:i,r:a,c:t}),o.get(i)?.push({node:s,r:a,c:t})}const s=new Set,i=new Set,c=[],l=(e,t)=>{s.add(e),i.add(e);const r=o.get(e)??[];for(const{node:o,r:a,c:u}of r)if(o!==t)if(i.has(o)){n.add(`${String(a)},${String(u)}`);for(let e=c.length-1;e>=0;e--){const t=c[e];if(!t)break;if(n.add(`${String(t.r)},${String(t.c)}`),t.u===o||t.v===o)break}}else s.has(o)||(c.push({r:a,c:u,u:e,v:o}),l(o,e),c.pop());i.delete(e)};for(const a of o.keys())s.has(a)||l(a,-1);return n}(n,e.rows,e.cols),u=function(e,t,r,o){const n=new Set,s=Z(e,r,o);for(let i=0;i<=r;i++)for(let e=0;e<=o;e++){const r=t[i]?.[e];null!=r&&((s[i]?.[e]??0)===r&&n.add(`${String(i)},${String(e)}`))}return n}(n,e.numbers,e.rows,e.cols);return{...e,grid:n,solved:c,auto:!c&&e.auto,errorNodes:l,cycleCells:a,satisfiedNodes:u}}case"auto":return{...e,auto:!e.auto};case"nextLogical":{const t=function(e){const{grid:t,numbers:r,rows:o,cols:n}=e;for(let s=0;s<=o;s++)for(let e=0;e<=n;e++){const i=r[s]?.[e];if(null==i)continue;const c=[{gr:s-1,gc:e-1,pt:F},{gr:s-1,gc:e,pt:V},{gr:s,gc:e-1,pt:V},{gr:s,gc:e,pt:F}].filter(({gr:e,gc:t})=>e>=0&&e<o&&t>=0&&t<n);let l=0;const a=[];for(const e of c){const r=t[e.gr]?.[e.gc];0===r?a.push(e):r===e.pt&&l++}if(a.length>0)if(l===i){const e=a[0];if(e)return{row:e.gr,col:e.gc,reverse:e.pt===V}}else if(l+a.length===i){const e=a[0];if(e)return{row:e.gr,col:e.gc,reverse:e.pt===F}}}for(let s=0;s<o;s++)for(let e=0;e<n;e++){if(0!==t[s]?.[e])continue;const r=t.map(e=>[...e]),i=r[s];if(i){if(i[e]=V,Q(r,o,n))return{row:s,col:e,reverse:!0};if(i[e]=F,Q(r,o,n))return{row:s,col:e,reverse:!1}}}for(let s=0;s<o;s++)for(let r=0;r<n;r++){const o=t[s]?.[r],n=e.solution[s]?.[r];if(0!==o&&o!==n&&void 0!==n)return{row:s,col:r,reverse:n===F}}return null}(e);return t?re(e,{type:"toggle",...t}):{...e,auto:!1}}case"hydrate":return{...t.state,auto:!1};case"resize":{if(t.rows<G||t.cols<G)return e;const{numbers:r,solution:o}=te(t.rows,t.cols);return{grid:Array.from({length:t.rows},()=>Array(t.cols).fill(0)),numbers:r,solution:o,rows:t.rows,cols:t.cols,solved:!1,auto:!1,errorNodes:new Set,cycleCells:new Set,satisfiedNodes:new Set}}case"new":{const{numbers:t,solution:r}=te(e.rows,e.cols);return{...e,grid:Array.from({length:e.rows},()=>Array(e.cols).fill(0)),numbers:t,solution:r,solved:!1,auto:!1,errorNodes:new Set,cycleCells:new Set,satisfiedNodes:new Set}}default:return e}}const oe=({rows:i,cols:c,numbers:l,size:d,initialMoves:g,onMove:p})=>{const h=a("sm"),m=g,[w,v]=e.useState(null),x=e.useRef(void 0),y=e.useRef(new Set),E=e.useRef(0),$=e.useCallback(e=>{y.current.add(e)},[]);e.useEffect(()=>{const e=()=>{v(null),y.current.clear(),x.current=void 0},t=e=>{if(null===w)return;const t=e.touches[0];if(!t)return;const r=document.elementFromPoint(t.clientX,t.clientY);if(!r)return;const o=r.closest("[data-pos]");if(o){const e=o.getAttribute("data-pos");e&&!y.current.has(e)&&(p(e,x.current),$(e))}};return window.addEventListener("mouseup",e),window.addEventListener("touchend",e),window.addEventListener("touchcancel",e),window.addEventListener("touchmove",t,{passive:!1}),()=>{window.removeEventListener("mouseup",e),window.removeEventListener("touchend",e),window.removeEventListener("touchcancel",e),window.removeEventListener("touchmove",t)}},[w,$,p]);const[R,M]=e.useState(new Map),[L,k]=e.useState([]);e.useEffect(()=>{const e=new Map,t=[],r=[];m.forEach((r,o)=>{e.set(o,{state:r,source:"user"});const[n,s]=o.split(",").map(Number);void 0!==n&&void 0!==s&&t.push({r:n,c:s})});const o=(t,r)=>{if(t<0||t>=i||r<0||r>=c)return 0;const o=`${String(t)},${String(r)}`;return e.get(o)?.state??0},n=(o,n,s,i)=>{const c=`${String(o)},${String(n)}`,l=e.get(c);l?l.state!==s&&r.push({type:"cell",r:o,c:n}):(e.set(c,{state:s,source:i}),t.push({r:o,c:n}))},s=(e,t)=>[{r:e-1,c:t-1,required:F},{r:e-1,c:t,required:V},{r:e,c:t-1,required:V},{r:e,c:t,required:F}].filter(e=>e.r>=0&&e.r<i&&e.c>=0&&e.c<c);let a=0;for(;a<t.length;){const i=t[a++];if(!i)break;const{r:c,c:u}=i,d=[{r:c,c:u},{r:c,c:u+1},{r:c+1,c:u},{r:c+1,c:u+1}];for(const t of d){const i=l[t.r]?.[t.c];if(null==i)continue;const a=s(t.r,t.c);let d=0;const f=[];for(const e of a){const t=o(e.r,e.c);0===t?f.push(e):t===e.required&&d++}if(d>i)r.push({type:"node",r:t.r,c:t.c});else if(d+f.length<i)r.push({type:"node",r:t.r,c:t.c});else if("user"===e.get(`${String(c)},${String(u)}`)?.source)if(d===i&&f.length>0)for(const e of f){const t=e.required===V?F:V;n(e.r,e.c,t,"propagated")}else if(d+f.length===i&&f.length>0)for(const e of f)n(e.r,e.c,e.required,"propagated")}}M(e),k(r)},[m,l,i,c]);const A=.4*d,z=d-A,D=e.useMemo(()=>new Set(L.filter(e=>"cell"===e.type).map(e=>`${String(e.r)},${String(e.c)}`)),[L]),O=e.useMemo(()=>new Set(L.filter(e=>"node"===e.type).map(e=>`${String(e.r)},${String(e.c)}`)),[L]);return t.jsxs(f,{sx:{position:"relative",userSelect:"none"},children:[t.jsx(f,{sx:{position:"absolute",top:-40,left:0,right:0,display:"flex",justifyContent:"center",pointerEvents:"none"},children:t.jsx(f,{sx:{color:U.OVERLAY_LABEL,fontSize:"0.8rem",fontWeight:"bold",letterSpacing:"0.2rem",border:`1px solid ${U.HINT_BORDER}`,padding:"4px 12px",borderRadius:r.borderRadius.sm,background:U.OVERLAY_BG,backdropFilter:"blur(4px)"},children:"CALCULATOR"})}),t.jsxs(f,{sx:{position:"relative",padding:h?S:b,border:`2px dashed ${U.DASHED_BORDER}`,borderRadius:N},children:[t.jsx(f,{sx:{position:"relative",zIndex:o.zIndex.base+1},children:t.jsx(u,{size:d,rows:i,cols:c,cellProps:(e,o)=>{const i=`${String(e)},${String(o)}`,c=R.get(i),l=c?.state??0,a=c?.source,u=D.has(i);let d=n.text.primary;return u?d=n.data.red:"user"===a?d=n.primary.main:"propagated"===a&&(d=n.data.green),{onMouseDown:e=>{if(0!==e.button)return;if(Date.now()-E.current<j)return;e.preventDefault();const t=m.get(i),r=t===V?F:t===F?void 0:V;x.current=r,v(e.button),p(i,r),$(i)},onMouseEnter:()=>{0!==w||y.current.has(i)||(p(i,x.current),$(i))},onTouchStart:e=>{e.cancelable&&e.preventDefault(),E.current=Date.now();const t=m.get(i),r=t===V?F:t===F?void 0:V;x.current=r,v(0),p(i,r),$(i)},"data-pos":i,"data-type":"cell",sx:{cursor:"pointer",border:`1px solid ${U.BORDER}`,position:"relative",transition:"all 0.2s",touchAction:"none",backgroundColor:u?`${n.data.red}20`:U.BG_SUBTLE,"&:hover":{backgroundColor:u?`${n.data.red}30`:U.BG_HOVER}},children:t.jsxs(f,{sx:{width:"100%",height:"100%",position:"relative"},children:[l===V&&t.jsx(f,{sx:{position:"absolute",width:I,height:C,backgroundColor:d,borderRadius:r.borderRadius.full,top:"50%",left:"50%",transform:"translate(-50%, -50%) rotate(-45deg)",boxShadow:J.LINE,transition:s.transition,pointerEvents:"none"}}),l===F&&t.jsx(f,{sx:{position:"absolute",width:I,height:C,backgroundColor:d,borderRadius:r.borderRadius.full,top:"50%",left:"50%",transform:"translate(-50%, -50%) rotate(45deg)",boxShadow:J.LINE,transition:s.transition,pointerEvents:"none"}})]})}},space:0,sx:{width:"fit-content"}})}),t.jsx(f,{sx:{position:"absolute",top:h?S:b,left:h?S:b,transform:`translate(-${String(A/2)}rem, -${String(A/2)}rem)`,zIndex:o.zIndex.base+2,pointerEvents:"none"},children:t.jsx(u,{size:A,rows:i+1,cols:c+1,cellProps:(e,r)=>{const o=l[e]?.[r],s=O.has(`${String(e)},${String(r)}`);return{"data-pos":`${String(e)},${String(r)}`,"data-type":"hint",children:t.jsx(f,{children:o??""}),sx:{borderRadius:"50%",backgroundColor:s?n.data.red:U.HINT_BG,border:null!==o?`2px solid ${s?n.data.red:U.HINT_BORDER}`:"none",fontSize:`${String(.5*A)}rem`,fontWeight:"800",color:q.WHITE,zIndex:5,opacity:null!==o?1:0,display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",userSelect:"none",WebkitUserSelect:"none",transform:s?"scale(1.1)":"scale(1)",position:"relative",pointerEvents:"none"}}},space:z,sx:{width:"fit-content"}})})]})]})};function ne(){const{height:r,width:o}=h(),S=a("sm"),[b,I]=e.useState(!1),[C,N]=e.useState(()=>{const e=localStorage.getItem(T);return e&&"null"!==e?parseInt(e,10):W}),H=e.useMemo(()=>{const e=S?R.MOBILE:R.DESKTOP,t=d(4,r-e-M,Math.min(o,L));let n=t.rows-1;const s=t.cols-1;return S&&(n-=2),{rows:Math.max(G,n),cols:Math.max(G,s)}},[r,o,S]),{rows:Y,cols:U}=e.useMemo(()=>{const e=C??W;return{rows:Math.min(e,H.rows),cols:Math.min(e,H.cols)}},[C,H]),K=e.useMemo(()=>{const e=Math.min(o,k)*A/(U+1),t=(r-z)*A/(Y+1);return Math.min(e,t,D)/O},[o,r,Y,U]),[X,Q]=e.useReducer(re,{rows:Y,cols:U},e=>{const t=localStorage.getItem(B);if(t)try{const r=JSON.parse(t);if(r.rows===e.rows&&r.cols===e.cols)return{...r,errorNodes:new Set(r.errorNodes),cycleCells:new Set(r.cycleCells),satisfiedNodes:new Set(r.satisfiedNodes)}}catch(r){}return function(e,t){const{numbers:r,solution:o}=te(e,t);return{grid:Array.from({length:e},()=>Array(t).fill(0)),numbers:r,solution:o,rows:e,cols:t,solved:!1,auto:!1,errorNodes:new Set,cycleCells:new Set,satisfiedNodes:new Set}}(e.rows,e.cols)});e.useEffect(()=>{localStorage.setItem(T,String(C))},[C]),e.useEffect(()=>{if(X.rows!==Y||X.cols!==U){const t=`${B}-${String(Y)}x${String(U)}`,r=localStorage.getItem(t);if(r)try{const e=JSON.parse(r);return void Q({type:"hydrate",state:{...e,errorNodes:new Set(e.errorNodes),cycleCells:new Set(e.cycleCells),satisfiedNodes:new Set(e.satisfiedNodes)}})}catch(e){}Q({type:"resize",rows:Y,cols:U})}},[Y,U,X.rows,X.cols]);const[Z,ee]=e.useState(new Map);e.useEffect(()=>{const e=`${_}-${String(X.rows)}x${String(X.cols)}`,t=localStorage.getItem(e);if(t)try{ee(new Map(JSON.parse(t)))}catch(r){ee(new Map)}else ee(new Map)},[X.numbers,X.rows,X.cols]),e.useEffect(()=>{const e=`${B}-${String(X.rows)}x${String(X.cols)}`,t=`${_}-${String(X.rows)}x${String(X.cols)}`,r=X.grid.some(e=>e.some(e=>0!==e)),o=Z.size>0;if(!r&&!o)return localStorage.removeItem(e),void localStorage.removeItem(t);const n={...X,errorNodes:Array.from(X.errorNodes),cycleCells:Array.from(X.cycleCells),satisfiedNodes:Array.from(X.satisfiedNodes)};localStorage.setItem(e,JSON.stringify(n)),o?localStorage.setItem(t,JSON.stringify(Array.from(Z.entries()))):localStorage.removeItem(t)},[X,Z]);const ne=e.useRef("");e.useEffect(()=>{const e=JSON.stringify(X.numbers);ne.current&&ne.current!==e&&ee(new Map),ne.current=e},[X.numbers,X.rows,X.cols]),e.useEffect(()=>{document.title=i.slant},[]);const se=e.useCallback(()=>{Q({type:"new"})},[Q]);e.useEffect(()=>{if(X.solved){const e=setTimeout(()=>{se()},y);return()=>{clearTimeout(e)}}},[X.solved,se]);const[ie,ce]=e.useState(!1);e.useEffect(()=>{if(X.solved){const e=setTimeout(()=>{ce(!0)},E);return()=>{clearTimeout(e)}}ce(!1)},[X.solved]);const[le,ae]=e.useState(null),ue=e.useRef(new Set),de=e.useRef(0),fe=e.useCallback(e=>{ue.current.add(e)},[]);e.useEffect(()=>{const e=()=>{ae(null),ue.current.clear()},t=e=>{if(null===le)return;const t=e.touches[0];if(!t)return;const r=document.elementFromPoint(t.clientX,t.clientY);if(!r)return;const o=r.closest("[data-pos]");if(o){const e=o.getAttribute("data-pos");if(e&&!ue.current.has(e)){const[t,r]=e.split(",").map(Number);void 0!==t&&void 0!==r&&(Q({type:"toggle",row:t,col:r,reverse:2===le}),fe(e))}}};return window.addEventListener("mouseup",e),window.addEventListener("touchend",e),window.addEventListener("touchcancel",e),window.addEventListener("touchmove",t,{passive:!1}),()=>{window.removeEventListener("mouseup",e),window.removeEventListener("touchend",e),window.removeEventListener("touchcancel",e),window.removeEventListener("touchmove",t)}},[le,fe]);const ge=.4*K,pe=K-ge;return e.useEffect(()=>{if(!X.auto||X.solved)return;const e=setTimeout(()=>{Q({type:"nextLogical"})},$);return()=>{clearTimeout(e)}},[X.auto,X.solved,X.grid]),t.jsxs(g,{container:!0,minHeight:"100vh",flexDirection:"column",sx:{background:`radial-gradient(circle at 50% 50%, ${n.surface.elevated} 0%, ${n.surface.background} 100%)`,position:"relative",overflow:"hidden",height:"100vh",transition:"background 0.5s ease-in-out"},children:[t.jsx(p,{showHome:!0,infoUrl:"https://en.wikipedia.org/wiki/Gokigen_Naname"}),t.jsx(f,{onClick:()=>{b&&I(!1)},sx:{flex:1,position:"relative",width:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",padding:`${String(K)}rem`},children:t.jsx(f,{onClick:e=>{e.stopPropagation()},children:b?t.jsx(oe,{rows:Y,cols:U,numbers:X.numbers,size:K,initialMoves:Z,onMove:(e,t)=>{ee(r=>{const o=new Map(r);return void 0===t?o.delete(e):o.set(e,t),o})}}):t.jsxs(t.Fragment,{children:[t.jsxs(f,{sx:{position:"relative",userSelect:"none"},children:[t.jsx(f,{sx:{position:"relative",zIndex:1},children:t.jsx(u,{size:K,rows:Y,cols:U,cellProps:(e,r)=>{const o=X.grid[e]?.[r],i=`${String(e)},${String(r)}`,c=X.cycleCells.has(i);return{onMouseDown:t=>{X.solved||0!==t.button&&2!==t.button||Date.now()-de.current<j||(t.preventDefault(),ae(t.button),Q({type:"toggle",row:e,col:r,reverse:2===t.button}),fe(i))},onMouseEnter:()=>{null===le||ue.current.has(i)||X.solved||(Q({type:"toggle",row:e,col:r,reverse:2===le}),fe(i))},onContextMenu:e=>{e.preventDefault()},onTouchStart:t=>{X.solved||(t.cancelable&&t.preventDefault(),de.current=Date.now(),ae(0),Q({type:"toggle",row:e,col:r}),fe(i))},"data-pos":i,sx:{cursor:"pointer",border:`1px solid ${n.border.subtle}`,position:"relative",transition:"all 0.2s",touchAction:"none","&:hover":{backgroundColor:n.interactive.hover}},children:t.jsxs(f,{sx:{width:"100%",height:"100%",position:"relative"},children:[o===V&&t.jsx(f,{sx:{position:"absolute",width:"130%",height:"6px",backgroundColor:c?n.data.red:n.text.primary,borderRadius:"99px",top:"50%",left:"50%",transform:"translate(-50%, -50%) rotate(-45deg)",boxShadow:J.LINE,transition:s.transition,pointerEvents:"none"}}),o===F&&t.jsx(f,{sx:{position:"absolute",width:"130%",height:"6px",backgroundColor:c?n.data.red:n.text.primary,borderRadius:"99px",top:"50%",left:"50%",transform:"translate(-50%, -50%) rotate(45deg)",boxShadow:J.LINE,transition:s.transition,pointerEvents:"none"}})]})}},space:0,sx:{width:"fit-content"}})}),t.jsx(f,{sx:{position:"absolute",top:0,left:0,transform:`translate(-${String(ge/2)}rem, -${String(ge/2)}rem)`,zIndex:10,pointerEvents:"none"},children:t.jsx(u,{size:ge,rows:Y+1,cols:U+1,cellProps:(e,r)=>{const o=X.numbers[e]?.[r],s=X.errorNodes.has(`${String(e)},${String(r)}`),i=X.satisfiedNodes.has(`${String(e)},${String(r)}`);return{children:t.jsx(f,{sx:{opacity:i&&!s?.2:1,transition:"opacity 0.3s"},children:o??""}),sx:{borderRadius:"50%",backgroundColor:s?n.data.red:n.surface.background,border:null!==o?`2px solid ${s?n.data.red:i?"transparent":n.border.subtle}`:"none",fontSize:`${String(.5*ge)}rem`,fontWeight:"800",color:s?q.WHITE:n.text.primary,boxShadow:i&&!s?"none":J.HINT,zIndex:5,opacity:null!==o?1:0,display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",userSelect:"none",WebkitUserSelect:"none",transform:s?"scale(1.1)":"scale(1)",position:"relative",pointerEvents:"none"}}},space:pe,sx:{width:"fit-content"}})})]}),t.jsx(f,{onClick:se,sx:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",opacity:X.solved?1:0,transform:X.solved?"scale(1)":"scale(0.5)",visibility:X.solved?"visible":"hidden",transition:"all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1)",zIndex:20,backgroundColor:"transparent",pointerEvents:ie?"auto":"none",cursor:ie?"pointer":"default",backdropFilter:"blur(2px)"},children:t.jsx(m,{sx:{fontSize:`${String(K)}rem`,color:n.primary.main,filter:`drop-shadow(0 0 30px ${n.primary.main}88)`,animation:X.solved?"float 3s ease-in-out infinite":"none","@keyframes float":{"0%, 100%":{transform:"translateY(0)"},"50%":{transform:"translateY(-10px)"}}}})})]})})}),t.jsxs(c,{handler:()=>()=>{},onAutoPlay:()=>{Q({type:"auto"})},autoPlayEnabled:X.auto,children:[t.jsx(l,{title:"Decrease Size",Icon:w,onClick:()=>{N(e=>e&&e>G?e-1:G)},disabled:Y<=3||b}),t.jsx(l,{title:"Increase Size",Icon:v,onClick:()=>{N(e=>e?e+1:W-1)},disabled:Y>=P||Y>=H.rows&&U>=H.cols||b}),t.jsx(l,{title:b?"Close Calculator":"Open Calculator",Icon:x,onClick:()=>{I(!b)},sx:{color:b?n.primary.main:"inherit",backgroundColor:b?`${n.primary.main}20`:"transparent"}})]})]})}export{ne as default};
