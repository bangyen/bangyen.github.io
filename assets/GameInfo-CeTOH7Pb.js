import{r as e,j as t}from"./vendor_react-CPTKWKBb.js";import{B as n,P as o,G as s,d as r,u as i,M as a,j as l,I as c,e as d}from"./vendor_mui_core-CC-Vzdtj.js";import{T as u,a as f,L as x,S as m,c as h,A as p,R as g,e as b,C as y,E as S}from"./index-BPcuBZuL.js";import{m as w,n as v,M as j,E as z,j as k,o as C,p as I}from"./vendor_mui_icons-Dxxzao0W.js";import{G as D,P as E,t as R}from"./PageLayout-BivZ9oJq.js";import{F as M}from"./FeatureErrorFallback-D06YLDJu.js";const O={gridSizes:{mobile:2.5,desktop:4},timing:{winAnimationDelay:2e3,interactionDelay:500,touchHoldDelay:500},layout:{headerHeight:{mobile:64,desktop:80}}},P={divisor:4,fontSizeMultiplier:.375};const T={PADDING:{MOBILE:"30px",DESKTOP:"36px"},BORDER_RADIUS:"24px",BORDER:"2px solid transparent",SHADOW:"0 2px 4px rgba(0,0,0,0.2)",DROP_SHADOW:"drop-shadow(0 2px 4px rgba(0,0,0,0.2))"};function A(e){return{SIZE:`${e}-size`,STATE:`${e}-state`}}const $={boardMaxWidth:1200,boardSizeFactor:.94,remBase:16},L={minSize:3,mobileRowOffset:2,headerOffset:O.layout.headerHeight},W=e.memo(function({size:o,children:s,...r}){const i=`${o.toString()}rem`,a=`${(o/P.divisor).toString()}rem`,{backgroundColor:l,color:c,boxShadow:d,border:x,opacity:m,transition:h=!0,sx:p,...g}=r,b=!1===h?"none":"string"==typeof h?h:"background-color 200ms ease, color 200ms ease, opacity 200ms ease, transform 200ms ease, border-radius 200ms ease",y=e.useMemo(()=>({...f.flexCenter,borderRadius:a,height:i,width:i,fontSize:`${(o*P.fontSizeMultiplier).toString()}rem`,fontWeight:u.fontWeight.semibold,fontFamily:"monospace"}),[a,i,o]);return t.jsx(n,{role:"gridcell",...y,...g,sx:{backgroundColor:l,color:c,boxShadow:d,border:x,opacity:m,transition:b,...p},children:s})}),B=e.memo(function({cols:o,size:s,index:r,spacing:i,cellProps:a}){return t.jsx(n,{role:"row",sx:{display:"flex",gap:i,justifyContent:"center"},children:Array.from({length:o},(t,n)=>e.createElement(W,{...a(r,n),key:`${r.toString()}_${n.toString()}`,size:s}))})}),H=e.memo(function({size:e,rows:o,cols:s,cellProps:r,space:i,sx:a,...l}){const c=function(e){return`${(e*P.divisor).toString()}px`}(e),d=`${(i??c).toString()}rem`;return t.jsx(n,{role:"grid","aria-label":`Grid with ${o.toString()} rows and ${s.toString()} columns`,sx:{display:"flex",flexDirection:"column",alignItems:"center",gap:d,...a},...l,children:Array.from({length:o},(n,o)=>t.jsx(B,{index:o,cols:s,size:e,spacing:d,cellProps:r},`row_${o.toString()}`))})});function F(e){const{frontProps:o,backProps:s,size:r,rows:i,cols:a,frontLayerSx:l,backLayerSx:c}=e,d=l&&"pointerEvents"in l&&"none"===l.pointerEvents,u=c&&"pointerEvents"in c&&"none"===c.pointerEvents;return t.jsxs(n,{sx:{display:"grid",placeItems:"center"},children:[t.jsx(n,{sx:{gridArea:"1/1",...c},children:t.jsx(H,{space:0,size:r,rows:i-1,cols:a-1,cellProps:s,...u?{role:"presentation","aria-hidden":!0}:{}})}),t.jsx(n,{sx:{gridArea:"1/1",zIndex:x.zIndex.base+1,...l},children:t.jsx(H,{space:0,size:r,rows:i,cols:a,cellProps:o,...d?{role:"presentation","aria-hidden":!0}:{}})})]})}function G({children:e,...n}){return t.jsx(o,{elevation:0,component:"nav",role:"navigation","aria-label":"Game controls navigation",onClick:e=>{e.stopPropagation()},sx:{transform:"translateX(-50%)",position:"absolute",bottom:m.padding.xl,left:"50%",zIndex:x.zIndex.navigation,...p.presets.glass,borderRadius:m.borderRadius.lg,boxShadow:h.lg,padding:`${m.padding.sm} ${m.padding.lg}`,...n},children:t.jsx(s,{container:!0,spacing:2,sx:{...f.flexCenter,flexWrap:"nowrap",minWidth:0},children:e})})}function N({rows:e,cols:n,dynamicSize:o,minSize:s,maxSize:r,handlePlus:i,handleMinus:a,onRefresh:l,disabled:c=!1,onOpenInfo:d,hidden:u=!1,children:f}){if(u)return null;const x=Math.min(e,n)<=s,m=Math.min(e,n)>=r||Math.min(e,n)>=Math.min(o.rows,o.cols);return t.jsxs(G,{children:[t.jsx(g,{onClick:l}),t.jsx(b,{title:"Decrease Size",Icon:w,onClick:a,disabled:c||x}),t.jsx(b,{title:"Increase Size",Icon:v,onClick:i,disabled:c||m}),d&&t.jsx(b,{title:"How to Play",Icon:j,onClick:d}),f]})}function _({show:e,onReset:o,size:s,iconSizeRatio:i,primaryColor:a,secondaryColor:l,useSecondary:c=!1}){const d=c?l:a;return t.jsx(n,{sx:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",opacity:e?1:0,transform:e?"scale(1)":"scale(0.5)",visibility:e?"visible":"hidden",transition:"all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1)",zIndex:10,backgroundColor:"transparent",pointerEvents:"none"},children:s>0&&t.jsxs(D,{padding:m.padding.md,sx:{display:"flex",flexDirection:"column",alignItems:"center",gap:1.5,height:"auto",width:"auto",maxWidth:"80%"},children:[t.jsx(z,{sx:{fontSize:`${(s*i*.6).toString()}rem`,color:d,filter:"drop-shadow(0 4px 12px rgba(0,0,0,0.1))"}}),t.jsx(r,{variant:"h6",sx:{color:y.text.primary,fontWeight:600,letterSpacing:"0.02em"},children:"Solved!"})]})})}function K({children:e,controls:o,infoUrl:s,background:r=y.surface.background,paddingBottom:i={xs:"80px",md:"120px"},contentSx:a={},showTrophy:l=!1,onReset:c,boardSize:d=0,iconSizeRatio:u=1,primaryColor:f=y.primary.main,secondaryColor:x=y.primary.main,useSecondaryTrophy:m=!1,boardSx:h,onClick:p}){return t.jsx(S,{FallbackComponent:M,fallbackProps:{title:"Game Error",resetLabel:"Reset Game"},children:t.jsxs(E,{infoUrl:s,background:r,containerSx:{height:"100vh",transition:"background 0.5s ease-in-out",cursor:p?"pointer":"inherit"},sx:{justifyContent:"center",alignItems:"center"},onClick:p,children:[t.jsx(n,{sx:[{flex:1,position:"relative",width:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",overflow:"hidden",pb:i},...R(a)],children:t.jsxs(n,{sx:[{position:"relative",width:"fit-content",userSelect:"none",padding:{xs:T.PADDING.MOBILE,sm:T.PADDING.DESKTOP},borderRadius:T.BORDER_RADIUS,border:T.BORDER},...R(h)],children:[e,t.jsx(_,{show:l,onReset:c,size:d,iconSizeRatio:u,primaryColor:f,secondaryColor:x,useSecondary:m})]})}),o]})})}function U({storageKey:t,rows:n,cols:o,state:s,onRestore:r,serialize:i,deserialize:a,enabled:l=!0,saveDebounceMs:c=300}){const d=`${t}-${String(n)}x${String(o)}`,u=e.useRef(r),f=e.useRef(a),x=e.useRef(i);e.useEffect(()=>{u.current=r,f.current=a,x.current=i}),e.useEffect(()=>{if(!l)return;const e=localStorage.getItem(d);if(e)try{const t=JSON.parse(e),n=f.current??(e=>e);u.current(n(t))}catch{localStorage.removeItem(d)}},[d,l]),e.useEffect(()=>{if(!l)return;const e=setTimeout(()=>{const e=(x.current??(e=>e))(s);localStorage.setItem(d,JSON.stringify(e))},c);return()=>{clearTimeout(e)}},[d,s,l,c])}function J(){const{innerWidth:e,innerHeight:t}=globalThis;return{width:e,height:t}}function X(){const{size:t}=function(t){const[n,o]=e.useState(t());return e.useEffect(()=>{function e(){o(t())}return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[t]),{size:n,setSize:o}}(J);return t}function Y(e){return i(t=>t.breakpoints.down(e))}function Z({storageKey:t,defaultSize:n,minSize:o=2,maxSize:s=10,headerOffset:r,paddingOffset:i=0,widthLimit:a=1300,cellSizeReference:l,mobileRowOffset:c=0}){const{height:d,width:u}=X(),f=Y("sm"),[x,m]=e.useState(()=>{const e=localStorage.getItem(t);return"null"===e?null:e?Number.parseInt(e,10):n}),h=e.useMemo(()=>{const e=f?r.mobile:r.desktop,t="number"==typeof l?l:f?l.mobile:l.desktop,n="number"==typeof i?0:i.x,s="number"==typeof i?i:i.y,x=function(e,t,n){const o=16*e;return{rows:Math.floor(t/o),cols:Math.floor(n/o)}}(t,d-e-s,Math.min(u,a)-n);let m=x.rows-1;const h=x.cols-1;return f&&(m+=c),{rows:Math.max(o,m),cols:Math.max(o,h)}},[l,d,u,f,r,i,a,o,c]),{rows:p,cols:g}=e.useMemo(()=>{if(null===x)return h;const e=f?Math.max(0,c+1):0;return{rows:Math.min(x+e,h.rows),cols:Math.min(x,h.cols)}},[x,h,f,c]);e.useEffect(()=>{localStorage.setItem(t,String(x))},[x,t]);return{rows:p,cols:g,dynamicSize:h,handlePlus:()=>{const e=Math.min(p,g);null!==x&&e<Math.min(h.rows,h.cols)&&e<s&&m(e+1)},handleMinus:()=>{const e=Math.min(p,g);if(null===x){const e=Math.min(h.rows,h.cols);h.rows===h.cols?m(Math.max(o,e-1)):m(e)}else e>o&&m(e-1)},desiredSize:x,setDesiredSize:m,mobile:f,width:u,height:d,minSize:o,maxSize:s}}function q({storageKeys:t,pageTitle:n,gridConfig:o,boardConfig:s,reducer:r,getInitialState:i,winAnimationDelay:a,isSolved:l,persistence:c,manualResize:d=!1,onNext:u}){const f={...L,...o},x=e.useMemo(()=>({...$,...s}),[s]),{rows:m,cols:h,dynamicSize:p,handlePlus:g,handleMinus:b,mobile:y,width:S,height:w,minSize:v,maxSize:j}=Z({storageKey:t.size,...f}),z=e.useRef(null);null===z.current&&(z.current=i(m,h));const[k,C]=e.useReducer(r,z.current),I=e.useMemo(()=>l(k),[k,l]),D=e.useCallback(()=>{C({type:"new"})},[C]),E=u??D;var R;U({storageKey:t.state,rows:m,cols:h,state:k,onRestore:e=>{C({type:"hydrate",state:e})},...c}),function(t,n,o=2e3){const s=e.useRef(n);s.current=n,e.useEffect(()=>{if(t){const e=setTimeout(()=>{s.current()},o);return()=>{clearTimeout(e)}}},[t,o])}(I,E,a),R=n,e.useEffect(()=>{document.title=R},[R]),e.useEffect(()=>{d||C({type:"resize",rows:m,cols:h,newRows:m,newCols:h})},[m,h,C,d]);const M=e.useMemo(()=>{const e="function"==typeof x.paddingOffset?x.paddingOffset(y):x.paddingOffset;return function({rows:e,cols:t,width:n,height:o,mobile:s,headerOffset:r,paddingOffset:i,boardMaxWidth:a,boardSizeFactor:l,maxCellSize:c,remBase:d}){const u=s?r.mobile:r.desktop,f="number"==typeof i?0:i.x,x="number"==typeof i?i:i.y,m=(Math.min(n,a)-f)*l,h=(o-u-x)*l;return Math.min(m/t,h/e,c)/d}({rows:m+(x.rowOffset??0),cols:h+(x.colOffset??0),width:S,height:w,mobile:y,headerOffset:f.headerOffset,...x,paddingOffset:e})},[m,h,S,w,y,x,f.headerOffset]);return{rows:m,cols:h,state:k,dispatch:C,size:M,mobile:y,solved:I,handleNext:E,controlsProps:{rows:m,cols:h,dynamicSize:p,minSize:v,maxSize:j,handlePlus:g,handleMinus:b,onRefresh:E}}}function Q({onAction:t,checkEnabled:n=()=>!0,touchTimeout:o=500,posAttribute:s="data-pos",preventDefault:r=!0,transition:i="all 0.2s"}){const[a,l]=e.useState(null),c=e.useRef(new Set),d=e.useRef(0),u=e.useCallback(()=>{l(null),c.current.clear()},[]),f=e.useCallback(e=>{if(null===a)return;const n=e.touches[0];if(!n)return;const o=document.elementFromPoint(n.clientX,n.clientY);if(!o)return;const r=o.closest(`[${s}]`);if(r){const e=r.getAttribute(s);e&&!c.current.has(e)&&(t(e,2===a,!1),c.current.add(e))}},[a,t,s]);e.useEffect(()=>(globalThis.addEventListener("mouseup",u),globalThis.addEventListener("touchend",u),globalThis.addEventListener("touchcancel",u),globalThis.addEventListener("touchmove",f,{passive:!1}),()=>{globalThis.removeEventListener("mouseup",u),globalThis.removeEventListener("touchend",u),globalThis.removeEventListener("touchcancel",u),globalThis.removeEventListener("touchmove",f)}),[u,f]);const x=e.useCallback(e=>({onMouseDown:s=>{n()&&(0!==s.button&&2!==s.button||Date.now()-d.current<o||(r&&s.preventDefault(),l(s.button),t(e,2===s.button,!0),c.current.add(e)))},onMouseEnter:()=>{null!==a&&!c.current.has(e)&&n()&&(t(e,2===a,!1),c.current.add(e))},onTouchStart:o=>{n()&&(o.cancelable&&r&&o.preventDefault(),d.current=Date.now(),l(0),t(e,!1,!0),c.current.add(e))},onKeyDown:o=>{n()&&("Enter"!==o.key&&" "!==o.key||(o.preventDefault(),t(e,!1,!0)))},onContextMenu:e=>{r&&e.preventDefault()},[s]:e,role:"button",tabIndex:0,sx:{touchAction:"none",transition:i}}),[t,n,a,o,s,r,i]);return{isDragging:null!==a,draggingButton:a,getDragProps:x,lastTouchTime:d}}function V({onToggle:t,checkEnabled:n,touchTimeout:o,transition:s,posAttribute:r}){const i=e.useRef(void 0),a=e.useRef(t);a.current=t;const l=e.useCallback((e,t,o)=>{if(!n())return;const[s,r]=e.split(",").map(Number);void 0!==s&&void 0!==r&&(o?i.current=a.current(s,r,t,void 0,!0):a.current(s,r,t,i.current,!1))},[n]),{getDragProps:c}=Q({onAction:l,checkEnabled:n,touchTimeout:o,transition:s,posAttribute:r});return{getDragProps:c}}function ee(e,t){return`${e.toString()},${t.toString()}`}function te(e){return(t,n)=>{if(e.customHandler){const o=e.customHandler(t,n);if(o!==t)return o}switch(n.type){case"resize":if("newRows"in n||"rows"in n||"cols"in n){const o=n.newRows??n.rows??t.rows,s=n.newCols??n.cols??t.cols;return o===t.rows&&s===t.cols?t:e.getInitialState(o,s)}return t;case"new":case"next":case"reset":return e.getInitialState(t.rows,t.cols);case"restore":case"hydrate":return"state"in n?n.state:t;default:return t}}}function ne(t,n,o){return e.useMemo(()=>t(n,...o),[t,n,o])}const oe=e=>{if(e<1||e>100)throw new Error("Invalid grid size: must be between 1 and 100");return e},se=e=>{if(e<0)throw new Error("Invalid cell index: cannot be negative");return e},re={backgroundColor:e=>"dark"===e.palette.mode?"hsla(0, 0%, 3%, 0.85)":"hsla(0, 0%, 98%, 0.85)",backdropFilter:"blur(12px) saturate(180%)",transition:"all 0.3s ease-in-out !important"},ie={zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},ae={outline:"none",display:"flex",justifyContent:"center",alignItems:"center",width:"100%"},le={width:"100%",maxWidth:"1000px",height:{xs:"630px",sm:"495px"},minHeight:{xs:"630px",sm:"495px"},display:"flex",flexDirection:"column",p:0,overflow:"hidden",position:"relative",m:2},ce=e=>({flex:1,overflowY:1===e?"hidden":"auto",p:{xs:2.5,md:3},display:"flex",flexDirection:"column"}),de={display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,px:2},ue={color:y.text.secondary},fe=e=>({flex:1,display:"flex",flexDirection:"column",pr:0===e?{xs:3,md:0}:0}),xe=({children:e})=>t.jsx(r,{variant:"h5",sx:{color:y.text.primary,fontWeight:u.fontWeight.bold,textAlign:"left",fontSize:u.fontSize.h2},children:e}),me=D;function he({open:o,toggleOpen:s,titles:r,cardSx:i,contentSxOverride:u,steps:f,children:x}){const[m,h]=e.useState(0),p=r.length,g=()=>{s()},b=u?u(m):ce(m);return t.jsx(a,{open:o,onClose:g,slots:{backdrop:l},slotProps:{backdrop:{sx:re}},sx:ie,children:t.jsx(n,{sx:ae,children:t.jsxs(me,{onClick:e=>{e.stopPropagation()},sx:{...le,...i},children:[t.jsxs(n,{sx:b,children:[t.jsxs(n,{sx:de,children:[t.jsx(xe,{children:r[m]}),t.jsx(c,{onClick:g,size:"small",sx:ue,children:t.jsx(k,{})})]}),t.jsx(n,{sx:fe(m),children:f?f[m]:x?.(m)})]}),t.jsxs(n,{sx:{p:2.5,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx(d,{onClick:()=>{m>0&&h(m-1)},disabled:0===m,startIcon:t.jsx(C,{}),sx:{visibility:0===m?"hidden":"visible",color:y.text.primary},children:"Back"}),t.jsx(n,{sx:{display:"flex",gap:1},children:Array.from({length:p},(e,o)=>t.jsx(n,{sx:{width:8,height:8,borderRadius:"50%",backgroundColor:m===o?y.primary.main:y.interactive.disabled,transition:"background-color 0.3s"}},o))}),t.jsx(d,{onClick:()=>{m<p-1?h(m+1):s()},disabled:m===p-1,endIcon:t.jsx(I,{}),sx:{visibility:m===p-1?"hidden":"visible",color:y.text.primary},children:"Next"})]})]})})})}function pe({Icon:e,title:o,text:s}){return t.jsxs(n,{sx:{px:2},children:[t.jsxs(r,{variant:"h6",sx:{color:y.text.primary,fontWeight:u.fontWeight.semibold,display:"flex",alignItems:"center",mb:1.5,fontSize:u.fontSize.subheading},children:[t.jsx(e,{sx:{mr:2,color:y.primary.main,fontSize:"1.75rem"}}),o]}),t.jsx(r,{variant:"body1",sx:{color:y.text.secondary,lineHeight:1.6,fontSize:u.fontSize.body,ml:6},children:s})]})}function ge({open:e,toggleOpen:o,titles:s,instructions:r,instructionsFooter:i,exampleContent:a,extraSteps:l=[],cardSx:c,contentSxOverride:d}){const u=t.jsxs(n,{sx:{animation:"fadeIn 0.3s ease",flex:1,display:"flex",flexDirection:"column"},children:[t.jsx(n,{sx:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center",gap:4},children:r.map(({Icon:e,title:n,text:o})=>t.jsx(pe,{Icon:e,title:n,text:o},n))}),i]}),f=t.jsx(n,{sx:{flex:1,display:"flex",flexDirection:"column",animation:"fadeIn 0.3s ease"},children:t.jsx(n,{sx:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center"},children:a})});return t.jsx(he,{open:e,toggleOpen:o,titles:s,cardSx:c,contentSxOverride:d,steps:[u,f,...l]})}export{T as B,H as C,O as G,oe as a,A as b,te as c,F as d,Q as e,ge as f,ee as g,q as h,V as i,ne as j,se as k,K as l,N as m,U as n,ce as o,Y as u};
