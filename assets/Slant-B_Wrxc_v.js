import{a as e,j as t,r}from"./vendor_react-DdkxgTu-.js";import{B as o,b as n,g as s,u as i,h as a,k as l,C as c,c as u,a as d,f,m as p,i as g,G as h,l as m,j as b,d as S}from"./types-CoWQsDKA.js";import{B as x}from"./vendor_mui_core-BDo3HO1u.js";import{A as y,S as v,e as w,C,L as E,d as k}from"./index-CWtgJWv6.js";import{k as R,D as T,f as O,P as I}from"./vendor_mui_icons-DnJHG1Ba.js";import"./PageLayout-DoHekvO3.js";const N="130%",D="6px",j=100,A=1e3,M=100,z=.8,H={...n("slant"),GHOST_MOVES:"slant-ghost-moves"},G=0,B=8,$=5,L={COLORS:{WHITE:"#fff"},SHADOWS:{LINE:o.SHADOW,HINT:"0 4px 8px rgba(0,0,0,0.1)"},GHOST:{BORDER:"var(--slant-ghost-border)",BG_SUBTLE:"var(--slant-ghost-bg-subtle)",BG_HOVER:"var(--slant-ghost-bg-hover)",DASHED_BORDER:"var(--slant-ghost-dashed-border)",HINT_BG:"var(--slant-ghost-hint-bg)",HINT_BORDER:"var(--slant-ghost-hint-border)",HINT_TEXT:"var(--slant-ghost-hint-text)"}},P=1,_=2,W=e.memo(function({value:e,color:r}){return t.jsxs(x,{sx:{width:"100%",height:"100%",position:"relative"},children:[e===P&&t.jsx(x,{sx:{position:"absolute",width:N,height:D,backgroundColor:r,borderRadius:v.borderRadius.full,top:"50%",left:"50%",transform:"translate(-50%, -50%) rotate(-45deg)",boxShadow:L.SHADOWS.LINE,transition:y.transition,pointerEvents:"none"}}),e===_&&t.jsx(x,{sx:{position:"absolute",width:N,height:D,backgroundColor:r,borderRadius:v.borderRadius.full,top:"50%",left:"50%",transform:"translate(-50%, -50%) rotate(45deg)",boxShadow:L.SHADOWS.LINE,transition:y.transition,pointerEvents:"none"}})]})}),U=({onCopy:e,onClear:r,onClose:o})=>t.jsxs(x,{sx:{display:"flex",justifyContent:"center",gap:2,position:"absolute",bottom:-90,left:0,right:0,pointerEvents:"auto",zIndex:E.zIndex.base+5,paddingBottom:2},children:[t.jsx(w,{title:"Copy Board",Icon:R,onClick:e,sx:{backgroundColor:C.interactive.selected,color:C.primary.main,"&:hover":{backgroundColor:C.interactive.focus}}}),t.jsx(w,{title:"Clear Calculator",Icon:T,onClick:r,sx:{backgroundColor:"rgba(255, 68, 68, 0.1)",color:C.data.red,"&:hover":{backgroundColor:"rgba(255, 68, 68, 0.2)"}}}),t.jsx(w,{title:"Close Calculator",Icon:O,onClick:o,sx:{backgroundColor:"rgba(255, 193, 7, 0.1)",color:C.data.amber,"&:hover":{backgroundColor:"rgba(255, 193, 7, 0.2)"}}})]}),q=e.memo(function({value:e,hasConflict:r,numberSize:o}){return t.jsx(x,{sx:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:`${String(.5*o)}rem`,fontWeight:"800",color:r?L.COLORS.WHITE:L.GHOST.HINT_TEXT,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",userSelect:"none",WebkitUserSelect:"none",transform:r?"scale(1.1)":"scale(1)"},children:e??""})});class K{constructor(e){this.parent=Array.from({length:e},(e,t)=>t)}find(e){const t=this.parent[e];if(void 0===t)throw new Error(`DSU: Index ${String(e)} out of bounds`);t!==e&&(this.parent[e]=this.find(t));const r=this.parent[e];if(void 0===r)throw new Error(`DSU: Parent of ${String(e)} became undefined`);return r}union(e,t){const r=this.find(e),o=this.find(t);return r!==o&&(this.parent[r]=o,!0)}connected(e,t){return this.find(e)===this.find(t)}}function V(e,t,r){return e*(r+1)+t}function F(e,t,r){const o=new Map,n=new Set;for(let s=0;s<t;s++)for(let t=0;t<r;t++){const n=e[s]?.[t];if(!n||0===n)continue;const i=V(s,n===P?t+1:t,r),a=V(s+1,n===P?t:t+1,r);o.has(i)||o.set(i,[]),o.has(a)||o.set(a,[]),o.get(i)?.push({node:a,r:s,c:t}),o.get(a)?.push({node:i,r:s,c:t})}const i=new Set,a=new Set,l=[],c=(e,t)=>{i.add(e),a.add(e);const r=o.get(e)??[];for(const{node:o,r:u,c:d}of r)if(o!==t)if(a.has(o)){n.add(s(u,d));for(let e=l.length-1;e>=0;e--){const t=l[e];if(!t)break;if(n.add(s(t.r,t.c)),t.u===o||t.v===o)break}}else i.has(o)||(l.push({r:u,c:d,u:e,v:o}),c(o,e),l.pop());a.delete(e)};for(const s of o.keys())i.has(s)||c(s,-1);return n}const X=({rows:e,cols:n,numbers:u,size:d,initialMoves:f,onMove:p,onCopy:g,onClear:h,onClose:m})=>{const b=i("sm"),S=f,{getDragProps:y}=a({onToggle:(e,t,r,o,n)=>{const i=s(e,t);if(!n)return void p(i,o);const a=S.get(i);let l;return l=r?a===P?_:a===_?void 0:P:a===_?P:a===P?void 0:_,p(i,l),l},touchTimeout:l.timing.touchHoldDelay,checkEnabled:()=>!0}),[v,w]=r.useState(new Map),[k,R]=r.useState([]),[T,O]=r.useState(new Set),I=r.useRef(null),[N,D]=r.useState("probing");r.useEffect(()=>{let e=!1;const t=new Worker(new URL("/assets/solverWorker-Dugk-xAa.js",import.meta.url),{type:"module"});I.current=t;const r=setTimeout(()=>{e||(D("broken"),I.current=null,t.terminate())},2e3);return t.onmessage=t=>{if(e)return;const o=t.data;"RESULT"===o.type&&D(e=>{if("probing"===e)return clearTimeout(r),"healthy";const{gridState:t,conflicts:n,cycleCells:s}=o.payload;return w(t),R(n),O(s),e})},t.onerror=()=>{clearTimeout(r),D("broken"),I.current=null,t.terminate()},t.postMessage({type:"SOLVE",payload:{rows:2,cols:2,numbers:[[null,null,null],[null,null,null],[null,null,null]],userMoves:new Map}}),()=>{e=!0,clearTimeout(r),t.terminate()}},[]),r.useEffect(()=>{if("healthy"===N&&I.current)I.current.postMessage({type:"SOLVE",payload:{rows:e,cols:n,numbers:u,userMoves:S}});else if("broken"===N){const t=function(e,t,r,o){const n=new Map,i=[],a=[];o.forEach((e,t)=>{n.set(t,{state:e,source:"user"});const[r,o]=t.split(",").map(Number);void 0!==r&&void 0!==o&&i.push({r:r,c:o})});const l=(r,o)=>{if(r<0||r>=e||o<0||o>=t)return 0;const i=s(r,o);return n.get(i)?.state??0},c=(e,t,r,o)=>{const l=s(e,t),c=n.get(l);c?c.state!==r&&a.push({type:"cell",r:e,c:t}):(n.set(l,{state:r,source:o}),i.push({r:e,c:t}))},u=(r,o)=>[{r:r-1,c:o-1,required:_},{r:r-1,c:o,required:P},{r:r,c:o-1,required:P},{r:r,c:o,required:_}].filter(r=>r.r>=0&&r.r<e&&r.c>=0&&r.c<t);let d=0;for(;d<i.length;){const e=i[d++];if(!e)break;const{r:t,c:o}=e,f=[{r:t,c:o},{r:t,c:o+1},{r:t+1,c:o},{r:t+1,c:o+1}];for(const i of f){const e=r[i.r]?.[i.c];if(null==e)continue;const d=u(i.r,i.c);let f=0;const p=[];for(const t of d){const e=l(t.r,t.c);0===e?p.push(t):e===t.required&&f++}if(f>e)a.push({type:"node",r:i.r,c:i.c});else if(f+p.length<e)a.push({type:"node",r:i.r,c:i.c});else if("user"===n.get(s(t,o))?.source)if(f===e&&p.length>0)for(const t of p){const e=t.required===P?_:P;c(t.r,t.c,e,"propagated")}else if(f+p.length===e&&p.length>0)for(const t of p)c(t.r,t.c,t.required,"propagated")}}const f=Array.from({length:e},()=>new Array(t).fill(0));for(const[s,g]of n.entries()){const[e,t]=s.split(",").map(Number);void 0!==e&&void 0!==t&&f[e]&&(f[e][t]=g.state)}const p=F(f,e,t);return{gridState:n,conflicts:a,cycleCells:p}}(e,n,u,S);w(t.gridState),R(t.conflicts),O(t.cycleCells)}},[S,u,e,n,N]);const j=.4*d,A=d-j,M=r.useMemo(()=>new Set(k.filter(e=>"cell"===e.type).map(e=>s(e.r,e.c))),[k]),z=r.useMemo(()=>new Set(k.filter(e=>"node"===e.type).map(e=>s(e.r,e.c))),[k]),H=r.useCallback((e,r)=>{const o=s(e,r),n=v.get(o),i=n?.state??0,a=n?.source,l=M.has(o),c=T.has(o),u=y(o);let d=C.text.primary;return l?d=C.data.red:c?d="user"===a?C.data.red:"#ff9800":"user"===a?d=C.primary.main:"propagated"===a&&(d=C.data.green),{...u,"data-pos":o,"data-type":"cell",sx:{...u.sx,cursor:"pointer",border:`1px solid ${L.GHOST.BORDER}`,position:"relative",backgroundColor:L.GHOST.BG_SUBTLE,"&:hover":{backgroundColor:L.GHOST.BG_HOVER}},children:t.jsx(W,{value:i,color:d})}},[v,M,T,y]),G=r.useCallback((e,r)=>{const o=u[e]?.[r],n=z.has(s(e,r));return{"data-pos":s(e,r),"data-type":"hint",children:t.jsx(q,{value:o??null,hasConflict:n,numberSize:j}),sx:{borderRadius:"50%",backgroundColor:n?C.data.red:L.GHOST.HINT_BG,border:null==o?"none":`2px solid ${n?C.data.red:L.GHOST.HINT_BORDER}`,zIndex:5,opacity:null==o?0:1,position:"relative",pointerEvents:"none"}}},[u,z,j]);return t.jsxs(x,{sx:{position:"relative",userSelect:"none"},children:[t.jsxs(x,{sx:{position:"relative",padding:b?o.PADDING.MOBILE:o.PADDING.DESKTOP,border:`2px dashed ${L.GHOST.DASHED_BORDER}`,borderRadius:o.BORDER_RADIUS},children:[t.jsx(x,{sx:{position:"relative",zIndex:E.zIndex.base+1},children:t.jsx(c,{size:d,rows:e,cols:n,cellProps:H,space:0,sx:{width:"fit-content"}})}),t.jsx(x,{sx:{position:"absolute",top:b?o.PADDING.MOBILE:o.PADDING.DESKTOP,left:b?o.PADDING.MOBILE:o.PADDING.DESKTOP,transform:`translate(-${String(j/2)}rem, -${String(j/2)}rem)`,zIndex:E.zIndex.base+2,pointerEvents:"none"},children:t.jsx(c,{size:j,rows:e+1,cols:n+1,cellProps:G,space:A,sx:{width:"fit-content"}})})]}),t.jsx(U,{onCopy:g,onClear:h,onClose:m})]})};function J({getInitialState:e,dispatchRef:t,dimsRef:o}){const[n,s]=r.useState(!1),i=r.useRef(null),a=r.useRef("probing"),l=r.useRef(0),c=r.useRef(0),u=r.useRef(null),d=r.useRef(0),f=r.useCallback((r,o)=>{t.current?.({type:"hydrate",state:e(r,o)}),s(!1)},[t,e]),p=r.useCallback((e,t)=>{s(!0),null!==u.current&&clearTimeout(u.current),cancelAnimationFrame(c.current),u.current=setTimeout(()=>{u.current=null;const r=++l.current;"healthy"===a.current&&i.current?(d.current++,i.current.postMessage({type:"GENERATE",payload:{rows:e,cols:t}})):c.current=requestAnimationFrame(()=>{l.current===r&&f(e,t)})},250)},[f]),g=r.useCallback(()=>{p(o.current.rows,o.current.cols)},[p,o]);return r.useEffect(()=>{let e=!1;const r=new Worker(new URL("/assets/generationWorker-BbDUB26K.js",import.meta.url),{type:"module"});i.current=r;const o=setTimeout(()=>{e||"probing"!==a.current||(a.current="broken",d.current=0,i.current=null,r.terminate())},2e3);return r.onmessage=n=>{if(!e){if("ERROR"===n.data.type)return clearTimeout(o),a.current="broken",d.current=0,i.current=null,void r.terminate();if("RESULT"===n.data.type){if("probing"===a.current)return clearTimeout(o),void(a.current="healthy");if(d.current--,d.current>0)return;const{rows:e,cols:r,numbers:i,solution:l}=n.data.payload;t.current?.({type:"hydrate",state:{grid:Array.from({length:e},()=>new Array(r).fill(0)),numbers:i,solution:l,rows:e,cols:r,solved:!1,errorNodes:new Set,cycleCells:new Set,satisfiedNodes:new Set}}),s(!1)}}},r.onerror=()=>{clearTimeout(o),a.current="broken",d.current=0,i.current=null,r.terminate()},r.postMessage({type:"GENERATE",payload:{rows:3,cols:3}}),()=>{e=!0,clearTimeout(o),null!==u.current&&clearTimeout(u.current),r.terminate()}},[t]),{generating:n,requestGeneration:p,handleNextAsync:g}}function Z(e,t,r){const o=Array.from({length:t+1},()=>new Array(r+1).fill(0));for(let n=0;n<t;n++){const t=e[n];if(t)for(let e=0;e<r;e++){const r=t[e];if(r===P){const t=o[n];if(t){const r=t[e+1];void 0!==r&&(t[e+1]=r+1)}const r=o[n+1];if(r){const t=r[e];void 0!==t&&(r[e]=t+1)}}else if(r===_){const t=o[n];if(t){const r=t[e];void 0!==r&&(t[e]=r+1)}const r=o[n+1];if(r){const t=r[e+1];void 0!==t&&(r[e+1]=t+1)}}}}return o}function Q(e,t,r){const o=Array.from({length:t},()=>new Array(r).fill(0)),n=new K((t+1)*(r+1));let s=!0;for(;s;){s=!1;for(let i=0;i<=t;i++)for(let a=0;a<=r;a++){const l=e[i]?.[a];if(null==l)continue;const c=[{gr:i-1,gc:a-1,pt:_},{gr:i-1,gc:a,pt:P},{gr:i,gc:a-1,pt:P},{gr:i,gc:a,pt:_}].filter(({gr:e,gc:o})=>e>=0&&e<t&&o>=0&&o<r);let u=0;const d=[];for(const e of c){const t=o[e.gr]?.[e.gc];0===t?d.push(e):t===e.pt&&u++}if(u===l&&d.length>0)for(const{gr:e,gc:t,pt:i}of d){const a=o[e];if(0===a?.[t]){const o=i===P?_:P;a[t]=o,s=!0;const l=V(e,o===P?t+1:t,r),c=V(e+1,o===P?t:t+1,r);if(n.connected(l,c))return!1;n.union(l,c)}}else if(u+d.length===l&&d.length>0)for(const{gr:e,gc:t,pt:i}of d){const a=o[e];if(0===a?.[t]){a[t]=i,s=!0;const o=V(e,i===P?t+1:t,r),l=V(e+1,i===P?t:t+1,r);if(n.connected(o,l))return!1;n.union(o,l)}}}if(!s)for(let e=0;e<t;e++)for(let t=0;t<r;t++){const i=o[e];if(0!==i?.[t])continue;const a=V(e,t+1,r),l=V(e+1,t,r),c=n.connected(a,l),u=V(e,t,r),d=V(e+1,t+1,r),f=n.connected(u,d);if(c&&f)return!1;c?(i[t]=_,s=!0,n.union(u,d)):f&&(i[t]=P,s=!0,n.union(a,l))}}if(!o.every(e=>e.every(e=>0!==e)))return!1;const i=Z(o,t,r);for(let a=0;a<=t;a++)for(let t=0;t<=r;t++){const r=e[a]?.[t];if(null!=r&&i[a]?.[t]!==r)return!1}return!0}function Y(e,t){let r=[],o=!1;for(let s=0;s<50&&!o;s++){r=Array.from({length:e},()=>new Array(t).fill(0));const n=new K((e+1)*(t+1)),s=[];for(let r=0;r<e;r++)for(let e=0;e<t;e++)s.push({r:r,c:e});for(let e=s.length-1;e>0;e--){const t=Math.floor(Math.random()*(e+1)),r=s[e],o=s[t];r&&o&&(s[e]=o,s[t]=r)}let i=!1;for(const{r:e,c:o}of s){const s=V(e,o+1,t),a=V(e+1,o,t),l=n.connected(s,a),c=V(e,o,t),u=V(e+1,o+1,t),d=n.connected(c,u);if(l&&d){i=!0;break}const f=r[e];f&&(l?(f[o]=_,n.union(c,u)):d||Math.random()<.5?(f[o]=P,n.union(s,a)):(f[o]=_,n.union(c,u)))}i||(o=!0)}o||(r=Array.from({length:e},(e,r)=>new Array(t).fill(r%2==0?P:_)));const n=function(e,t,r,o){const n=e.map(e=>[...e]),s=[];for(let l=0;l<=t;l++)for(let e=0;e<=r;e++)s.push({r:l,c:e});for(let l=s.length-1;l>0;l--){const e=Math.floor(Math.random()*(l+1)),t=s[l],r=s[e];t&&r&&(s[l]=r,s[e]=t)}const i=Math.floor((t+1)*(r+1)*o);let a=0;for(let l=0;l<=t;l++)for(let e=0;e<=r;e++)null!==n[l]?.[e]&&a++;for(const{r:l,c:c}of s){if(a<=i)break;const e=n[l];if(!e)continue;const o=e[c];null!=o&&(e[c]=null,Q(n,t,r)?a--:e[c]=o)}return n}(Z(r,e,t).map(e=>e.map(e=>e)),e,t,G);return{numbers:n,solution:r}}const ee=u({getInitialState:te,customHandler:(e,t)=>{if("toggle"===t.type){if(e.solved)return e;const{row:r,col:o}=t,n=e.grid.map(e=>[...e]),i=n[r];if(!i)return e;const a=i[o];if(void 0===a)return e;t.reverse?i[o]=0===a?P:a===P?_:0:i[o]=0===a?_:a===_?P:0;let l=!1;if(n.every(e=>e.every(e=>0!==e))){const t=Z(n,e.rows,e.cols);e.numbers.every((e,r)=>e.every((e,o)=>null==e||e===t[r]?.[o]))&&!function(e,t,r){const o=new K((t+1)*(r+1));for(let n=0;n<t;n++){const t=e[n];if(t)for(let e=0;e<r;e++){const s=t[e];if(void 0===s||0===s)continue;const i=V(n,s===P?e+1:e,r),a=V(n+1,s===P?e:e+1,r);if(!o.union(i,a))return!0}}return!1}(n,e.rows,e.cols)&&(l=!0)}const c=function(e,t,r,o){const n=new Set,i=Z(e,r,o);for(let a=0;a<=r;a++)for(let l=0;l<=o;l++){const c=t[a]?.[l];if(null==c)continue;const u=i[a]?.[l]??0;u>c?n.add(s(a,l)):u+[{gr:a-1,gc:l-1},{gr:a-1,gc:l},{gr:a,gc:l-1},{gr:a,gc:l}].filter(({gr:t,gc:n})=>t>=0&&t<r&&n>=0&&n<o&&0===e[t]?.[n]).length<c&&n.add(s(a,l))}return n}(n,e.numbers,e.rows,e.cols),u=F(n,e.rows,e.cols),d=function(e,t,r,o){const n=new Set,i=Z(e,r,o);for(let a=0;a<=r;a++)for(let e=0;e<=o;e++){const r=t[a]?.[e];null!=r&&((i[a]?.[e]??0)===r&&n.add(s(a,e)))}return n}(n,e.numbers,e.rows,e.cols);return{...e,grid:n,solved:l,errorNodes:c,cycleCells:u,satisfiedNodes:d}}return e}});function te(e,t){const{numbers:r,solution:o}=Y(e,t);return{grid:Array.from({length:e},()=>new Array(t).fill(0)),numbers:r,solution:o,rows:d(e),cols:d(t),solved:!1,errorNodes:new Set,cycleCells:new Set,satisfiedNodes:new Set}}function re(e,t,r){return{position:"absolute",width:"115%",height:`${String(Math.max(2,t))}px`,backgroundColor:r?C.data.red:C.text.primary,borderRadius:"99px",top:"50%",left:"50%",transform:`translate(-50%, -50%) rotate(${e})`,boxShadow:L.SHADOWS.LINE,transition:y.transition,pointerEvents:"none"}}const oe=(e,r,o)=>(n,i)=>{const a=r.grid[n]?.[i],l=s(n,i),c=r.cycleCells.has(l),u=e(l),d=[{v:r.numbers[n]?.[i],p:s(n,i)},{v:r.numbers[n]?.[i+1],p:s(n,i+1)},{v:r.numbers[n+1]?.[i],p:s(n+1,i)},{v:r.numbers[n+1]?.[i+1],p:s(n+1,i+1)}].map(({v:e,p:t})=>{if(null==e)return"-";const o=r.errorNodes.has(t)?"Error":r.satisfiedNodes.has(t)?"Ok":"Pending";return`${String(e)} (${o})`});return{...u,"aria-label":`Cell ${String(n+1)}, ${String(i+1)}. Clues: ${d.join(", ")}. ${0===a?"Empty":a===P?"Forward Slash":"Backward Slash"}${c?", Loop Error":""}`,sx:{...u.sx,cursor:"pointer",border:`1px solid ${C.border.subtle}`,position:"relative","&:hover":{backgroundColor:C.interactive.hover}},children:t.jsxs(x,{sx:{width:"100%",height:"100%",position:"relative"},children:[a===P&&t.jsx(x,{sx:re("-45deg",o,c)}),a===_&&t.jsx(x,{sx:re("45deg",o,c)})]})}};function ne(){const e=i("sm"),[o,n]=r.useState(!1),c=r.useRef(null),u=r.useRef({rows:0,cols:0}),{generating:d,requestGeneration:y,handleNextAsync:v}=J({getInitialState:te,dispatchRef:c,dimsRef:u}),{rows:E,cols:R,state:T,dispatch:O,size:N,controlsProps:D}=f({storageKeys:{size:H.SIZE,state:H.STATE},pageTitle:k.slant,gridConfig:{defaultSize:$,maxSize:B,paddingOffset:{x:e?48:80,y:120},widthLimit:A,cellSizeReference:4},boardConfig:{paddingOffset:e=>({x:e?48:80,y:j}),...e?{boardSizeFactor:.92}:{},maxCellSize:M,rowOffset:1,colOffset:1},reducer:ee,getInitialState:(e,t)=>te(e,t),manualResize:!0,onNext:v,winAnimationDelay:l.timing.winAnimationDelay,isSolved:e=>e.solved,persistence:{enabled:!o,serialize:e=>({...e,errorNodes:[...e.errorNodes],cycleCells:[...e.cycleCells],satisfiedNodes:[...e.satisfiedNodes]}),deserialize:e=>{const t=e;return{...t,errorNodes:new Set(t.errorNodes),cycleCells:new Set(t.cycleCells),satisfiedNodes:new Set(t.satisfiedNodes)}}}});c.current=O,u.current={rows:E,cols:R};const G=r.useRef(`${String(E)},${String(R)}`);r.useEffect(()=>{const e=`${String(E)},${String(R)}`;e!==G.current&&(G.current=e,y(E,R))},[E,R,y]);const[P,_]=r.useState(new Map);p({storageKey:H.GHOST_MOVES,rows:E,cols:R,state:P,onRestore:e=>{_(e)},serialize:e=>[...e.entries()],deserialize:e=>new Map(e)});const W=r.useRef("");r.useEffect(()=>{const e=JSON.stringify(T.numbers);W.current&&W.current!==e&&_(new Map),W.current=e},[T.numbers,T.rows,T.cols]);const U=v,{getDragProps:q}=a({onToggle:(e,t,r)=>{O({type:"toggle",row:m(e),col:m(t),reverse:r})},checkEnabled:()=>!T.solved,touchTimeout:l.timing.touchHoldDelay}),K=.4*N,V=g(oe,q,[T,N]),F=r.useMemo(()=>((e,r)=>(o,n)=>{const i=e.numbers[o]?.[n],a=s(o,n),l=e.errorNodes.has(a),c=e.satisfiedNodes.has(a);return{sx:{pointerEvents:"none"},children:t.jsx(x,{sx:{borderRadius:"50%",backgroundColor:l?C.data.red:C.surface.background,border:null==i?"none":`2px solid ${l?C.data.red:c?"transparent":C.border.subtle}`,fontSize:`${String(.5*r)}rem`,fontWeight:"800",color:l?L.COLORS.WHITE:c?C.interactive.disabledText:C.text.primary,boxShadow:c&&!l?"none":L.SHADOWS.HINT,zIndex:5,opacity:null==i?0:1,display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",userSelect:"none",WebkitUserSelect:"none",transform:l?"scale(1.1)":"scale(1)",width:`${String(r)}rem`,height:`${String(r)}rem`},children:i??""})}})(T,K),[T,K]),Z=r.useCallback((e,t)=>{_(r=>{const o=new Map(r);return void 0===t?o.delete(e):o.set(e,t),o})},[]),Q=r.useCallback(()=>{const e=new Map;T.grid.forEach((t,r)=>{t.forEach((t,o)=>{0!==t&&e.set(s(r,o),t)})}),_(e)},[T.grid]),Y=r.useCallback(()=>{_(new Map)},[]),re=r.useCallback(()=>{n(!1)},[]),ne=r.useCallback(e=>{e.stopPropagation()},[]),se=r.useMemo(()=>({px:e?"1rem":"2rem",pt:e?"1rem":"2rem"}),[e]),ie=r.useMemo(()=>o?{padding:{xs:0,sm:0}}:void 0,[o]),ae=o?null:t.jsx(b,{...D,onRefresh:v,disabled:d,children:t.jsx(w,{title:"Open Calculator",Icon:I,onClick:()=>{n(!o)},sx:{color:"default"}})}),le=r.useCallback(()=>({sx:{backgroundColor:"var(--border)"}}),[]),ce=r.useCallback(()=>({}),[]),ue=E!==T.rows||R!==T.cols,de=o?t.jsx(X,{rows:E,cols:R,numbers:T.numbers,size:N,initialMoves:P,onMove:Z,onCopy:Q,onClear:Y,onClose:re}):d||ue?t.jsx(x,{sx:{"@keyframes pulse":{"0%, 100%":{opacity:.4},"50%":{opacity:.15}},animation:"pulse 1.4s ease-in-out infinite"},children:t.jsx(S,{size:N,rows:E+1,cols:R+1,frontProps:ce,backProps:le,frontLayerSx:{pointerEvents:"none"}})}):t.jsx(S,{size:N,rows:E+1,cols:R+1,frontProps:F,backProps:V,frontLayerSx:{pointerEvents:"none"}});return t.jsx(h,{title:k.slant,infoUrl:"https://en.wikipedia.org/wiki/Gokigen_Naname",paddingBottom:{xs:"120px",md:"150px"},controls:ae,contentSx:se,showTrophy:!o&&T.solved,onReset:U,boardSize:N,iconSizeRatio:z,boardSx:ie,onClick:o?()=>{n(!1)}:void 0,children:t.jsx(x,{onClick:ne,children:de})})}export{ne as default};
