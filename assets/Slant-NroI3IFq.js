import{j as k,r as $,a as je}from"./vendor_react-D9AZKRQJ.js";import{d as ge,g as A,i as Z,c as Ie,a as pe,b as Re,k as Ne,e as $e,G as ze,f as Me,j as be,h as Ae,B as Te}from"./types-O00vzDIW.js";import{B as H}from"./vendor_mui_core-CcNgE9EE.js";import{A as Y,S as he,e as ee,C as E,L as oe,d as me}from"./index-Dh9eOJXR.js";import{t as Oe,u as Be,f as De,P as He}from"./vendor_mui_icons-i_Xb35He.js";import{u as Le,C as we}from"./layout-Pt8faN6F.js";import"./GlassCard-CnxQqiCZ.js";import"./PageLayout-CHV4ftwa.js";const te="18px",ne="24px",xe="130%",ye="6px",_e="24px",Ue=100,We=1e3,Pe=1200,Ge=.98,Fe=100,Ve=16,Je=.8,Ke="slant-size",Xe="slant-state",qe="slant-ghost-moves",se=0,Qe=3,Ze=5,ve={WHITE:"#fff"},V={LINE:"0 2px 4px rgba(0,0,0,0.2)",HINT:"0 4px 8px rgba(0,0,0,0.1)"},G={BORDER:"var(--slant-ghost-border)",BG_SUBTLE:"var(--slant-ghost-bg-subtle)",BG_HOVER:"var(--slant-ghost-bg-hover)",DASHED_BORDER:"var(--slant-ghost-dashed-border)",HINT_BG:"var(--slant-ghost-hint-bg)",HINT_BORDER:"var(--slant-ghost-hint-border)",HINT_TEXT:"var(--slant-ghost-hint-text)"},j=1,T=2,Ye=({value:e,color:t})=>k.jsxs(H,{sx:{width:"100%",height:"100%",position:"relative"},children:[e===j&&k.jsx(H,{sx:{position:"absolute",width:xe,height:ye,backgroundColor:t,borderRadius:he.borderRadius.full,top:"50%",left:"50%",transform:"translate(-50%, -50%) rotate(-45deg)",boxShadow:V.LINE,transition:Y.transition,pointerEvents:"none"}}),e===T&&k.jsx(H,{sx:{position:"absolute",width:xe,height:ye,backgroundColor:t,borderRadius:he.borderRadius.full,top:"50%",left:"50%",transform:"translate(-50%, -50%) rotate(45deg)",boxShadow:V.LINE,transition:Y.transition,pointerEvents:"none"}})]}),et=({onCopy:e,onClear:t,onClose:r})=>k.jsxs(H,{sx:{display:"flex",justifyContent:"center",gap:2,position:"absolute",bottom:-90,left:0,right:0,pointerEvents:"auto",zIndex:oe.zIndex.base+5,paddingBottom:2},children:[k.jsx(ee,{title:"Copy Board",Icon:Oe,onClick:e,sx:{backgroundColor:E.interactive.selected,color:E.primary.main,"&:hover":{backgroundColor:E.interactive.focus}}}),k.jsx(ee,{title:"Clear Calculator",Icon:Be,onClick:t,sx:{backgroundColor:"rgba(255, 68, 68, 0.1)",color:E.data.red,"&:hover":{backgroundColor:"rgba(255, 68, 68, 0.2)"}}}),k.jsx(ee,{title:"Close Calculator",Icon:De,onClick:r,sx:{backgroundColor:"rgba(255, 193, 7, 0.1)",color:E.data.amber,"&:hover":{backgroundColor:"rgba(255, 193, 7, 0.2)"}}})]}),tt=({value:e,hasConflict:t,numberSize:r})=>k.jsx(H,{sx:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:`${String(.5*r)}rem`,fontWeight:"800",color:t?ve.WHITE:G.HINT_TEXT,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",userSelect:"none",WebkitUserSelect:"none",transform:t?"scale(1.1)":"scale(1)"},children:e??""}),nt=({rows:e,cols:t,numbers:r,size:s,initialMoves:n,onMove:a,onCopy:d,onClear:g,onClose:f})=>{const c=Le("sm"),l=n,{getDragProps:o}=ge({onToggle:(w,R,i,x,z)=>{const N=A(w,R);if(!z)return void a(N,x);const M=l.get(N);let W;return W=i?M===j?T:M===T?void 0:j:M===T?j:M===j?void 0:T,a(N,W),W},touchTimeout:Z.timing.touchHoldDelay,checkEnabled:()=>!0}),[u,b]=$.useState(new Map),[h,S]=$.useState([]),[y,_]=$.useState(new Set),p=je.useRef(null);$.useEffect(()=>{const w=new Worker(new URL("/assets/solverWorker-Dpdr9xQI.js",import.meta.url),{type:"module"});return p.current=w,w.onmessage=R=>{const i=R.data;if(i.type==="RESULT"){const{gridState:x,conflicts:z,cycleCells:N}=i.payload;b(x),S(z),_(N)}},()=>{w.terminate()}},[]),$.useEffect(()=>{p.current&&p.current.postMessage({type:"SOLVE",payload:{rows:e,cols:t,numbers:r,userMoves:l}})},[l,r,e,t]);const m=.4*s,v=s-m,I=$.useMemo(()=>new Set(h.filter(w=>w.type==="cell").map(w=>A(w.r,w.c))),[h]),B=$.useMemo(()=>new Set(h.filter(w=>w.type==="node").map(w=>A(w.r,w.c))),[h]),L=$.useCallback((w,R)=>{const i=A(w,R),x=u.get(i),z=(x==null?void 0:x.state)??0,N=x==null?void 0:x.source,M=I.has(i),W=y.has(i),P=o(i);let U=E.text.primary;return M?U=E.data.red:W?U=N==="user"?E.data.red:"#ff9800":N==="user"?U=E.primary.main:N==="propagated"&&(U=E.data.green),{...P,"data-pos":i,"data-type":"cell",sx:{...P.sx,cursor:"pointer",border:`1px solid ${G.BORDER}`,position:"relative",backgroundColor:G.BG_SUBTLE,"&:hover":{backgroundColor:G.BG_HOVER}},children:k.jsx(Ye,{value:z,color:U})}},[u,I,y,o]),C=$.useCallback((w,R)=>{var z;const i=(z=r[w])==null?void 0:z[R],x=B.has(A(w,R));return{"data-pos":A(w,R),"data-type":"hint",children:k.jsx(tt,{value:i??null,hasConflict:x,numberSize:m}),sx:{borderRadius:"50%",backgroundColor:x?E.data.red:G.HINT_BG,border:i!=null?`2px solid ${x?E.data.red:G.HINT_BORDER}`:"none",zIndex:5,opacity:i!=null?1:0,position:"relative",pointerEvents:"none"}}},[r,B,m]);return k.jsxs(H,{sx:{position:"relative",userSelect:"none"},children:[k.jsxs(H,{sx:{position:"relative",padding:c?`calc(${te} + 16px)`:`calc(${ne} + 24px)`,border:`2px dashed ${G.DASHED_BORDER}`,borderRadius:_e},children:[k.jsx(H,{sx:{position:"relative",zIndex:oe.zIndex.base+1},children:k.jsx(we,{size:s,rows:e,cols:t,cellProps:L,space:0,sx:{width:"fit-content"}})}),k.jsx(H,{sx:{position:"absolute",top:c?`calc(${te} + 16px)`:`calc(${ne} + 24px)`,left:c?`calc(${te} + 16px)`:`calc(${ne} + 24px)`,transform:`translate(-${String(m/2)}rem, -${String(m/2)}rem)`,zIndex:oe.zIndex.base+2,pointerEvents:"none"},children:k.jsx(we,{size:m,rows:e+1,cols:t+1,cellProps:C,space:v,sx:{width:"fit-content"}})})]}),k.jsx(et,{onCopy:d,onClear:g,onClose:f})]})};function rt(e,t,r){const s=(function(g,f){const c=f(1*g.length,1)>>>0;return K().set(g,c/1),q=g.length,c})(e,O.__wbindgen_malloc),n=q,a=O.find_cycles_wasm(s,n,t,r);var d=(function(g,f){g>>>=0;const c=ae(),l=[];for(let o=g;o<g+4*f;o+=4)l.push(O.__wbindgen_externrefs.get(c.getUint32(o,!0)));return O.__externref_drop_slice(g,f),l})(a[0],a[1]).slice();return O.__wbindgen_free(a[0],4*a[1],4),d}function ot(){return{__proto__:null,"./slant_wasm_bg.js":{__proto__:null,__wbg___wbindgen_debug_string_0bc8482c6e3508ae:function(e,t){const r=(function(n,a,d){if(d===void 0){const o=X.encode(n),u=a(o.length,1)>>>0;return K().subarray(u,u+o.length).set(o),q=o.length,u}let g=n.length,f=a(g,1)>>>0;const c=K();let l=0;for(;l<g;l++){const o=n.charCodeAt(l);if(o>127)break;c[f+l]=o}if(l!==g){l!==0&&(n=n.slice(l)),f=d(f,g,g=l+3*n.length,1)>>>0;const o=K().subarray(f+l,f+g);l+=X.encodeInto(n,o).written,f=d(f,g,l,1)>>>0}return q=l,f})(ie(t),O.__wbindgen_malloc,O.__wbindgen_realloc),s=q;ae().setInt32(e+4,s,!0),ae().setInt32(e+0,r,!0)},__wbg___wbindgen_throw_be289d5034ed271b:function(e,t){throw new Error(Se(e,t))},__wbg_new_361308b2356cecd0:function(){return new Object},__wbg_new_3eb36ae241fe6f44:function(){return new Array},__wbg_set_3f1d0b984ed272ed:function(e,t,r){e[t]=r},__wbg_set_f43e577aea94465b:function(e,t,r){e[t>>>0]=r},__wbindgen_cast_0000000000000001:function(e){return e},__wbindgen_cast_0000000000000002:function(e,t){return Se(e,t)},__wbindgen_init_externref_table:function(){const e=O.__wbindgen_externrefs,t=e.grow(4);e.set(0,void 0),e.set(t+0,void 0),e.set(t+1,null),e.set(t+2,!0),e.set(t+3,!1)}}}}function ie(e){const t=typeof e;if(t=="number"||t=="boolean"||e==null)return`${e}`;if(t=="string")return`"${e}"`;if(t=="symbol"){const n=e.description;return n==null?"Symbol":`Symbol(${n})`}if(t=="function"){const n=e.name;return typeof n=="string"&&n.length>0?`Function(${n})`:"Function"}if(Array.isArray(e)){const n=e.length;let a="[";n>0&&(a+=ie(e[0]));for(let d=1;d<n;d++)a+=", "+ie(e[d]);return a+="]",a}const r=/\[object ([^\]]+)\]/.exec(toString.call(e));let s;if(!(r&&r.length>1))return toString.call(e);if(s=r[1],s=="Object")try{return"Object("+JSON.stringify(e)+")"}catch{return"Object"}return e instanceof Error?`${e.name}: ${e.message}
${e.stack}`:s}let F=null;function ae(){return(F===null||F.buffer.detached===!0||F.buffer.detached===void 0&&F.buffer!==O.memory.buffer)&&(F=new DataView(O.memory.buffer)),F}function Se(e,t){return(function(r,s){return le+=s,le>=st&&(re=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}),re.decode(),le=s),re.decode(K().subarray(r,r+s))})(e>>>=0,t)}let J=null;function K(){return J!==null&&J.byteLength!==0||(J=new Uint8Array(O.memory.buffer)),J}let re=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});re.decode();const st=2146435072;let le=0;const X=new TextEncoder;"encodeInto"in X||(X.encodeInto=function(e,t){const r=X.encode(e);return t.set(r),{read:e.length,written:r.length}});let O,q=0;async function it(e){if(O!==void 0)return O;e!==void 0&&Object.getPrototypeOf(e)===Object.prototype&&({module_or_path:e}=e),e===void 0&&(e=new URL("/assets/slant_wasm_bg-kZzm8ut6.wasm",import.meta.url));const t=ot();(typeof e=="string"||typeof Request=="function"&&e instanceof Request||typeof URL=="function"&&e instanceof URL)&&(e=fetch(e));const{instance:r}=await(async function(s,n){if(typeof Response=="function"&&s instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(s,n)}catch(d){if(!s.ok||!(function(g){switch(g){case"basic":case"cors":case"default":return!0}return!1})(s.type)||s.headers.get("Content-Type")==="application/wasm")throw d}const a=await s.arrayBuffer();return await WebAssembly.instantiate(a,n)}{const a=await WebAssembly.instantiate(s,n);return a instanceof WebAssembly.Instance?{instance:a,module:s}:a}})(await e,t);return(function(s){return O=s.exports,F=null,J=null,O.__wbindgen_start(),O})(r)}let ce=!1,ue=null;function Ce(){return ce}(async function(){if(!ce)return ue??(ue=it().then(()=>{ce=!0}).catch(e=>{throw ue=null,e})),ue})().catch(()=>{});class de{constructor(t){this.parent=Array.from({length:t},(r,s)=>s)}find(t){const r=this.parent[t];if(r===void 0)throw new Error(`DSU: Index ${String(t)} out of bounds`);r!==t&&(this.parent[t]=this.find(r));const s=this.parent[t];if(s===void 0)throw new Error(`DSU: Parent of ${String(t)} became undefined`);return s}union(t,r){const s=this.find(t),n=this.find(r);return s!==n&&(this.parent[s]=n,!0)}connected(t,r){return this.find(t)===this.find(r)}}function D(e,t,r){return e*(r+1)+t}function Q(e,t,r){const s=Array.from({length:t+1},()=>Array(r+1).fill(0));for(let n=0;n<t;n++){const a=e[n];if(a)for(let d=0;d<r;d++){const g=a[d];if(g===j){const f=s[n];if(f){const l=f[d+1];l!==void 0&&(f[d+1]=l+1)}const c=s[n+1];if(c){const l=c[d];l!==void 0&&(c[d]=l+1)}}else if(g===T){const f=s[n];if(f){const l=f[d];l!==void 0&&(f[d]=l+1)}const c=s[n+1];if(c){const l=c[d+1];l!==void 0&&(c[d+1]=l+1)}}}}return s}function at(e,t,r){var g,f,c,l;const s=Array.from({length:t},()=>Array(r).fill(0)),n=new de((t+1)*(r+1));let a=!0;for(;a;){a=!1;for(let o=0;o<=t;o++)for(let u=0;u<=r;u++){const b=(g=e[o])==null?void 0:g[u];if(b==null)continue;const h=[{gr:o-1,gc:u-1,pt:T},{gr:o-1,gc:u,pt:j},{gr:o,gc:u-1,pt:j},{gr:o,gc:u,pt:T}].filter(({gr:_,gc:p})=>_>=0&&_<t&&p>=0&&p<r);let S=0;const y=[];for(const _ of h){const p=(f=s[_.gr])==null?void 0:f[_.gc];p===0?y.push(_):p===_.pt&&S++}if(S===b&&y.length>0)for(const{gr:_,gc:p,pt:m}of y){const v=s[_];if((v==null?void 0:v[p])===0){const I=m===j?T:j;v[p]=I,a=!0;const B=D(_,I===j?p+1:p,r),L=D(_+1,I===j?p:p+1,r);if(n.connected(B,L))return!1;n.union(B,L)}}else if(S+y.length===b&&y.length>0)for(const{gr:_,gc:p,pt:m}of y){const v=s[_];if((v==null?void 0:v[p])===0){v[p]=m,a=!0;const I=D(_,m===j?p+1:p,r),B=D(_+1,m===j?p:p+1,r);if(n.connected(I,B))return!1;n.union(I,B)}}}if(!a)for(let o=0;o<t;o++)for(let u=0;u<r;u++){const b=s[o];if((b==null?void 0:b[u])!==0)continue;const h=D(o,u+1,r),S=D(o+1,u,r),y=n.connected(h,S),_=D(o,u,r),p=D(o+1,u+1,r),m=n.connected(_,p);if(y&&m)return!1;y?(b[u]=T,a=!0,n.union(_,p)):m&&(b[u]=j,a=!0,n.union(h,S))}}if(!s.every(o=>o.every(u=>u!==0)))return!1;const d=Q(s,t,r);for(let o=0;o<=t;o++)for(let u=0;u<=r;u++){const b=(c=e[o])==null?void 0:c[u];if(b!=null&&((l=d[o])==null?void 0:l[u])!==b)return!1}return!0}function ke(e,t,r,s){var f;const n=e.map(c=>[...c]),a=[];for(let c=0;c<=t;c++)for(let l=0;l<=r;l++)a.push({r:c,c:l});for(let c=a.length-1;c>0;c--){const l=Math.floor(Math.random()*(c+1)),o=a[c],u=a[l];o&&u&&(a[c]=u,a[l]=o)}const d=Math.floor((t+1)*(r+1)*s);let g=0;for(let c=0;c<=t;c++)for(let l=0;l<=r;l++)((f=n[c])==null?void 0:f[l])!==null&&g++;for(const{r:c,c:l}of a){if(g<=d)break;const o=n[c];if(!o)continue;const u=o[l];u!=null&&(o[l]=null,at(n,t,r)?g--:o[l]=u)}return n}function lt(e,t){if(Ce())try{const n=BigInt(Math.floor(Math.random()*Number.MAX_SAFE_INTEGER)),a=(function(d,g,f,c){return O.generate_puzzle_wasm(d,g,f,c)})(e,t,n,se);return{numbers:ke(a.numbers,e,t,se),solution:a.solution}}catch{}let r=[],s=!1;for(let n=0;n<50&&!s;n++){r=Array.from({length:e},()=>Array(t).fill(0));const a=new de((e+1)*(t+1)),d=[];for(let f=0;f<e;f++)for(let c=0;c<t;c++)d.push({r:f,c});for(let f=d.length-1;f>0;f--){const c=Math.floor(Math.random()*(f+1)),l=d[f],o=d[c];l&&o&&(d[f]=o,d[c]=l)}let g=!1;for(const{r:f,c}of d){const l=D(f,c+1,t),o=D(f+1,c,t),u=a.connected(l,o),b=D(f,c,t),h=D(f+1,c+1,t),S=a.connected(b,h);if(u&&S){g=!0;break}const y=r[f];y&&(u?(y[c]=T,a.union(b,h)):S||Math.random()<.5?(y[c]=j,a.union(l,o)):(y[c]=T,a.union(b,h)))}g||(s=!0)}return s||(r=Array.from({length:e},(n,a)=>Array(t).fill(a%2==0?j:T))),{numbers:ke(Q(r,e,t).map(n=>n.map(a=>a)),e,t,se),solution:r}}const ct=Ie({getInitialState:Ee,customHandler:(e,t)=>{if(t.type==="toggle"){if(e.solved)return e;const{row:r,col:s}=t,n=e.grid.map(o=>[...o]),a=n[r];if(!a)return e;const d=a[s];if(d===void 0)return e;t.reverse?a[s]=d===0?j:d===j?T:0:a[s]=d===0?T:d===T?j:0;let g=!1;if(n.every(o=>o.every(u=>u!==0))){const o=Q(n,e.rows,e.cols);e.numbers.every((u,b)=>u.every((h,S)=>{var y;return h==null||h===((y=o[b])==null?void 0:y[S])}))&&!(function(u,b,h){const S=new de((b+1)*(h+1));for(let y=0;y<b;y++){const _=u[y];if(_)for(let p=0;p<h;p++){const m=_[p];if(m===void 0||m===0)continue;const v=D(y,m===j?p+1:p,h),I=D(y+1,m===j?p:p+1,h);if(!S.union(v,I))return!0}}return!1})(n,e.rows,e.cols)&&(g=!0)}const f=(function(o,u,b,h){var _,p;const S=new Set,y=Q(o,b,h);for(let m=0;m<=b;m++)for(let v=0;v<=h;v++){const I=(_=u[m])==null?void 0:_[v];if(I==null)continue;const B=((p=y[m])==null?void 0:p[v])??0;B>I?S.add(A(m,v)):B+[{gr:m-1,gc:v-1},{gr:m-1,gc:v},{gr:m,gc:v-1},{gr:m,gc:v}].filter(({gr:L,gc:C})=>{var w;return L>=0&&L<b&&C>=0&&C<h&&((w=o[L])==null?void 0:w[C])===0}).length<I&&S.add(A(m,v))}return S})(n,e.numbers,e.rows,e.cols),c=(function(o,u,b){var v,I,B,L;if(Ce())try{const C=new Uint8Array(u*b);for(let R=0;R<u;R++)for(let i=0;i<b;i++)C[R*b+i]=((v=o[R])==null?void 0:v[i])??0;const w=rt(C,u,b);if(w.length>0)return new Set(w)}catch{}const h=new Map,S=new Set;for(let C=0;C<u;C++)for(let w=0;w<b;w++){const R=(I=o[C])==null?void 0:I[w];if(!R||R===0)continue;const i=D(C,R===j?w+1:w,b),x=D(C+1,R===j?w:w+1,b);h.has(i)||h.set(i,[]),h.has(x)||h.set(x,[]),(B=h.get(i))==null||B.push({node:x,r:C,c:w}),(L=h.get(x))==null||L.push({node:i,r:C,c:w})}const y=new Set,_=new Set,p=[],m=(C,w)=>{y.add(C),_.add(C);const R=h.get(C)??[];for(const{node:i,r:x,c:z}of R)if(i!==w)if(_.has(i)){S.add(A(x,z));for(let N=p.length-1;N>=0;N--){const M=p[N];if(!M||(S.add(A(M.r,M.c)),M.u===i||M.v===i))break}}else y.has(i)||(p.push({r:x,c:z,u:C,v:i}),m(i,C),p.pop());_.delete(C)};for(const C of h.keys())y.has(C)||m(C,-1);return S})(n,e.rows,e.cols),l=(function(o,u,b,h){var _,p;const S=new Set,y=Q(o,b,h);for(let m=0;m<=b;m++)for(let v=0;v<=h;v++){const I=(_=u[m])==null?void 0:_[v];I!=null&&(((p=y[m])==null?void 0:p[v])??0)===I&&S.add(A(m,v))}return S})(n,e.numbers,e.rows,e.cols);return{...e,grid:n,solved:g,errorNodes:f,cycleCells:c,satisfiedNodes:l}}return e}});function Ee(e,t){const{numbers:r,solution:s}=lt(e,t);return{grid:Array.from({length:e},()=>Array(t).fill(0)),numbers:r,solution:s,rows:pe(e),cols:pe(t),solved:!1,errorNodes:new Set,cycleCells:new Set,satisfiedNodes:new Set}}const ut=(e,t,r)=>(s,n)=>{var l,o,u,b,h;const a=(l=t.grid[s])==null?void 0:l[n],d=A(s,n),g=t.cycleCells.has(d),f=e(d),c=[{v:(o=t.numbers[s])==null?void 0:o[n],p:A(s,n)},{v:(u=t.numbers[s])==null?void 0:u[n+1],p:A(s,n+1)},{v:(b=t.numbers[s+1])==null?void 0:b[n],p:A(s+1,n)},{v:(h=t.numbers[s+1])==null?void 0:h[n+1],p:A(s+1,n+1)}].map(({v:S,p:y})=>{if(S==null)return"-";const _=t.errorNodes.has(y)?"Error":t.satisfiedNodes.has(y)?"Ok":"Pending";return`${String(S)} (${_})`});return{...f,"aria-label":`Cell ${String(s+1)}, ${String(n+1)}. Clues: ${c.join(", ")}. ${a===0?"Empty":a===j?"Forward Slash":"Backward Slash"}${g?", Loop Error":""}`,sx:{...f.sx,cursor:"pointer",border:`1px solid ${E.border.subtle}`,position:"relative","&:hover":{backgroundColor:E.interactive.hover}},children:k.jsxs(H,{sx:{width:"100%",height:"100%",position:"relative"},children:[a===j&&k.jsx(H,{sx:{position:"absolute",width:"115%",height:`${String(Math.max(2,r))}px`,backgroundColor:g?E.data.red:E.text.primary,borderRadius:"99px",top:"50%",left:"50%",transform:"translate(-50%, -50%) rotate(-45deg)",boxShadow:V.LINE,transition:Y.transition,pointerEvents:"none"}}),a===T&&k.jsx(H,{sx:{position:"absolute",width:"115%",height:`${String(Math.max(2,r))}px`,backgroundColor:g?E.data.red:E.text.primary,borderRadius:"99px",top:"50%",left:"50%",transform:"translate(-50%, -50%) rotate(45deg)",boxShadow:V.LINE,transition:Y.transition,pointerEvents:"none"}})]})}};function dt(){const[e,t]=$.useState(!1),{rows:r,cols:s,state:n,dispatch:a,size:d,mobile:g,handleNext:f,controlsProps:c}=Re({storageKeys:{size:Ke,state:Xe},pageTitle:me.slant,gridConfig:{defaultSize:Ze,minSize:Qe,headerOffset:Z.layout.headerHeight,paddingOffset:160,widthLimit:We,cellSizeReference:4,mobileRowOffset:-2},boardConfig:{paddingOffset:i=>({x:i?32:224,y:Ue}),boardMaxWidth:Pe,boardSizeFactor:Ge,maxCellSize:Fe,remBase:Ve,rowOffset:1,colOffset:1},reducer:ct,getInitialState:(i,x)=>Ee(i,x),winAnimationDelay:Z.timing.winAnimationDelay,isSolved:i=>i.solved,persistence:{enabled:!e,serialize:i=>({...i,errorNodes:Array.from(i.errorNodes),cycleCells:Array.from(i.cycleCells),satisfiedNodes:Array.from(i.satisfiedNodes)}),deserialize:i=>{const x=i;return{...x,errorNodes:new Set(x.errorNodes),cycleCells:new Set(x.cycleCells),satisfiedNodes:new Set(x.satisfiedNodes)}}}}),[l,o]=$.useState(new Map);Ne({storageKey:qe,rows:r,cols:s,state:l,onRestore:i=>{o(i)},serialize:i=>Array.from(i.entries()),deserialize:i=>new Map(i)});const u=$.useRef("");$.useEffect(()=>{const i=JSON.stringify(n.numbers);u.current&&u.current!==i&&o(new Map),u.current=i},[n.numbers,n.rows,n.cols]);const b=f,{getDragProps:h}=ge({onToggle:(i,x,z)=>{a({type:"toggle",row:be(i),col:be(x),reverse:z})},checkEnabled:()=>!n.solved,touchTimeout:Z.timing.touchHoldDelay}),S=.4*d,y=$e(ut,h,[n,d]),_=$.useMemo(()=>((i,x)=>(z,N)=>{var fe;const M=(fe=i.numbers[z])==null?void 0:fe[N],W=A(z,N),P=i.errorNodes.has(W),U=i.satisfiedNodes.has(W);return{sx:{pointerEvents:"none"},children:k.jsx(H,{sx:{borderRadius:"50%",backgroundColor:P?E.data.red:E.surface.background,border:M!=null?`2px solid ${P?E.data.red:U?"transparent":E.border.subtle}`:"none",fontSize:`${String(.5*x)}rem`,fontWeight:"800",color:P?ve.WHITE:U?E.interactive.disabledText:E.text.primary,boxShadow:U&&!P?"none":V.HINT,zIndex:5,opacity:M!=null?1:0,display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",userSelect:"none",WebkitUserSelect:"none",transform:P?"scale(1.1)":"scale(1)",width:`${String(x)}rem`,height:`${String(x)}rem`},children:M??""})}})(n,S),[n,S]),p=$.useCallback((i,x)=>{o(z=>{const N=new Map(z);return x===void 0?N.delete(i):N.set(i,x),N})},[]),m=$.useCallback(()=>{const i=new Map;n.grid.forEach((x,z)=>{x.forEach((N,M)=>{N!==0&&i.set(A(z,M),N)})}),o(i)},[n.grid]),v=$.useCallback(()=>{o(new Map)},[]),I=$.useCallback(()=>{t(!1)},[]),B=$.useCallback(i=>{i.stopPropagation()},[]),L=$.useMemo(()=>({padding:g?"1rem":"2rem"}),[g]),C=$.useMemo(()=>({userSelect:"none",padding:g?te:ne,border:"2px solid transparent",borderRadius:_e}),[g]),w=e?null:k.jsx(Ae,{...c,disabled:e,children:k.jsx(ee,{title:"Open Calculator",Icon:He,onClick:()=>{t(!e)},sx:{color:"default"}})}),R=e?k.jsx(nt,{rows:r,cols:s,numbers:n.numbers,size:d,initialMoves:l,onMove:p,onCopy:m,onClear:v,onClose:I}):k.jsx(Te,{size:d,rows:r+1,cols:s+1,frontProps:_,backProps:y,frontLayerSx:{pointerEvents:"none"}});return k.jsx(ze,{children:k.jsx(Me,{title:me.slant,infoUrl:"https://en.wikipedia.org/wiki/Gokigen_Naname",paddingBottom:{xs:"180px",md:"150px"},controls:w,contentSx:L,showTrophy:!e&&n.solved,onReset:b,boardSize:d,iconSizeRatio:Je,primaryColor:E.primary.main,secondaryColor:E.primary.main,boardSx:C,onClick:()=>{e&&t(!1)},children:k.jsx(H,{onClick:B,children:R})})})}export{dt as default};
